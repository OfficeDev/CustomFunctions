var __awaiter=this&&this.__awaiter||function(d,c,b,a){function e(a){return a instanceof b?a:new b(function(b){b(a)})}return new(b||(b=Promise))(function(i,f){function g(c){try{b(a.next(c))}catch(d){f(d)}}function h(c){try{b(a["throw"](c))}catch(d){f(d)}}function b(a){a.done?i(a.value):e(a.value).then(g,h)}b((a=a.apply(d,c||[])).next())})},__generator=this&&this.__generator||function(g,h){var b={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},e,c,a,f;return f={next:d(0),"throw":d(1),"return":d(2)},typeof Symbol==="function"&&(f[Symbol.iterator]=function(){return this}),f;function d(a){return function(b){return i([a,b])}}function i(d){if(e)throw new TypeError("Generator is already executing.");while(b)try{if(e=1,c&&(a=d[0]&2?c["return"]:d[0]?c["throw"]||((a=c["return"])&&a.call(c),0):c.next)&&!(a=a.call(c,d[1])).done)return a;if(c=0,a)d=[d[0]&2,a.value];switch(d[0]){case 0:case 1:a=d;break;case 4:b.label++;return{value:d[1],done:false};case 5:b.label++;c=d[1];d=[0];continue;case 7:d=b.ops.pop();b.trys.pop();continue;default:if(!(a=b.trys,a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){b=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){b.label=d[1];break}if(d[0]===6&&b.label<a[1]){b.label=a[1];a=d;break}if(a&&b.label<a[2]){b.label=a[2];b.ops.push(d);break}a[2]&&b.ops.pop();b.trys.pop();continue}d=h.call(g,b)}catch(f){d=[6,f];c=0}finally{e=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:true}}},__extends=this&&this.__extends||function(){var a=function(c,b){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(c,a){for(var b in a)if(a.hasOwnProperty(b))c[b]=a[b]};return a(c,b)};return function(c,b){a(c,b);function d(){this.constructor=c}c.prototype=b===null?Object.create(b):(d.prototype=b.prototype,new d)}}(),OSF;(function(b){function a(c,b,a){Object.defineProperty(c,b,{"get":function(){return a()},configurable:true,enumerable:true})}b.definePropertyOnNamespace=a})(OSF||(OSF={}));var OSF;(function(a){a.AppTelemetry={logAppException:function(b){a.OsfUtility.trace(b)},onRegisterDone:function(c,e,b,d){a.OsfUtility.trace(""+c+","+b)},initialize:function(a){}}})(OSF||(OSF={}));var OSF;(function(b){var a=function(){function a(){}a.prototype.invokeCallback=function(f,a,b,e){if(b==0){var c={status:Office.AsyncResultStatus.succeeded,value:e};a(c)}else{var d={status:Office.AsyncResultStatus.failed,error:{code:b}};a(d)}};return a}();b.AsyncMethodExecutor=a})(OSF||(OSF={}));var OSF;(function(a){var b;(function(c){var s=window.location.hash,q=window.location.search,w=window.name,b,e,f,d,g,i,h;function x(){return __awaiter(this,void 0,void 0,function(){var c,f;return __generator(this,function(j){switch(j.label){case 0:e={id:null,webAppUrl:null,conversationID:null,clientEndPoint:null,wnd:window.parent,focused:false,serviceEndPoint:null,serializerVersion:1};t();o();k();b.hostPlatform===a.HostInfoPlatform.web&&d.saveAndSetDialogInfo(a.OsfUtility.getQueryStringValue("_host_Info"));d.setAgaveHostCommunication();return[4,d.getAppContext(window)];case 1:c=j.sent();h=c;g=d.createClientHostController();i=d.createAsyncMethodExecutor(g);f=c.get_appName();Office.fireOnReady({host:a.HostName.Host.getInstance().getHost(f),platform:a.HostName.Host.getInstance().getPlatform(f)});return[2,c]}})})}c.initialize=x;function t(){b={isO15:true,isRichClient:true,hostType:"",hostPlatform:"",hostSpecificFileVersion:"",hostLocale:"",osfControlAppCorrelationId:"",isDialog:false,disableLogging:false,flags:0};var g="_host_Info",d=a.OsfUtility.getQueryStringValue(g);if(!d)try{var i=JSON.parse(window.name);d=i?i.hostInfo:null}catch(j){a.OsfUtility.log(JSON.stringify(j))}if(!d)try{window.external=window.external||{};if(typeof agaveHost!=="undefined"&&agaveHost.GetHostInfo)window.external.GetHostInfo=function(){return agaveHost.GetHostInfo()};if(window.external.GetHostInfo){var f=window.external.GetHostInfo();if(f=="isDialog"){b.isO15=true;b.isDialog=true}else{var h=f.split(g+"=");if(h.length>1)d=h[1];else d=f}}}catch(j){a.OsfUtility.log(JSON.stringify(j))}var e=null;try{if(window.sessionStorage)e=window.sessionStorage}catch(j){}if(!d&&e&&e.getItem("hostInfoValue"))d=e.getItem("hostInfoValue");if(d){d=decodeURIComponent(d);b.isO15=false;var c=d.split("$");if(typeof c[2]=="undefined")c=d.split("|");b.hostType=typeof c[0]=="undefined"?"":c[0].toLowerCase();b.hostPlatform=typeof c[1]=="undefined"?"":c[1].toLowerCase();b.hostSpecificFileVersion=typeof c[2]=="undefined"?"":c[2].toLowerCase();b.hostLocale=typeof c[3]=="undefined"?"":c[3].toLowerCase();b.osfControlAppCorrelationId=typeof c[4]=="undefined"?"":c[4];if(b.osfControlAppCorrelationId=="telemetry")b.osfControlAppCorrelationId="";b.isDialog=typeof c[5]!="undefined"&&c[5]=="isDialog"?true:false;b.disableLogging=typeof c[6]!="undefined"&&c[6]=="disableLogging"?true:false;b.flags=typeof c[7]==="string"&&c[7].length>0?parseInt(c[7]):0;if(e)try{e.setItem("hostInfoValue",d)}catch(k){}}else{b.isO15=true;b.hostLocale=a.OsfUtility.getQueryStringValue("locale")}}function o(){f=true;try{if(b.disableLogging){f=false;return}window.external=window.external||{};if(typeof window.external.GetLoggingAllowed==="undefined")f=true;else f=window.external.GetLoggingAllowed()}catch(a){}}function k(){if(b.hostPlatform===a.HostInfoPlatform.web)d=new a.WebInitializationHelper(b,e,null,null);else if(b.hostPlatform===a.HostInfoPlatform.win32)d=new a.RichClientInitializationHelper(b,e,null,null)}function u(){return w}c.getWindowName=u;function p(){return s}c.getWindowLocationHash=p;function m(){return q}c.getWindowLocationSearch=m;function l(){return g}c.getClientHostController=l;function n(){return i}c.getAsyncMethodExecutor=n;function r(){return h}c.getOfficeAppContext=r;function v(){return b}c.getHostInfo=v;function j(){return(e.conversationID!=null?e.conversationID:h.get_appInstanceId())+"CachedSessionSettings"}c.getCachedSessionSettingsKey=j})(b=a.Bootstrap||(a.Bootstrap={}))})(OSF||(OSF={}));var OSF;(function(b){var a=function(){function a(){}a.NotificationConversationIdSuffix="_ntf";return a}();b.Constants=a})(OSF||(OSF={}));var OSF;(function(b){var a=function(){function a(){}a.getAsyncResult=function(a){if(a==0)return{status:Office.AsyncResultStatus.succeeded};else return{status:Office.AsyncResultStatus.failed,error:{code:a}}};return a}();b.ErrorCodeManager=a})(OSF||(OSF={}));var OSF;(function(b){var a=function(){function a(a){this._eventInfos={};this._eventHandlers={};this._queuedEventsArgs={};this._eventHandlers={};this._queuedEventsArgs={};if(a!=null)for(var b=0;b<a.length;b++){var c=a[b].type;this._eventInfos[c]=a[b];this._eventHandlers[c]=[];this._queuedEventsArgs[c]=[]}}a.prototype.getSupportedEvents=function(){var a=[];for(var b in this._eventHandlers)a.push(b);return a};a.prototype.supportsEvent=function(b){for(var a in this._eventHandlers)if(b==a)return true;return false};a.prototype.hasEventHandler=function(c,d){var a=this._eventHandlers[c];if(a&&a.length>0)for(var b=0;b<a.length;b++)if(a[b]===d)return true;return false};a.prototype.addEventHandler=function(b,a){if(typeof a!="function")return false;var c=this._eventHandlers[b];if(c&&!this.hasEventHandler(b,a)){c.push(a);return true}else return false};a.prototype.addEventHandlerAndFireQueuedEvent=function(a,e){var b=this._eventHandlers[a],d=!b||b.length==0,c=this.addEventHandler(a,e);d&&c&&this.fireQueuedEvent(a);return c};a.prototype.removeEventHandler=function(c,d){var a=this._eventHandlers[c];if(a&&a.length>0)for(var b=0;b<a.length;b++)if(a[b]===d){a.splice(b,1);return true}return false};a.prototype.clearEventHandlers=function(a){if(typeof this._eventHandlers[a]!="undefined"&&this._eventHandlers[a].length>0){this._eventHandlers[a]=[];return true}return false};a.prototype.getEventHandlerCount=function(a){return this._eventHandlers[a]!=undefined?this._eventHandlers[a].length:-1};a.prototype.getEventInfo=function(a){return this._eventInfos[a]};a.prototype.fireEvent=function(a){if(a.type==undefined)return false;var b=a.type;if(b&&this._eventHandlers[b]){for(var d=this._eventHandlers[b],c=0;c<d.length;c++)d[c](a);return true}else return false};a.prototype.fireQueuedEvent=function(a){if(a&&this._eventHandlers[a]){var b=this._eventHandlers[a],c=this._queuedEventsArgs[a];if(b.length>0){var d=b[0];while(c.length>0){var e=c.shift();d(e)}return true}}return false};a.prototype.clearQueuedEvent=function(a){if(a&&this._eventHandlers[a]){var b=this._queuedEventsArgs[a];if(b)this._queuedEventsArgs[a]=[]}};return a}();b.EventDispatch=a})(OSF||(OSF={}));var OSF;(function(a){var b=function(){function b(){}b.addEventHandler=function(g,l,h,e,j){var f=0;function d(b){if(b==0){var d=e.addEventHandler(g,l);if(!d)b=5010}var c=a.Bootstrap.getAsyncMethodExecutor();c.invokeCallback(f,h,b,null)}var c=e.getEventInfo(g);if(!c){d(5010);return}try{if(j){d(0);return}f=c.id;var k=c.getTargetId(),m=e.getEventHandlerCount(g);if(m==0){var i=a.Bootstrap.getAsyncMethodExecutor();i.registerEventAsync(f,c.type,k,function(a){e.fireEvent(a)},c,function(b){d(a.OsfUtility.getErrorCodeFromAsyncResult(b))})}else d(0)}catch(n){b.onException(f,n,h)}};b.removeEventHandler=function(f,k,j,c,o){var g=0;function h(c){var b=a.Bootstrap.getAsyncMethodExecutor();b.invokeCallback(g,j,c,null)}var e=c.getEventInfo(f);if(!e){h(5010);return}try{g=e.id;var m=e.getTargetId(),i=0,d=true;if(k===null){d=c.clearEventHandlers(f);i=0}else{d=c.removeEventHandler(f,k);i=d?0:5003}var n=c.getEventHandlerCount(f);if(d&&n==0){var l=a.Bootstrap.getAsyncMethodExecutor();l.unregisterEventAsync(g,e.type,m,function(b){h(a.OsfUtility.getErrorCodeFromAsyncResult(b))})}else h(i)}catch(p){b.onException(g,p,j)}};b.onException=function(e,b,d){if(typeof b=="number"){var c=a.Bootstrap.getAsyncMethodExecutor();c.invokeCallback(e,d,b,null)}else throw b;};return b}();a.EventHelper=b})(OSF||(OSF={}));var OSF;(function(a){var b;(function(a){a.RichApiMessage="richApiMessage";a.BindingSelectionChanged="bindingSelectionChanged";a.BindingDataChanged="bindingDataChanged";a.DataNodeDeleted="nodeDeleted";a.DataNodeInserted="nodeInserted";a.DataNodeReplaced="nodeReplaced";a.SettingsChanged="settingsChanged"})(b=a.EventType||(a.EventType={}))})(OSF||(OSF={}));var OSF;(function(a){var b;(function(b){var c=function(){function b(){this.platformRemappings={web:Office.PlatformType.OfficeOnline,winrt:Office.PlatformType.Universal,win32:Office.PlatformType.PC,mac:Office.PlatformType.Mac,ios:Office.PlatformType.iOS,android:Office.PlatformType.Android};this.camelCaseMappings={powerpoint:Office.HostType.PowerPoint,onenote:Office.HostType.OneNote};this.hostInfo=a.Bootstrap.getHostInfo()}b.prototype.capitalizeFirstLetter=function(a){if(a)return a[0].toUpperCase()+a.slice(1).toLowerCase();return a};b.getInstance=function(){if(b.hostObj===undefined)b.hostObj=new b;return b.hostObj};b.prototype.getPlatform=function(b){if(this.hostInfo.hostPlatform){var a=this.hostInfo.hostPlatform.toLowerCase();if(this.platformRemappings[a])return this.platformRemappings[a]}return null};b.prototype.getHost=function(b){if(this.hostInfo.hostType){var a=this.hostInfo.hostType.toLowerCase();if(this.camelCaseMappings[a])return this.camelCaseMappings[a];a=this.capitalizeFirstLetter(this.hostInfo.hostType);if(Office.HostType[a])return Office.HostType[a]}return null};b.prototype.getDefaultVersion=function(){if(this.getHost())return"16.0.0000.0000";return null};b.prototype.getDiagnostics=function(b){var a={host:this.getHost(),version:b||this.getDefaultVersion(),platform:this.getPlatform()};return a};return b}();b.Host=c})(b=a.HostName||(a.HostName={}))})(OSF||(OSF={}));var OSF;(function(a){var b;(function(a){a.web="web";a.winrt="winrt";a.win32="win32";a.mac="mac";a.ios="ios";a.android="android"})(b=a.HostInfoPlatform||(a.HostInfoPlatform={}))})(OSF||(OSF={}));var OSF;(function(a){var b=function(){function b(c,a,d,b){this._hostInfo=c;this._webAppState=a;this._context=d;this._hostFacade=b}b.prototype.saveAndSetDialogInfo=function(a){};b.prototype.setAgaveHostCommunication=function(){};b.prototype.createClientHostController=function(){return null};b.prototype.createAsyncMethodExecutor=function(a){return null};b.prototype.deserializeSettings=function(c){var d=a.OUtil.getSessionStorage();if(d){var b=d.getItem(a.Bootstrap.getCachedSessionSettingsKey());if(b)c=JSON.parse(b);else{b=JSON.stringify(c);d.setItem(a.Bootstrap.getCachedSessionSettingsKey(),b)}}var e=a.OUtil.deserializeSettings(c),f=new Office.Settings(e);return f};return b}();a.InitializationHelper=b})(OSF||(OSF={}));var OSF;(function(a){var b;(function(a){a.Inserted="inserted";a.DocumentOpened="documentOpened"})(b=a.InitializationReason||(a.InitializationReason={}))})(OSF||(OSF={}));var OSF;(function(a){var b=function(){function b(){}b.isDate=function(a){return Object.prototype.toString.apply(a)==="[object Date]"};b.addEventListener=function(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else if(a.attachEvent)a.attachEvent("on"+b,c);else throw new Error("Cannot attach event");};b.removeEventListener=function(a,b,c){if(a.removeEventListener)a.removeEventListener(b,c,false);else if(a.detachEvent)a.detachEvent("on"+b,c);else throw new Error("Cannot remove event");};b.serializeSettings=function(d){var f={};for(var e in d){var c=d[e];try{c=JSON.stringify(c,function(c,d){return a.OUtil.isDate(this[c])?b.DateJSONPrefix+this[c].getTime()+b.DataJSONSuffix:d});f[e]=c}catch(g){}}return f};b.deserializeSettings=function(a){var e={};a=a||{};for(var d in a){var c=a[d];try{c=JSON.parse(c,function(d,a){var c;if(typeof a==="string"&&a&&a.length>6&&a.slice(0,5)===b.DateJSONPrefix&&a.slice(-1)===b.DataJSONSuffix){c=new Date(parseInt(a.slice(5,-1)));if(c)return c}return a});e[d]=c}catch(f){}}return e};b.getSessionStorage=function(){if(!b._safeSessionStorage){try{var c=window.sessionStorage}catch(d){c=null}b._safeSessionStorage=new a.SafeStorage(c)}return b._safeSessionStorage};b.convertIntToCssHexColor=function(b){var a="#"+(Number(b)+16777216).toString(16).slice(-6);return a};b.parseAppContextFromWindowName=function(c,d){return b.parseInfoFromWindowName(c,d,a.WindowNameItemKeys.AppContext)};b.parseHostInfoFromWindowName=function(b,c){return a.OUtil.parseInfoFromWindowName(b,c,a.WindowNameItemKeys.HostInfo)};b.parseXdmInfo=function(c){var a=b.parseXdmInfoWithGivenFragment(c,window.location.hash);if(!a)a=b.parseXdmInfoFromWindowName(c,window.name);return a};b.parseXdmInfoFromWindowName=function(b,c){return a.OUtil.parseInfoFromWindowName(b,c,a.WindowNameItemKeys.XdmInfo)};b.parseXdmInfoWithGivenFragment=function(c,d){return a.OUtil.parseInfoWithGivenFragment(b._xdmInfoKey,b._xdmSessionKeyPrefix,false,c,d)};b.parseSerializerVersion=function(c){var b=a.OUtil.parseSerializerVersionWithGivenFragment(c,window.location.hash);if(isNaN(b))b=a.OUtil.parseSerializerVersionFromWindowName(c,window.name);return b};b.parseSerializerVersionFromWindowName=function(b,c){return parseInt(a.OUtil.parseInfoFromWindowName(b,c,a.WindowNameItemKeys.SerializerVersion))};b.parseSerializerVersionWithGivenFragment=function(c,d){return parseInt(a.OUtil.parseInfoWithGivenFragment(b._serializerVersionKey,b._serializerVersionKeyPrefix,true,c,d))};b.parseInfoFromWindowName=function(h,i,g){try{var c=JSON.parse(i),d=c!=null?c[g]:null,e=b.getSessionStorage();if(!h&&e&&c!=null){var f=c[a.WindowNameItemKeys.BaseFrameName]+g;if(d)e.setItem(f,d);else d=e.getItem(f)}return d}catch(j){return null}};b.parseInfoWithGivenFragment=function(l,i,j,h,k){var e=k.split(l),a=e.length>1?e[e.length-1]:null;if(j&&a!=null){if(a.indexOf(b._fragmentInfoDelimiter)>=0)a=a.split(b._fragmentInfoDelimiter)[0];a=decodeURIComponent(a)}var c=b.getSessionStorage();if(!h&&c){var d=window.name.indexOf(i);if(d>-1){var f=window.name.indexOf(";",d);if(f==-1)f=window.name.length;var g=window.name.substring(d,f);if(a)c.setItem(g,a);else a=c.getItem(g)}}return a};b.getConversationId=function(){var b=window.location.search,a=null;if(b){var c=b.indexOf("&");a=c>0?b.substring(1,c):b.substr(1);if(a&&a.charAt(a.length-1)==="="){a=a.substring(0,a.length-1);if(a)a=decodeURIComponent(a)}}return a};b.getInfoItems=function(b){var a=b.split("$");if(typeof a[1]=="undefined")a=b.split("|");if(typeof a[1]=="undefined")a=b.split("%7C");return a};b.getXdmFieldValue=function(f,e){var c="",d=a.OUtil.parseXdmInfo(e);if(d){var b=a.OUtil.getInfoItems(d);if(b!=undefined&&b.length>=3)switch(f){case a.XdmFieldName.ConversationUrl:c=b[2];break;case a.XdmFieldName.AppId:c=b[1];break}}return c};b._reOrderTabbableElements=function(e){for(var c=[],b=[],f=e.length,a,d=0;d<f;d++){a=e[d];if(a.tabIndex)if(a.tabIndex>0)b.push(a);else a.tabIndex===0&&c.push(a);else c.push(a)}b=b.sort(function(d,c){var a=d.tabIndex-c.tabIndex;if(a===0)a=b.indexOf(d)-b.indexOf(c);return a});return[].concat(b,c)};b.focusToFirstTabbable=function(a,f){var d,e=false,c,g=function(a){e=true},h=function(c,a,b){if(a<0||a>c)return-1;else if(a===0&&b)return-1;else if(a===c-1&&!b)return-1;if(b)return a-1;else return a+1};a=b._reOrderTabbableElements(a);d=f?a.length-1:0;if(a.length===0)return null;while(!e&&d>=0&&d<a.length){c=a[d];window.focus();c.addEventListener("focus",g);c.focus();c.removeEventListener("focus",g);d=h(a.length,d,f);if(!e&&c===document.activeElement)e=true}if(e)return c;else return null};b.focusToNextTabbable=function(c,k,i){var g,a,e=false,d,h=function(a){e=true},j=function(b,c){for(var a=0;a<b.length;a++)if(b[a]===c)return a;return-1},f=function(c,a,b){if(a<0||a>c)return-1;else if(a===0&&b)return-1;else if(a===c-1&&!b)return-1;if(b)return a-1;else return a+1};c=b._reOrderTabbableElements(c);g=j(c,k);a=f(c.length,g,i);if(a<0)return null;while(!e&&a>=0&&a<c.length){d=c[a];d.addEventListener("focus",h);d.focus();d.removeEventListener("focus",h);a=f(c.length,a,i);if(!e&&d===document.activeElement)e=true}if(e)return d;else return null};b._uniqueId=-1;b._xdmInfoKey="&_xdm_Info=";b._serializerVersionKey="&_serializer_version=";b._xdmSessionKeyPrefix="_xdm_";b._serializerVersionKeyPrefix="_serializer_version=";b._fragmentSeparator="#";b._fragmentInfoDelimiter="&";b.DateJSONPrefix="Date(";b.DataJSONSuffix=")";return b}();a.OUtil=b})(OSF||(OSF={}));var Office;(function(a){var b;(function(b){var c;(function(c){function f(){return OSF.Bootstrap.getOfficeAppContext().get_docUrl()}OSF.definePropertyOnNamespace(c,"url",f);function e(){var b=OSF.Bootstrap.getOfficeAppContext().get_clientMode();if(b==0)return a.DocumentMode.ReadOnly;return a.DocumentMode.ReadWrite}OSF.definePropertyOnNamespace(c,"mode",e);var b;function d(){if(!b){var a=OSF.Bootstrap.getOfficeAppContext().get_settingsFunc();b=a()}return b}OSF.definePropertyOnNamespace(c,"settings",d)})(c=b.document||(b.document={}))})(b=a.context||(a.context={}))})(Office||(Office={}));var Office;(function(a){var b;(function(a){function e(){return OSF.Bootstrap.getOfficeAppContext().get_dataLocale()}OSF.definePropertyOnNamespace(a,"contentLanguage",e);function f(){return OSF.Bootstrap.getOfficeAppContext().get_appUILocale()}OSF.definePropertyOnNamespace(a,"displayLanguage",f);function k(){return OSF.Bootstrap.getHostInfo().isDialog}OSF.definePropertyOnNamespace(a,"isDialog",k);function h(){return OSF.Bootstrap.getOfficeAppContext().get_touchEnabled()}OSF.definePropertyOnNamespace(a,"touchEnabled",h);function d(){return OSF.Bootstrap.getOfficeAppContext().get_commerceAllowed()}OSF.definePropertyOnNamespace(a,"commerceAllowed",d);function m(){return OSF.HostName.Host.getInstance().getHost()}OSF.definePropertyOnNamespace(a,"host",m);function l(){return OSF.HostName.Host.getInstance().getPlatform()}OSF.definePropertyOnNamespace(a,"platform",l);function i(){return OSF.HostName.Host.getInstance().getDiagnostics(OSF.Bootstrap.getOfficeAppContext().get_hostFullVersion())}OSF.definePropertyOnNamespace(a,"diagnostics",i);var b;function g(){if(!b){var a=OSF.Bootstrap.getOfficeAppContext();if(a.get_isDialog())b=OSF.Requirement.RequirementsMatrixFactory.getDefaultDialogRequirementMatrix(a);else b=OSF.Requirement.RequirementsMatrixFactory.getDefaultRequirementMatrix(a)}return b}OSF.definePropertyOnNamespace(a,"requirements",g);var c;function j(){if(!c){var a=OSF.Bootstrap.getOfficeAppContext().get_officeThemeFunc();if(a)c=a();else return undefined}return c}OSF.definePropertyOnNamespace(a,"officeTheme",j)})(b=a.context||(a.context={}))})(Office||(Office={}));var Office;(function(a){var f=false,b=null,c=null;function d(){if(!b)b=new Promise(function(a,b){c=a})}function e(a){d();a&&b.then(function(b){a(b)});return b}a.onReadyInternal=e;function h(a){f=true;return e(a)}a.onReady=h;function g(b){d();c(b);typeof a.initialize==="function"&&a.initialize()}a.fireOnReady=g})(Office||(Office={}));var OSF;(function(b){var a=function(){function a(z,v,r,p,t,w,s,n,y,j,x,l,k,o,g,f,e,d,h,b,c,u,q,a,m,i){this._isDialog=false;this._id=z;this._appName=v;this._appVersion=r;this._appUILocale=p;this._dataLocale=t;this._docUrl=w;this._clientMode=s;this._settingsFunc=n;this._reason=y;this._osfControlType=j;this._eToken=x;this._correlationId=l;this._appInstanceId=k;this._touchEnabled=o;this._commerceAllowed=g;this._appMinorVersion=f;this._requirementMatrix=e;this._hostCustomMessage=d;this._hostFullVersion=h;this._isDialog=false;this._clientWindowHeight=b;this._clientWindowWidth=c;this._addinName=u;this._appDomains=q;this._dialogRequirementMatrix=a;this._featureGates=m;this._officeThemeFunc=i}a.prototype.get_id=function(){return this._id};a.prototype.get_appName=function(){return this._appName};a.prototype.get_appVersion=function(){return this._appVersion};a.prototype.get_appUILocale=function(){return this._appUILocale};a.prototype.get_dataLocale=function(){return this._dataLocale};a.prototype.get_docUrl=function(){return this._docUrl};a.prototype.get_clientMode=function(){return this._clientMode};a.prototype.get_settingsFunc=function(){return this._settingsFunc};a.prototype.get_reason=function(){return this._reason};a.prototype.get_osfControlType=function(){return this._osfControlType};a.prototype.get_eToken=function(){return this._eToken};a.prototype.get_correlationId=function(){return this._correlationId};a.prototype.get_appInstanceId=function(){return this._appInstanceId};a.prototype.get_touchEnabled=function(){return this._touchEnabled};a.prototype.get_commerceAllowed=function(){return this._commerceAllowed};a.prototype.get_appMinorVersion=function(){return this._appMinorVersion};a.prototype.get_requirementMatrix=function(){return this._requirementMatrix};a.prototype.get_dialogRequirementMatrix=function(){return this._dialogRequirementMatrix};a.prototype.get_hostCustomMessage=function(){return this._hostCustomMessage};a.prototype.get_hostFullVersion=function(){return this._hostFullVersion};a.prototype.get_isDialog=function(){return this._isDialog};a.prototype.get_clientWindowHeight=function(){return this._clientWindowHeight};a.prototype.get_clientWindowWidth=function(){return this._clientWindowWidth};a.prototype.get_addinName=function(){return this._addinName};a.prototype.get_appDomains=function(){return this._appDomains};a.prototype.get_featureGates=function(){return this._featureGates};a.prototype.get_officeThemeFunc=function(){return this._officeThemeFunc};return a}();b.OfficeAppContext=a})(OSF||(OSF={}));var Office;(function(a){var b;(function(a){a.succeeded="succeeded";a.failed="failed"})(b=a.AsyncResultStatus||(a.AsyncResultStatus={}));var c;(function(a){a.ReadOnly="readOnly";a.ReadWrite="readWrite"})(c=a.DocumentMode||(a.DocumentMode={}));var e;(function(a){a.Word="Word";a.Excel="Excel";a.PowerPoint="PowerPoint";a.Outlook="Outlook";a.OneNote="OneNote";a.Project="Project";a.Access="Access";a.Visio="Visio"})(e=a.HostType||(a.HostType={}));var d;(function(a){a.PC="PC";a.OfficeOnline="OfficeOnline";a.Mac="Mac";a.iOS="iOS";a.Android="Android";a.Universal="Universal"})(d=a.PlatformType||(a.PlatformType={}))})(Office||(Office={}));var OfficeExt;(function(b){function a(b,c,d,a){return false}b.appSpecificCheckOrigin=a})(OfficeExt||(OfficeExt={}));var OSF;(function(a){var c=function(){function a(c,b,a){this._method=c;this._invokeType=b;this._blockingOthers=a}a.prototype.getMethod=function(){return this._method};a.prototype.getInvokeType=function(){return this._invokeType};a.prototype.getBlockingFlag=function(){return this._blockingOthers};return a}();a.XdmMethodObject=c;var e=function(){function a(b,a){this._registerMethodObject=b;this._unregisterMethodObject=a}a.prototype.getRegisterMethodObject=function(){return this._registerMethodObject};a.prototype.getUnregisterMethodObject=function(){return this._unregisterMethodObject};return a}();a.XdmEventMethodObject=e;var h=function(){function b(a){this._methodObjectList={};this._eventHandlerProxyList={};this._conversations={};this._policyManager=null;this._appDomains={};this._onHandleRequestError=null;this._methodObjectList={};this._eventHandlerProxyList={};this._Id=a;this._conversations={};this._policyManager=null;this._appDomains={};this._onHandleRequestError=null}b.prototype.registerMethod=function(f,g,b,d){if(b!==0&&b!==1)throw a.OsfUtility.createArgumentException("invokeType");var e=new c(g,b,d);this._methodObjectList[f]=e};b.prototype.unregisterMethod=function(a){delete this._methodObjectList[a]};b.prototype.registerEvent=function(f,b,a){var d=new e(new c(b,4,false),new c(a,5,false));this._methodObjectList[f]=d};b.prototype.registerEventEx=function(h,f,b,d,a){var g=new e(new c(f,b,false),new c(d,a,false));this._methodObjectList[h]=g};b.prototype.unregisterEvent=function(a){this.unregisterMethod(a)};b.prototype.registerConversation=function(b,d,c,e){a.OsfUtility.log("registerConversation: cId="+b+" Url="+d);if(c){if(!Array.isArray(c))throw a.OsfUtility.createArgumentException("appDomains");this._appDomains[b]=c}this._conversations[b]={url:d,serializerVersion:e}};b.prototype.unregisterConversation=function(a){delete this._conversations[a]};b.prototype.setPolicyManager=function(b){if(!b.checkPermission)throw a.OsfUtility.createArgumentException("policyManager");this._policyManager=b};b.prototype.getPolicyManager=function(){return this._policyManager};b.prototype.dispose=function(){this._methodObjectList=null;this._eventHandlerProxyList=null;this._Id=null;this._conversations=null;this._policyManager=null;this._appDomains=null;this._onHandleRequestError=null};return b}();a.XdmServiceEndPoint=h;var i=function(){function a(b,c,d,a){this._callbackList={};this._eventHandlerList={};this._conversationId=b;this._targetWindow=c;this._targetUrl=d;this._callingIndex=0;this._callbackList={};this._eventHandlerList={};if(a!=null)this._serializerVersion=a;else this._serializerVersion=1;this._onSenderOriginNotTrusted=null}a.prototype.invoke=function(h,e,a){var c=this._callingIndex++,k=new Date,f={callback:e,createdOn:k.getTime()};if(a&&typeof a==="object"&&typeof a.__timeout__==="number"){f.timeout=a.__timeout__;delete a.__timeout__}this._callbackList[c]=f;try{var i=new g(h,0,this._conversationId,c,a),j=b.envelope(i,this._serializerVersion);this._targetWindow.postMessage(j,this._targetUrl);d._startMethodTimeoutTimer()}catch(l){try{e!==null&&e(-1,l)}finally{delete this._callbackList[c]}}};a.prototype.registerForEvent=function(e,f,c,i){var a=this._callingIndex++,k=new Date;this._callbackList[a]={callback:c,createdOn:k.getTime()};try{var h=new g(e,1,this._conversationId,a,i),j=b.envelope(h,this._serializerVersion);this._targetWindow.postMessage(j,this._targetUrl);d._startMethodTimeoutTimer();this._eventHandlerList[e]=f}catch(l){try{c!==null&&c(-1,l)}finally{delete this._callbackList[a]}}};a.prototype.unregisterForEvent=function(e,c,h){var a=this._callingIndex++,j=new Date;this._callbackList[a]={callback:c,createdOn:j.getTime()};try{var f=new g(e,2,this._conversationId,a,h),i=b.envelope(f,this._serializerVersion);this._targetWindow.postMessage(i,this._targetUrl);d._startMethodTimeoutTimer()}catch(k){try{c!==null&&c(-1,k)}finally{delete this._callbackList[a]}}finally{delete this._eventHandlerList[e]}};return a}();a.XdmClientEndPoint=i;var d;(function(c){var q=[],o=null,g=null,t=10,j=false,p=null,S=2e3,s=65e3,v=s,e={},d={},w=false;function C(c){for(var b in e)if(e[b]._conversations[c])return e[b];throw a.OsfUtility.createArgumentException("conversationId");}function F(c){var b=d[c];!b&&a.OsfUtility.log("Unknown conversation Id.");return b}function I(e,c){var b=e._methodObjectList[c._actionName];if(!b){a.OsfUtility.log("The specified method is not registered on service endpoint:"+c._actionName);throw a.OsfUtility.createArgumentException("messageObject");}var d=null;if(c._actionType===0)d=b;else if(c._actionType===1)d=b.getRegisterMethodObject();else d=b.getUnregisterMethodObject();return d}function O(a){q.push(a)}function N(){if(g!==null){if(!j)if(q.length>0){var b=q.shift();u(b)}else{clearInterval(g);g=null}}else a.OsfUtility.log("channel is not ready.")}function u(a){j=a.getInvokeBlockingFlag();a.invoke();o=+new Date}function T(){if(p){var c,f=0,i=new Date,e;for(var h in d){c=d[h];for(var g in c._callbackList){var b=c._callbackList[g];e=b.timeout?b.timeout:v;if(e>=0&&Math.abs(i.getTime()-b.createdOn)>=e)try{b.callback&&b.callback(-6,null)}finally{delete c._callbackList[g]}else f++}}if(f===0){clearInterval(p);p=null}}else a.OsfUtility.log("channel is not ready.")}function H(){j=false}function L(b){if(window.addEventListener)window.addEventListener("message",b,false);else if(navigator.userAgent.indexOf("MSIE")>-1&&window.attachEvent)window.attachEvent("onmessage",b);else{a.OsfUtility.log("Browser doesn't support the required API.");throw a.OsfUtility.createArgumentException("Browser");}}function P(b,a){var e=false;if(!b||!a||b==="null"||a==="null"||!b.length||!a.length)return e;var d,c;d=document.createElement("a");c=document.createElement("a");d.href=b;c.href=a;e=y(d,c);return e}function n(a,b){var c=false;if(!b||b==="null"||!b.length||!a||!(a instanceof Array)||!a.length)return c;var f=document.createElement("a"),e=document.createElement("a");f.href=b;for(var d=0;d<a.length&&!c;d++)if(a[d].indexOf("://")!==-1){e.href=a[d];c=y(f,e)}return c}function r(a){if(!a||a==="null")return false;var b=["^office-int\\.com$","^officeapps\\.live-int\\.com$","^.*\\.dod\\.online\\.office365\\.us$","^.*\\.gov\\.online\\.office365\\.us$","^.*\\.officeapps\\.live\\.com$","^.*\\.officeapps\\.live-int\\.com$","^.*\\.officeapps-df\\.live\\.com$","^.*\\.online\\.office\\.de$","^.*\\.partner\\.officewebapps\\.cn$","^"+document.domain.replace(new RegExp("\\.","g"),"\\.")+"$"],c=new RegExp(b.join("|"));return c.test(a)}function k(e,f){if(!e||!f||e==="null"||f==="null")return false;var b=document.createElement("a");b.href=e;var c=document.createElement("a");c.href=f;var j=b.protocol===c.protocol,k=b.port===c.port,d=c.hostname,a=b.hostname,g=d===a,h=false;if(!g&&d.length>a.length+1)h=d.slice(-(a.length+1))==="."+a;var i=g||h;return k&&j&&i}function y(a,b){return a.hostname==b.hostname&&a.protocol==b.protocol&&a.port==b.port}function Q(d){if(d.data!=""){var c,i=1,y=d.data;try{c=b.unenvelope(y,1);i=c._serializerVersion!=null?c._serializerVersion:i}catch(T){return}a.OsfUtility.debugLog(y);if(c._messageType===0){var s=d.origin==null||d.origin==="null"?c._origin:d.origin;try{var h=C(c._conversationId);a.OsfUtility.log("_receive: request, origin="+s+" sourceURL:"+h._conversations[c._conversationId]);var p=h._conversations[c._conversationId];i=p.serializerVersion!=null?p.serializerVersion:i;a.OsfUtility.log("_receive: request, origin="+s+" sourceURL:"+p.url);var z=[p.url].concat(h._appDomains[c._conversationId]);if(!n(z,d.origin))if(!OfficeExt.appSpecificCheckOrigin(z,d,c._origin,n)){var K=k(p.url,d.origin);if(!K)throw"Failed origin check";}var B=h.getPolicyManager();if(B&&!B.checkPermission(c._conversationId,c._actionName,c._data))throw"Access Denied";var R=I(h,c),J=new l(d.source,s,c._actionName,c._conversationId,c._correlationId,H,i),G=new m(R,c._data,J,h._eventHandlerProxyList,c._conversationId,c._actionName,i),D=true;if(g==null)if((o==null||+new Date-o>t)&&!j){u(G);D=false}else g=setInterval(N,t);D&&O(G)}catch(T){h&&h._onHandleRequestError&&h._onHandleRequestError(c,T);var E=-2;if(T=="Access Denied")E=-5;var Q=new f(c._actionName,c._conversationId,c._correlationId,E,0,T),L=b.envelope(Q,i),A=false;try{A=!!(d.source&&d.source.postMessage)}catch(T){}var q=false;if(window.location.href&&d.origin&&d.origin!=="null"&&k(window.location.href,d.origin))q=true;else if(d.origin&&d.origin!=="null"){var v=document.createElement("a");v.href=d.origin;q=r(v.hostname)}A&&q&&d.source.postMessage(L,s)}}else if(c._messageType===1){var e=F(c._conversationId);if(c._actionName=="ContextActivationManager_getAppContextAsync")try{var S=d.origin,v=document.createElement("a");v.href=S;var q=r(v.hostname),M=q?1:0;if(!M)e&&e._onSenderOriginNotTrusted&&e._onSenderOriginNotTrusted()}catch(T){}if(!e)return;e._serializerVersion=i;a.OsfUtility.log("_receive: response, origin="+d.origin+" targetURL:"+e._targetUrl);if(!P(e._targetUrl,d.origin))throw"Failed orgin check";if(c._responseType===0){var w=e._callbackList[c._correlationId];if(w)try{w.callback&&w.callback(c._errorCode,c._data)}finally{delete e._callbackList[c._correlationId]}}else{var x=e._eventHandlerList[c._actionName];x!==undefined&&x!==null&&x(c._data)}}else return}}function x(){if(!w){L(Q);w=true}}function R(b,e,f,c){var a=d[b];if(!a){x();a=new i(b,e,f,c);d[b]=a}return a}c.connect=R;function K(a){return d[a]}c.getClientEndPoint=K;function D(a){x();var b=new h(a);e[a]=b;return b}c.createServiceEndPoint=D;function J(a){return e[a]}c.getServiceEndPoint=J;function G(a){delete d[a]}c.deleteClientEndPoint=G;function E(a){delete e[a]}c.deleteServiceEndPoint=E;function B(a,b){return n(a,b)}c.checkUrlWithAppDomains=B;function z(a,b){return k(a,b)}c.isTargetSubdomainOfSourceLocation=z;function M(a){v=a<=0?s:a}c._setMethodTimeout=M;function A(){}c._startMethodTimeoutTimer=A})(d=a.XdmCommunicationManager||(a.XdmCommunicationManager={}));var k=function(){function a(d,e,b,c,a){this._messageType=d;this._actionName=e;this._conversationId=b;this._correlationId=c;this._origin=window.location.href;if(typeof a==="undefined")this._data=null;else this._data=a}a.prototype.getActionName=function(){return this._actionName};a.prototype.getConversationId=function(){return this._conversationId};a.prototype.getCorrelationId=function(){return this._correlationId};a.prototype.getOrigin=function(){return this._origin};a.prototype.getData=function(){return this._data};a.prototype.getMessageType=function(){return this._messageType};return a}(),g=function(b){__extends(a,b);function a(e,f,c,d,g){var a=b.call(this,0,e,c,d,g)||this;a._actionType=f;return a}a.prototype.getActionType=function(){return this._actionType};return a}(k),f=function(b){__extends(a,b);function a(f,c,d,g,e,h){var a=b.call(this,1,f,c,d,h)||this;a._errorCode=g;a._responseType=e;return a}a.prototype.getErrorCode=function(){return this._errorCode};a.prototype.getResponseType=function(){return this._responseType};return a}(k),b=function(){function a(){}a.envelope=function(a,b){if(typeof a==="object")a._serializerVersion=1;return JSON.stringify(a)};a.unenvelope=function(a,b){return JSON.parse(a)};return a}(),j=function(){function c(e,i,k,g,h,j,d){var c=this;this._invokeResultCode=0;this._requesterWindow=e;this._requesterUrl=i;this._actionName=k;this._conversationId=g;this._correlationId=h;this._invokeResultCode=0;this._responseType=j;this._serializerVersion=d;this._send=function(g){try{var e=new f(c._actionName,c._conversationId,c._correlationId,c._invokeResultCode,c._responseType,g),d=b.envelope(e,c._serializerVersion);c._requesterWindow.postMessage(d,c._requesterUrl);a.OsfUtility.log("_send: requestUrl="+c._requesterUrl+" _actionName:"+c._actionName)}catch(h){a.OsfUtility.log("ResponseSender._send error:"+h.message)}}}c.prototype.getRequesterWindow=function(){return this._requesterWindow};c.prototype.getRequesterUrl=function(){return this._requesterUrl};c.prototype.getActionName=function(){return this._actionName};c.prototype.getConversationId=function(){return this._conversationId};c.prototype.getCorrelationId=function(){return this._correlationId};c.prototype.getSend=function(){return this._send};c.prototype.setResultCode=function(a){this._invokeResultCode=a};return c}(),l=function(d){__extends(c,d);function c(h,k,l,i,j,e,g){var c=d.call(this,h,k,l,i,j,0,g)||this;c._postCallbackHandler=e;c._send=function(h,d){if(d!=undefined)c._invokeResultCode=d;try{var g=new f(c._actionName,c._conversationId,c._correlationId,c._invokeResultCode,c._responseType,h),e=b.envelope(g,c._serializerVersion);c._requesterWindow.postMessage(e,c._requesterUrl);c._postCallbackHandler()}catch(i){a.OsfUtility.log("InvokeCompleteCallback._send error:"+i.message)}};return c}return c}(j),m=function(){function a(e,f,a,b,d,g,c){this._callerId="";this._methodObject=e;this._param=f;this._invokeCompleteCallback=a;this._eventHandlerProxyList=b;this._conversationId=d;this._eventName=g;this._serializerVersion=c}a.prototype.invoke=function(){try{var a;switch(this._methodObject.getInvokeType()){case 0:this._methodObject.getMethod()(this._param,this._invokeCompleteCallback.getSend());break;case 1:a=this._methodObject.getMethod()(this._param);this._invokeCompleteCallback.getSend()(a);break;case 4:var c=this._createEventHandlerProxyObject(this._invokeCompleteCallback);a=this._methodObject.getMethod()(c.getSend(),this._param);this._eventHandlerProxyList[this._conversationId+this._eventName]=c.getSend();this._invokeCompleteCallback.getSend()(a);break;case 5:var e=this._eventHandlerProxyList[this._conversationId+this._eventName];a=this._methodObject.getMethod()(e,this._param);delete this._eventHandlerProxyList[this._conversationId+this._eventName];this._invokeCompleteCallback.getSend()(a);break;case 2:var b=this._createEventHandlerProxyObject(this._invokeCompleteCallback);this._methodObject.getMethod()(b.getSend(),this._invokeCompleteCallback.getSend(),this._param);this._eventHandlerProxyList[this._callerId+this._eventName]=b.getSend();break;case 3:var d=this._eventHandlerProxyList[this._callerId+this._eventName];this._methodObject.getMethod()(d,this._invokeCompleteCallback.getSend(),this._param);delete this._eventHandlerProxyList[this._callerId+this._eventName];break;default:break}}catch(f){this._invokeCompleteCallback.setResultCode(-3);this._invokeCompleteCallback.getSend()(f)}};a.prototype.getInvokeBlockingFlag=function(){return this._methodObject.getBlockingFlag()};a.prototype._createEventHandlerProxyObject=function(a){return new j(a.getRequesterWindow(),a.getRequesterUrl(),a.getActionName(),a.getConversationId(),a.getCorrelationId(),1,this._serializerVersion)};return a}()})(OSF||(OSF={}));var OSF;(function(b){var a=function(){function a(){}a.createArgumentException=function(a){return new Error("Invalid argument "+a)};a.createNotImplementedException=function(){return new Error("Not implemented yet")};a.log=function(a){console.log(a)};a.trace=function(a){console.log(a)};a.debugLog=function(a){console.log(a)};a.createPromiseFromResult=function(a){return Promise.resolve(a)};a.compareVersions=function(d,e){var b=d.split("."),c=e.split("."),a;for(a in b)if(parseInt(b[a])<parseInt(c[a]))return false;else if(parseInt(b[a])>parseInt(c[a]))return true;return false};a.getQueryStringValue=function(b){if(window.location.search){var c=new RegExp("[?&]"+b+"=([^&]*)"),a=c.exec(window.location.search);if(a){var d=a[1];return d}}return null};a.getErrorCodeFromAsyncResult=function(a){if(a.status===Office.AsyncResultStatus.succeeded)return 0;if(a.error&&a.error.code)return a.error.code;return 5001};return a}();b.OsfUtility=a})(OSF||(OSF={}));var OSF;(function(a){var b;(function(a){a.Callback="callback";a.AsyncContext="asyncContext";a.Data="data";a.MessageToParent="messageToParent";a.MessageContent="messageContent";a.AppCommandInvocationCompletedData="appCommandInvocationCompletedData"})(b=a.ParameterNames||(a.ParameterNames={}))})(OSF||(OSF={}));var OSF;(function(a){var b;(function(a){var y=function(){function a(){}return a}();a.RequirementVersion=y;var c=function(){function a(a){this._setMap=a}a.prototype.isSetSupported=function(d,b){if(d==undefined)return false;if(b==undefined)b=0;var f=this._setMap,e=f._sets;if(e.hasOwnProperty(d.toLowerCase())){var g=e[d.toLowerCase()];try{var a=this._getVersion(g+"");b=b+"";var c=this._getVersion(b);if(a.major>0&&a.major>c.major)return true;if(a.major>0&&a.minor>=0&&a.major==c.major&&a.minor>=c.minor)return true}catch(h){return false}}return false};a.prototype._getVersion=function(a){a=a+"";var b=a.split("."),c=0,d=0;if(b.length<2&&isNaN(Number(a)))throw"version format incorrect";else{c=Number(b[0]);if(b.length>=2)d=Number(b[1]);if(isNaN(c)||isNaN(d))throw"version format incorrect";}var e={minor:d,major:c};return e};return a}();a.RequirementMatrix=c;var b=function(){function a(a){this._sets=a}a.prototype._addSetMap=function(a){for(var b in a)this._sets[b]=a[b]};return a}();a.DefaultSetRequirement=b;var w=function(b){__extends(a,b);function a(){return b.call(this,{dialogapi:1.1})||this}return a}(b);a.DefaultDialogSetRequirement=w;var e=function(b){__extends(a,b);function a(){return b.call(this,{bindingevents:1.1,documentevents:1.1,excelapi:1.1,matrixbindings:1.1,matrixcoercion:1.1,selection:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1,textbindings:1.1,textcoercion:1.1})||this}return a}(b);a.ExcelClientDefaultSetRequirement=e;var j=function(b){__extends(a,b);function a(){var a=b.call(this)||this;a._addSetMap({imagecoercion:1.1});return a}return a}(e);a.ExcelClientV1DefaultSetRequirement=j;var k=function(b){__extends(a,b);function a(){return b.call(this,{mailbox:1.3})||this}return a}(b);a.OutlookClientDefaultSetRequirement=k;var g=function(b){__extends(a,b);function a(){return b.call(this,{bindingevents:1.1,compressedfile:1.1,customxmlparts:1.1,documentevents:1.1,file:1.1,htmlcoercion:1.1,matrixbindings:1.1,matrixcoercion:1.1,ooxmlcoercion:1.1,pdffile:1.1,selection:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1,textbindings:1.1,textcoercion:1.1,textfile:1.1,wordapi:1.1})||this}return a}(b);a.WordClientDefaultSetRequirement=g;var o=function(b){__extends(a,b);function a(){var a=b.call(this)||this;a._addSetMap({customxmlparts:1.2,wordapi:1.2,imagecoercion:1.1});return a}return a}(g);a.WordClientV1DefaultSetRequirement=o;var d=function(b){__extends(a,b);function a(){return b.call(this,{activeview:1.1,compressedfile:1.1,documentevents:1.1,file:1.1,pdffile:1.1,selection:1.1,settings:1.1,textcoercion:1.1})||this}return a}(b);a.PowerpointClientDefaultSetRequirement=d;var i=function(b){__extends(a,b);function a(){var a=b.call(this)||this;a._addSetMap({imagecoercion:1.1});return a}return a}(d);a.PowerpointClientV1DefaultSetRequirement=i;var n=function(b){__extends(a,b);function a(){return b.call(this,{selection:1.1,textcoercion:1.1})||this}return a}(b);a.ProjectClientDefaultSetRequirement=n;var t=function(b){__extends(a,b);function a(){return b.call(this,{bindingevents:1.1,documentevents:1.1,matrixbindings:1.1,matrixcoercion:1.1,selection:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1,textbindings:1.1,textcoercion:1.1,file:1.1})||this}return a}(b);a.ExcelWebDefaultSetRequirement=t;var v=function(b){__extends(a,b);function a(){return b.call(this,{compressedfile:1.1,documentevents:1.1,file:1.1,imagecoercion:1.1,matrixcoercion:1.1,ooxmlcoercion:1.1,pdffile:1.1,selection:1.1,settings:1.1,tablecoercion:1.1,textcoercion:1.1,textfile:1.1})||this}return a}(b);a.WordWebDefaultSetRequirement=v;var m=function(b){__extends(a,b);function a(){return b.call(this,{activeview:1.1,settings:1.1})||this}return a}(b);a.PowerpointWebDefaultSetRequirement=m;var f=function(b){__extends(a,b);function a(){return b.call(this,{mailbox:1.3})||this}return a}(b);a.OutlookWebDefaultSetRequirement=f;var u=function(b){__extends(a,b);function a(){return b.call(this,{activeview:1.1,documentevents:1.1,selection:1.1,settings:1.1,textcoercion:1.1})||this}return a}(b);a.SwayWebDefaultSetRequirement=u;var q=function(b){__extends(a,b);function a(){return b.call(this,{bindingevents:1.1,partialtablebindings:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1})||this}return a}(b);a.AccessWebDefaultSetRequirement=q;var s=function(b){__extends(a,b);function a(){return b.call(this,{bindingevents:1.1,documentevents:1.1,matrixbindings:1.1,matrixcoercion:1.1,selection:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1,textbindings:1.1,textcoercion:1.1})||this}return a}(b);a.ExcelIOSDefaultSetRequirement=s;var h=function(b){__extends(a,b);function a(){return b.call(this,{bindingevents:1.1,compressedfile:1.1,customxmlparts:1.1,documentevents:1.1,file:1.1,htmlcoercion:1.1,matrixbindings:1.1,matrixcoercion:1.1,ooxmlcoercion:1.1,pdffile:1.1,selection:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1,textbindings:1.1,textcoercion:1.1,textfile:1.1})||this}return a}(b);a.WordIOSDefaultSetRequirement=h;var r=function(b){__extends(a,b);function a(){var a=b.call(this)||this;a._addSetMap({customxmlparts:1.2,wordapi:1.2});return a}return a}(h);a.WordIOSV1DefaultSetRequirement=r;var l=function(b){__extends(a,b);function a(){return b.call(this,{activeview:1.1,compressedfile:1.1,documentevents:1.1,file:1.1,pdffile:1.1,selection:1.1,settings:1.1,textcoercion:1.1})||this}return a}(b);a.PowerpointIOSDefaultSetRequirement=l;var p=function(b){__extends(a,b);function a(){return b.call(this,{mailbox:1.1})||this}return a}(b);a.OutlookIOSDefaultSetRequirement=p;var x=function(){function a(){}a.getDefaultRequirementMatrix=function(e){this.initializeDefaultSetMatrix();var d=undefined,f=e.get_requirementMatrix();if(f!=undefined&&f.length>0&&typeof JSON!=="undefined"){var h=JSON.parse(e.get_requirementMatrix().toLowerCase());d=new c(new b(h))}else{var g=a.getClientFullVersionString(e);if(a.DefaultSetArrayMatrix!=undefined&&a.DefaultSetArrayMatrix[g]!=undefined)d=new c(a.DefaultSetArrayMatrix[g]);else d=new c(new b({}))}return d};a.getDefaultDialogRequirementMatrix=function(e){var a=undefined,d=e.get_dialogRequirementMatrix();if(d!=undefined&&d.length>0&&typeof JSON!=="undefined"){var f=JSON.parse(e.get_requirementMatrix().toLowerCase());a=new c(new b(f))}else a=new c(new w);return a};a.getClientFullVersionString=function(a){var d=a.get_appMinorVersion(),e="",b="",c=a.get_appName(),f=c==1024||c==4096||c==8192||c==65536;if(f&&a.get_appVersion()==1)if(c==4096&&d>=15)b="16.00.01";else b="16.00";else if(a.get_appName()==64)b=a.get_appVersion();else{if(d<10)e="0"+d;else e=""+d;b=a.get_appVersion()+"."+e}return a.get_appName()+"-"+b};a.initializeDefaultSetMatrix=function(){a.DefaultSetArrayMatrix[a.Excel_RCLIENT_1600]=new e;a.DefaultSetArrayMatrix[a.Word_RCLIENT_1600]=new g;a.DefaultSetArrayMatrix[a.PowerPoint_RCLIENT_1600]=new d;a.DefaultSetArrayMatrix[a.Excel_RCLIENT_1601]=new j;a.DefaultSetArrayMatrix[a.Word_RCLIENT_1601]=new o;a.DefaultSetArrayMatrix[a.PowerPoint_RCLIENT_1601]=new i;a.DefaultSetArrayMatrix[a.Outlook_RCLIENT_1600]=new k;a.DefaultSetArrayMatrix[a.Excel_WAC_1600]=new t;a.DefaultSetArrayMatrix[a.Word_WAC_1600]=new v;a.DefaultSetArrayMatrix[a.Outlook_WAC_1600]=new f;a.DefaultSetArrayMatrix[a.Outlook_WAC_1601]=new f;a.DefaultSetArrayMatrix[a.Project_RCLIENT_1600]=new n;a.DefaultSetArrayMatrix[a.Access_WAC_1600]=new q;a.DefaultSetArrayMatrix[a.PowerPoint_WAC_1600]=new m;a.DefaultSetArrayMatrix[a.Excel_IOS_1600]=new s;a.DefaultSetArrayMatrix[a.SWAY_WAC_1600]=new u;a.DefaultSetArrayMatrix[a.Word_IOS_1600]=new h;a.DefaultSetArrayMatrix[a.Word_IOS_16001]=new r;a.DefaultSetArrayMatrix[a.PowerPoint_IOS_1600]=new l;a.DefaultSetArrayMatrix[a.Outlook_IOS_1600]=new p};a.Excel_RCLIENT_1600="1-16.00";a.Excel_RCLIENT_1601="1-16.01";a.Word_RCLIENT_1600="2-16.00";a.Word_RCLIENT_1601="2-16.01";a.PowerPoint_RCLIENT_1600="4-16.00";a.PowerPoint_RCLIENT_1601="4-16.01";a.Outlook_RCLIENT_1600="8-16.00";a.Excel_WAC_1600="16-16.00";a.Word_WAC_1600="32-16.00";a.Outlook_WAC_1600="64-16.00";a.Outlook_WAC_1601="64-16.01";a.Project_RCLIENT_1600="128-16.00";a.Access_WAC_1600="256-16.00";a.PowerPoint_WAC_1600="512-16.00";a.Excel_IOS_1600="1024-16.00";a.SWAY_WAC_1600="2048-16.00";a.Word_IOS_1600="4096-16.00";a.Word_IOS_16001="4096-16.00.01";a.PowerPoint_IOS_1600="8192-16.00";a.Outlook_IOS_1600="65536-16.00";a.DefaultSetArrayMatrix={};return a}();a.RequirementsMatrixFactory=x})(b=a.Requirement||(a.Requirement={}))})(OSF||(OSF={}));var OSF;(function(a){var b;(function(b){var c;(function(c){function d(b,e){var c=a.Bootstrap.getAsyncMethodExecutor(),d={toSafeArrayHost:function(){return[b]},fromSafeArrayHost:function(a){return{data:a}},toWebHost:function(){return{ArrayData:b}},fromWebHost:function(a){return{data:a.Data}}};c.executeAsync(93,d,e)}c.executeRichApiRequestAsync=d;var b;Object.defineProperty(c,"richApiMessageManager",{"get":function(){if(!b)b=new a.RichApiMessageManager;return b}})})(c=b.RichApi||(b.RichApi={}))})(b=a.DDA||(a.DDA={}))})(OSF||(OSF={}));var OSF;(function(a){var b=function(){function b(){this._eventDispatch=new a.EventDispatch([{type:a.EventType.RichApiMessage,id:33,getTargetId:function(){return""},fromSafeArrayHost:function(c){var a=c;return b.transferEventArgument(a)},fromWebHost:function(c){var a=c.ArrayData;return b.transferEventArgument(a)}}])}b.transferEventArgument=function(c){var e=[];if(c)for(var d=0;d<c.length;d++){var b=c[d];if(b.toArray)b=b.toArray();e.push({messageCategory:b[0],messageType:b[1],targetId:b[2],message:b[3],id:b[4],isRemoteOverride:b[5]})}return{type:a.EventType.RichApiMessage,entries:e}};b.prototype.addHandlerAsync=function(b,d,c){a.EventHelper.addEventHandler(b,d,c,this._eventDispatch)};b.prototype.removeHandlerAsync=function(b,d,c){a.EventHelper.removeEventHandler(b,d,c,this._eventDispatch)};return b}();a.RichApiMessageManager=b})(OSF||(OSF={}));var OSF;(function(b){var a=function(){function a(){}a.prototype.execute=function(c,b,a){if(typeof OsfOMToken!="undefined"&&OsfOMToken)window.external.Execute(c,b,a,OsfOMToken);else window.external.Execute(c,b,a)};a.prototype.registerEvent=function(d,e,b,c,a){if(typeof OsfOMToken!="undefined"&&OsfOMToken)window.external.RegisterEvent(d,b,c,a,OsfOMToken);else window.external.RegisterEvent(d,b,c,a)};a.prototype.unregisterEvent=function(c,d,b,a){if(typeof OsfOMToken!="undefined"&&OsfOMToken)window.external.UnregisterEvent(c,b,a,OsfOMToken);else window.external.UnregisterEvent(c,b,a)};return a}();b.RichClientHostController=a})(OSF||(OSF={}));var OSF;(function(a){var b=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}b.prototype.getOsfControlContext=function(){if(!this._osfControlContext){var b="Warning: Office.js is loaded outside of Office client";try{if(window.external&&typeof window.external.GetContext!=="undefined")this._osfControlContext=window.external.GetContext();else{a.OsfUtility.trace(b);return}}catch(c){a.OsfUtility.trace(b);return}}return this._osfControlContext};b.prototype.getAppContext=function(){var o=this,b=this.getOsfControlContext();if(!b)return Promise.resolve(null);var w=b.GetAppType(),A=b.GetSolutionRef(),x=b.GetAppVersionMajor(),r=b.GetAppVersionMinor(),v=b.GetAppUILocale(),u=b.GetAppDataLocale(),y=b.GetDocUrl(),t=b.GetAppCapabilities(),z=b.GetActivationMode(),q=b.GetControlIntegrationLevel(),c;try{c=b.GetSolutionToken()}catch(B){}var m;if(typeof b.GetCorrelationId!=="undefined")m=b.GetCorrelationId();var l;if(typeof b.GetInstanceId!=="undefined")l=b.GetInstanceId();var n;if(typeof b.GetTouchEnabled!=="undefined")n=b.GetTouchEnabled();var h;if(typeof b.GetCommerceAllowed!=="undefined")h=b.GetCommerceAllowed();var g;if(typeof b.GetSupportedMatrix!=="undefined")g=b.GetSupportedMatrix();var f;if(typeof b.GetHostCustomMessage!=="undefined")f=b.GetHostCustomMessage();var i;if(typeof b.GetHostFullVersion!=="undefined")i=b.GetHostFullVersion();var d;if(typeof b.GetDialogRequirementMatrix!="undefined")d=b.GetDialogRequirementMatrix();var k;if(typeof b.GetFeaturesForSolution!="undefined")try{var e=b.GetFeaturesForSolution();if(e)k=JSON.parse(e)}catch(B){a.OsfUtility.trace("Exception while creating the SDX FeatureGates object. Details: "+B)}c=c?c.toString():"";var s=function(){return o.initializeSettings()},p=function(){return o.getOfficeTheme()},j=new a.OfficeAppContext(A,w,x,v,u,y,t,s,z,q,c,m,l,n,h,r,g,f,i,undefined,undefined,undefined,undefined,d,k,p);a.AppTelemetry&&a.AppTelemetry.initialize(j);return a.OsfUtility.createPromiseFromResult(j)};b.prototype.createClientHostController=function(){if(this._hostInfo.hostPlatform===a.HostInfoPlatform.win32)return new a.Win32RichClientHostController;else throw a.OsfUtility.createNotImplementedException();};b.prototype.createAsyncMethodExecutor=function(b){return new a.SafeArrayAsyncMethodExecutor(b)};b.prototype.initializeSettings=function(){var e=this.getOsfControlContext(),b=[],c=[];if(typeof OsfOMToken!="undefined"&&OsfOMToken)e.GetSettings(OsfOMToken).Read(b,c);else e.GetSettings().Read(b,c);for(var d={},a=0;a<b.length;a++)d[b[a]]=c[a];return this.deserializeSettings(d)};b.prototype.getOfficeTheme=function(){var e=this.getOsfControlContext(),d=e.GetOfficeThemeInfo(),b=JSON.parse(d);for(var c in b)b[c]=a.OUtil.convertIntToCssHexColor(b[c]);return b};return b}(a.InitializationHelper);a.RichClientInitializationHelper=b})(OSF||(OSF={}));var OSF;(function(a){var b=function(b){__extends(a,b);function a(c){var a=b.call(this)||this;a._clientHostController=c;return a}a.prototype.fromSafeArray=function(a){var d=a;if(a!=null&&a.toArray){var c=a.toArray();d=new Array(c.length);for(var b=0;b<c.length;b++)d[b]=this.fromSafeArray(c[b])}return d};a.prototype.executeAsync=function(c,d,b){var e=this;try{var a;this._clientHostController.execute(c,d.toSafeArrayHost(),function(l,n){var g,h,j=e.fromSafeArray(l);if(typeof j==="number"){g=[];h=j}else{g=j;h=g[0]}if(h==1){var f=g[1];if(f!=null){if(!a)a=[];a[f[0]]=f[1]}return false}if(b){var f;if(h==0){if(g.length>2){f=[];for(var i=1;i<g.length;i++)f[i-1]=g[i]}else f=g[1];if(a)if(f!=null){var m=f[f.length-1];if(a.length==m)f[f.length-1]=a;else h=5001}}else f=g[1];var k=null;if(h==0)k=d.fromSafeArrayHost(f);e.invokeCallback(c,b,h,k)}return true})}catch(f){this.onException(f,c,b)}};a.prototype.registerEventAsync=function(b,e,f,g,d,c){var a=this;try{this._clientHostController.registerEvent(b,e,f,function(f,e){var b=a.fromSafeArray(e),c=d.fromSafeArrayHost(b);g(c)},function(g){var e,f,d=a.fromSafeArray(g);if(typeof d==="number"){e=[];f=d}else{e=d;f=e[0]}a.invokeCallback(b,c,f,null);return true})}catch(h){this.onException(h,b,c)}};a.prototype.unregisterEventAsync=function(a,d,e,b){var c=this;try{this._clientHostController.unregisterEvent(a,d,e,function(g,h){var e,f,d=c.fromSafeArray(g);if(typeof d==="number"){e=[];f=d}else{e=d;f=e[0]}c.invokeCallback(a,b,f,null);return true})}catch(f){this.onException(f,a,b)}};a.prototype.onException=function(e,d,c){var a,b=e.number;if(b)switch(b){case-2146828218:a=7e3;break;case-2147467259:if(d==10)a=12007;else a=5001;break;case-2146828283:a=5010;break;case-2147209089:a=5010;break;case-2147208704:a=5100;break;case-2146827850:default:a=5001;break}c&&this.invokeCallback(d,c,a||5001,null)};return a}(a.AsyncMethodExecutor);a.SafeArrayAsyncMethodExecutor=b})(OSF||(OSF={}));var OSF;(function(b){var a=function(){function a(a){this._internalStorage=a}a.prototype.getItem=function(a){try{return this._internalStorage&&this._internalStorage.getItem(a)}catch(b){return null}};a.prototype.setItem=function(b,a){try{this._internalStorage&&this._internalStorage.setItem(b,a)}catch(c){}};a.prototype.clear=function(){try{this._internalStorage&&this._internalStorage.clear()}catch(a){}};a.prototype.removeItem=function(a){try{this._internalStorage&&this._internalStorage.removeItem(a)}catch(b){}};a.prototype.getKeysWithPrefix=function(d){var b=[];try{for(var e=this._internalStorage&&this._internalStorage.length||0,a=0;a<e;a++){var c=this._internalStorage.key(a);c.indexOf(d)===0&&b.push(c)}}catch(f){}return b};return a}();b.SafeStorage=a})(OSF||(OSF={}));var Office;(function(b){var a=function(){function a(a){a=a||{};this._settings=a}a.prototype.cacheSessionSettings=function(d){var a=OSF.OUtil.getSessionStorage();if(a){var b=OSF.OUtil.serializeSettings(d),c=JSON.stringify(b);a.setItem(OSF.Bootstrap.getCachedSessionSettingsKey(),c)}};a.prototype.get=function(b){var a=this._settings[b];return typeof a==="undefined"?null:a};a.prototype.set=function(b,a){this._settings[b]=a;this.cacheSessionSettings(this._settings)};a.prototype.remove=function(a){delete this._settings[a];this.cacheSessionSettings(this._settings)};a.prototype.saveAsync=function(a){throw OSF.OsfUtility.createNotImplementedException();};a.prototype.refreshAsync=function(a){throw OSF.OsfUtility.createNotImplementedException();};a.prototype.toJSON=function(){return this._settings};return a}();b.Settings=a})(Office||(Office={}));var OSF;(function(a){var b=function(b){__extends(a,b);function a(c){var a=b.call(this)||this;a._clientHostController=c;return a}a.prototype.executeAsync=function(c,a,b){var d=this;this._clientHostController.execute(c,a.toWebHost(),function(e,g){if(b){var f=null;if(e==0)f=a.fromWebHost(g);d.invokeCallback(c,b,e,f)}return true})};a.prototype.registerEventAsync=function(b,d,e,f,c,a){var g=this;this._clientHostController.registerEvent(b,d,e,function(d){var a=d,b=c.fromWebHost(a);f(b)},function(c,d){a&&g.invokeCallback(b,a,c,null);return true})};a.prototype.unregisterEventAsync=function(b,c,d,a){var e=this;this._clientHostController.unregisterEvent(b,c,d,function(c,d){a&&e.invokeCallback(b,a,c,null);return true})};return a}(a.AsyncMethodExecutor);a.WebAsyncMethodExecutor=b})(OSF||(OSF={}));var OSF;(function(a){var b=function(){function b(a){this._delegateVersion=1;this._webAppState=a}b.prototype.execute=function(e,c,b){var d=this,a=c;a.DdaMethod={ControlId:this._webAppState.id,DispatchId:e,Version:this._delegateVersion};a.__timeout__=-1;this._webAppState.clientEndPoint.invoke("executeMethod",function(e,c){var a=0;if(e==0){d._delegateVersion=c.Version;a=c.Error}else switch(e){case-5:a=7e3;break;default:a=5001;break}b&&b(a,c)},a)};b.prototype.registerEvent=function(c,d,a,b,e){this._webAppState.clientEndPoint.registerForEvent(this.getXdmEventName(a,d),function(a){b&&b(a)},this._getOnAfterRegisterEvent(true,c,e),{controlId:this._webAppState.id,eventDispId:c,targetId:a,__timeout__:-1})};b.prototype.unregisterEvent=function(b,c,a,d){this._webAppState.clientEndPoint.unregisterForEvent(this.getXdmEventName(a,c),this._getOnAfterRegisterEvent(false,b,d),{controlId:this._webAppState.id,eventDispId:b,targetId:a,__timeout__:-1})};b.prototype.messageParent=function(a){};b.prototype.openDialog=function(d,b,c,a){};b.prototype.closeDialog=function(c,b,a){};b.prototype.sendMessage=function(a){};b.prototype.getXdmEventName=function(c,b){if(b==a.EventType.BindingSelectionChanged||b==a.EventType.BindingDataChanged||b==a.EventType.DataNodeDeleted||b==a.EventType.DataNodeInserted||b==a.EventType.DataNodeReplaced)return c+"_"+b;else return b};b.prototype._getOnAfterRegisterEvent=function(d,e,b){var c=+new Date;return function(h,g){var f;if(h!=0)switch(h){case-5:f=7e3;break;default:f=5001;break}else if(g)if(g.Error)f=g.Error;else f=0;else f=5001;b&&b(f);if(a.AppTelemetry)a.AppTelemetry.onRegisterDone(d,e,Math.abs(+new Date-c),f)}};return b}();a.WebClientHostController=b})(OSF||(OSF={}));var OSF;(function(a){var b=function(c){__extends(b,c);function b(e,b,f,d){var a=c.call(this,e,b,f,d)||this;a._appContext={};a._tabbableElements="a[href]:not([tabindex='-1']),area[href]:not([tabindex='-1']),button:not([disabled]):not([tabindex='-1']),input:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']),textarea:not([disabled]):not([tabindex='-1']),*[tabindex]:not([tabindex='-1']),*[contenteditable]:not([disabled]):not([tabindex='-1'])";return a}b.prototype.saveAndSetDialogInfo=function(b){function e(){var b=a.OUtil.parseXdmInfo(true);if(b){var c=b.split("|");return c[1]}return null}var c=a.OUtil.getSessionStorage();if(c){if(!b)b=a.OUtil.parseHostInfoFromWindowName(true,a.Bootstrap.getWindowName());if(b&&b.indexOf("isDialog")>-1){var d=e();d!=null&&c.setItem(d+"IsDialog","true");this._hostInfo.isDialog=true;return}this._hostInfo.isDialog=c.getItem(a.OUtil.getXdmFieldValue(a.XdmFieldName.AppId,false)+"IsDialog")!=null?true:false}};b.prototype.setAgaveHostCommunication=function(){try{var b=this,d=a.OUtil.parseXdmInfoWithGivenFragment(false,a.Bootstrap.getWindowLocationHash());if(!d)d=a.OUtil.parseXdmInfoFromWindowName(false,a.Bootstrap.getWindowName());if(d){var c=a.OUtil.getInfoItems(d);if(c!=undefined&&c.length>=3){b._webAppState.conversationID=c[0];b._webAppState.id=c[1];b._webAppState.webAppUrl=c[2].indexOf(":")>=0?c[2]:decodeURIComponent(c[2])}}b._webAppState.wnd=window.opener!=null?window.opener:window.parent;var e=a.OUtil.parseSerializerVersionWithGivenFragment(false,a.Bootstrap.getWindowLocationHash());if(isNaN(e))e=a.OUtil.parseSerializerVersionFromWindowName(false,a.Bootstrap.getWindowName());b._webAppState.serializerVersion=e;if(this._hostInfo.isDialog&&window.opener!=null)return;b._webAppState.clientEndPoint=a.XdmCommunicationManager.connect(b._webAppState.conversationID,b._webAppState.wnd,b._webAppState.webAppUrl,b._webAppState.serializerVersion);b._webAppState.serviceEndPoint=a.XdmCommunicationManager.createServiceEndPoint(b._webAppState.id);var f=b._webAppState.conversationID+a.Constants.NotificationConversationIdSuffix;b._webAppState.serviceEndPoint.registerConversation(f,b._webAppState.webAppUrl);var g=function(d){var c;if(typeof d=="string")c=d;else c=d[0];switch(c){case 0:b._webAppState.focused=true;break;case 1:b._webAppState.focused=false;break;case 11:case 4:window.focus();var f=document.querySelectorAll(b._tabbableElements),e=a.OUtil.focusToFirstTabbable(f,false);if(!e){window.blur();b._webAppState.focused=false;b._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[b._webAppState.id,17])}break;case 12:window.focus();var f=document.querySelectorAll(b._tabbableElements),e=a.OUtil.focusToFirstTabbable(f,true);if(!e){window.blur();b._webAppState.focused=false;b._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[b._webAppState.id,18])}break;case 25:throw a.OsfUtility.createNotImplementedException();break;case 31:throw a.OsfUtility.createNotImplementedException();break;default:a.OsfUtility.trace("actionId "+c+" notifyAgave is wrong.");break}};b._webAppState.serviceEndPoint.registerMethod("Office_notifyAgave",g,0,false);b.addOrRemoveEventListenersForWindow(true)}catch(h){a.AppTelemetry&&a.AppTelemetry.logAppException("Exception thrown in setAgaveHostCommunication. Exception:["+h+"]");throw h;}};b.prototype.getAppContext=function(d){var b=this,c=this;return new Promise(function(g,e){var d=function(k,d){if(d._appName===16){var f=d._settings;b._serializedSettings={};for(var s in f){var m=f[s];b._serializedSettings[m[0]]=m[1]}}else b._serializedSettings=d._settings;if(!c._hostInfo.isDialog||window.opener==null){var r=window.location.href;c._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[c._webAppState.id,21,r])}if(k===0&&d._id!=undefined&&d._appName!=undefined&&d._appVersion!=undefined&&d._appUILocale!=undefined&&d._dataLocale!=undefined&&d._docUrl!=undefined&&d._clientMode!=undefined&&d._settings!=undefined&&d._reason!=undefined){c._appContext=d;var o=d._appInstanceId?d._appInstanceId:d._id,q=false,n=true,j=0;if(d._appMinorVersion!=undefined)j=d._appMinorVersion;var h=undefined;if(d._requirementMatrix!=undefined)h=d._requirementMatrix;d.eToken=d.eToken?d.eToken:"";var p=function(){return b.deserializeSettings(b._serializedSettings)},i=new a.OfficeAppContext(d._id,d._appName,d._appVersion,d._appUILocale,d._dataLocale,d._docUrl,d._clientMode,p,d._reason,d._osfControlType,d._eToken,d._correlationId,o,q,n,j,h,d._hostCustomMessage,d._hostFullVersion,d._clientWindowHeight,d._clientWindowWidth,d._addinName,d._appDomains,d._dialogRequirementMatrix,d._featureGates);a.AppTelemetry&&a.AppTelemetry.initialize(i);g(i)}else{var l="Function ContextActivationManager_getAppContextAsync call failed. ErrorCode is "+k+", exception: "+d;a.AppTelemetry&&a.AppTelemetry.logAppException(l);e(l)}typeof CustomEvent==="function"&&typeof dispatchEvent==="function"&&dispatchEvent(new CustomEvent("JSPerfFinished"))};try{if(b._hostInfo.isDialog&&window.opener!=null){var f=a.OUtil.parseAppContextFromWindowName(false,a.Bootstrap.getWindowName());d(0,f)}else b._webAppState.clientEndPoint.invoke("ContextActivationManager_getAppContextAsync",d,b._webAppState.id)}catch(h){a.AppTelemetry&&a.AppTelemetry.logAppException("Exception thrown when trying to invoke getAppContextAsync. Exception:["+h+"]");e(h)}})};b.prototype.createClientHostController=function(){return new a.WebClientHostController(this._webAppState)};b.prototype.createAsyncMethodExecutor=function(b){return new a.WebAsyncMethodExecutor(b)};b.prototype.addOrRemoveEventListenersForWindow=function(g){var b=this,e=function(){if(!b._webAppState.focused)b._webAppState.focused=true;b._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[b._webAppState.id,0])},f=function(){if(!a)return;if(b._webAppState.focused)b._webAppState.focused=false;b._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[b._webAppState.id,1])},d=function(c){c.preventDefault=c.preventDefault||function(){c.returnValue=false};if(c.keyCode==117&&(c.ctrlKey||c.metaKey)){c.preventDefault();var e=5;if(c.shiftKey)e=6;b._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[b._webAppState.id,e])}else if(c.keyCode==9){c.preventDefault();var d=document.querySelectorAll(b._tabbableElements),f=a.OUtil.focusToNextTabbable(d,c.target||c.srcElement,c.shiftKey);if(!f)if(b._hostInfo.isDialog)a.OUtil.focusToFirstTabbable(d,c.shiftKey);else if(c.shiftKey)b._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[b._webAppState.id,14]);else b._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[b._webAppState.id,13])}else if(c.keyCode==27){c.preventDefault();b._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[b._webAppState.id,15])}else if(c.keyCode==113){c.preventDefault();b._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[b._webAppState.id,16])}},c=function(a){if(a.keyCode==117&&a.ctrlKey)if(a.preventDefault)a.preventDefault();else a.returnValue=false}};return b}(a.InitializationHelper);a.WebInitializationHelper=b})(OSF||(OSF={}));var OSF;(function(a){var b=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}b.prototype.messageParent=function(c){var b=c[a.ParameterNames.MessageToParent];window.external.MessageParent(b)};b.prototype.openDialog=function(d,b,c,a){this.registerEvent(d,"DialogMessageReceived",b,c,a)};b.prototype.closeDialog=function(c,b,a){this.unregisterEvent(c,"DialogMessageReceived",b,a)};b.prototype.sendMessage=function(c){var b=c[a.ParameterNames.MessageContent];window.external.MessageChild(b)};return b}(a.RichClientHostController);a.Win32RichClientHostController=b})(OSF||(OSF={}));var OSF;(function(a){var b;(function(a){a.BaseFrameName="baseFrameName";a.HostInfo="hostInfo";a.XdmInfo="xdmInfo";a.SerializerVersion="serializerVersion";a.AppContext="appContext"})(b=a.WindowNameItemKeys||(a.WindowNameItemKeys={}))})(OSF||(OSF={}));var OSF;(function(a){var b;(function(a){a.ConversationUrl="ConversationUrl";a.AppId="AppId"})(b=a.XdmFieldName||(a.XdmFieldName={}))})(OSF||(OSF={}));var Office;(function(a){var b;(function(a){var b;(function(a){function b(){return function(){"use strict";function L(a){return typeof a==="function"||typeof a==="object"&&a!==null}function t(a){return typeof a==="function"}function O(a){return typeof a==="object"&&a!==null}var u;if(!Array.isArray)u=function(a){return Object.prototype.toString.call(a)==="[object Array]"};else u=Array.isArray;var y=u,m=0,kb={}.toString,eb,r,g=function(a,b){l[m]=a;l[m+1]=b;m+=2;if(m===2)if(r)r(k);else p()};function X(a){r=a}function gb(a){g=a}var S=typeof window!=="undefined"?window:undefined,x=S||{},B=x.MutationObserver||x.WebKitMutationObserver,hb=typeof process!=="undefined"&&{}.toString.call(process)==="[object process]",fb=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function Z(){var b=process.nextTick,a=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);if(Array.isArray(a)&&a[1]==="0"&&a[2]==="10")b=setImmediate;return function(){b(k)}}function jb(){return function(){eb(k)}}function ib(){var a=0,c=new B(k),b=document.createTextNode("");c.observe(b,{characterData:true});return function(){b.data=a=++a%2}}function J(){var a=new MessageChannel;a.port1.onmessage=k;return function(){a.port2.postMessage(0)}}function T(){return function(){setTimeout(k,1)}}var l=new Array(1e3);function k(){for(var a=0;a<m;a+=2){var b=l[a],c=l[a+1];b(c);l[a]=undefined;l[a+1]=undefined}m=0}var p;if(hb)p=Z();else if(fb)p=J();else p=T();function j(){}var f=void 0,h=1,e=2,n=new w;function F(){return new TypeError("You cannot resolve a promise with itself")}function G(){return new TypeError("A promises callback cannot return that same promise.")}function V(a){try{return a.then}catch(b){n.error=b;return n}}function W(d,c,a,b){try{d.call(c,a,b)}catch(e){return e}}function z(d,b,e){g(function(f){var d=false,g=W(e,b,function(a){if(d)return;d=true;if(b!==a)i(f,a);else c(f,a)},function(b){if(d)return;d=true;a(f,b)},"Settle: "+(f._label||" unknown promise"));if(!d&&g){d=true;a(f,g)}},d)}function C(d,b){if(b._state===h)c(d,b._result);else if(b._state===e)a(d,b._result);else o(b,undefined,function(a){i(d,a)},function(b){a(d,b)})}function A(d,b){if(b.constructor===d.constructor)C(d,b);else{var e=V(b);if(e===n)a(d,n.error);else if(e===undefined)c(d,b);else if(t(e))z(d,b,e);else c(d,b)}}function i(b,d){if(b===d)a(b,F());else if(L(d))A(b,d);else c(b,d)}function E(a){a._onerror&&a._onerror(a._result);s(a)}function c(a,b){if(a._state!==f)return;a._result=b;a._state=h;a._subscribers.length!==0&&g(s,a)}function a(a,b){if(a._state!==f)return;a._state=e;a._result=b;g(E,a)}function o(c,i,d,f){var a=c._subscribers,b=a.length;c._onerror=null;a[b]=i;a[b+h]=d;a[b+e]=f;b===0&&c._state&&g(s,c)}function s(b){var a=b._subscribers,f=b._state;if(a.length===0)return;for(var e,d,g=b._result,c=0;c<a.length;c+=3){e=a[c];d=a[c+f];if(e)v(f,e,d,g);else d(g)}b._subscribers.length=0}function w(){this.error=null}var q=new w;function R(a,b){try{return a(b)}catch(c){q.error=c;return q}}function v(l,d,k,m){var j=t(k),b,o,g,n;if(j){b=R(k,m);if(b===q){n=true;o=b.error;b=null}else g=true;if(d===b){a(d,G());return}}else{b=m;g=true}if(d._state===f)if(j&&g)i(d,b);else if(n)a(d,o);else if(l===h)c(d,b);else l===e&&a(d,b)}function D(b,c){try{c(function(a){i(b,a)},function(c){a(b,c)})}catch(d){a(b,d)}}function d(e,d){var b=this;b._instanceConstructor=e;b.promise=new e(j);if(b._validateInput(d)){b._input=d;b.length=d.length;b._remaining=d.length;b._init();if(b.length===0)c(b.promise,b._result);else{b.length=b.length||0;b._enumerate();b._remaining===0&&c(b.promise,b._result)}}else a(b.promise,b._validationError())}d.prototype._validateInput=function(a){return y(a)};d.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")};d.prototype._init=function(){this._result=new Array(this.length)};var U=d;d.prototype._enumerate=function(){for(var a=this,d=a.length,c=a.promise,e=a._input,b=0;c._state===f&&b<d;b++)a._eachEntry(e[b],b)};d.prototype._eachEntry=function(a,c){var b=this,d=b._instanceConstructor;if(O(a))if(a.constructor===d&&a._state!==f){a._onerror=null;b._settledAt(a._state,c,a._result)}else b._willSettleAt(d.resolve(a),c);else{b._remaining--;b._result[c]=a}};d.prototype._settledAt=function(h,i,g){var b=this,d=b.promise;if(d._state===f){b._remaining--;if(h===e)a(d,g);else b._result[i]=g}b._remaining===0&&c(d,b._result)};d.prototype._willSettleAt=function(c,b){var a=this;o(c,undefined,function(c){a._settledAt(h,b,c)},function(c){a._settledAt(e,b,c)})};function db(a){return new U(this,a).promise}var Q=db;function Y(c){var e=this,b=new e(j);if(!y(c)){a(b,new TypeError("You must pass an array to race."));return b}var k=c.length;function g(a){i(b,a)}function h(c){a(b,c)}for(var d=0;b._state===f&&d<k;d++)o(e.resolve(c[d]),undefined,g,h);return b}var P=Y;function I(a){var b=this;if(a&&typeof a==="object"&&a.constructor===b)return a;var c=new b(j);i(c,a);return c}var H=I;function N(d){var c=this,b=new c(j);a(b,d);return b}var K=N,bb=0;function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}function ab(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}var cb=b;function b(a){this._id=bb++;this._state=undefined;this._result=undefined;this._subscribers=[];if(j!==a){!t(a)&&M();!(this instanceof b)&&ab();D(this,a)}}b.all=Q;b.race=P;b.resolve=H;b.reject=K;b._setScheduler=X;b._setAsap=gb;b._asap=g;b.prototype={constructor:b,then:function(d,f){var b=this,a=b._state;if(a===h&&!d||a===e&&!f)return this;var c=new this.constructor(j),k=b._result;if(a){var i=arguments[a-1];g(function(){v(a,c,i,k)})}else o(b,c,d,f);return c},"catch":function(a){return this.then(null,a)}};return cb}.call(this)}a.Init=b})(b=a.PromiseImpl||(a.PromiseImpl={}))})(b=a._Internal||(a._Internal={}));(function(a){function c(){var a=window.navigator.userAgent,b=a.indexOf("Edge/");if(b>=0){a=a.substring(b+5,a.length);if(a<"14.14393")return true;else return false}return false}function b(){if(typeof window==="undefined"&&typeof Promise==="function")return Promise;if(typeof window!=="undefined")if(window.Promise)return window.Promise;else{var b=a.PromiseImpl.Init();window.Promise=b;return b}}a.OfficePromise=b()})(b=a._Internal||(a._Internal={}));a.OfficePromise=b.OfficePromise})(Office||(Office={}));var OSF;(function(a){a.Bootstrap.initialize()})(OSF||(OSF={}));var __extends=this&&this.__extends||function(){var a=function(c,b){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(c,a){for(var b in a)if(a.hasOwnProperty(b))c[b]=a[b]};return a(c,b)};return function(c,b){a(c,b);function d(){this.constructor=c}c.prototype=b===null?Object.create(b):(d.prototype=b.prototype,new d)}}(),OfficeExtension;(function(a){var b;(function(a){a.OfficeRequire=function(){return null}()})(b=a._Internal||(a._Internal={}));(function(a){var b;(function(b){function c(){return function(){"use strict";function M(a){return typeof a==="function"||typeof a==="object"&&a!==null}function u(a){return typeof a==="function"}function P(a){return typeof a==="object"&&a!==null}var v;if(!Array.isArray)v=function(a){return Object.prototype.toString.call(a)==="[object Array]"};else v=Array.isArray;var z=v,n=0,lb={}.toString,fb,s,h=function(a,b){m[n]=a;m[n+1]=b;n+=2;if(n===2)if(s)s(l);else q()};function Y(a){s=a}function hb(a){h=a}var T=typeof window!=="undefined"?window:undefined,y=T||{},C=y.MutationObserver||y.WebKitMutationObserver,ib=typeof process!=="undefined"&&{}.toString.call(process)==="[object process]",gb=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function ab(){var b=process.nextTick,a=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);if(Array.isArray(a)&&a[1]==="0"&&a[2]==="10")b=window.setImmediate;return function(){b(l)}}function kb(){return function(){fb(l)}}function jb(){var a=0,c=new C(l),b=document.createTextNode("");c.observe(b,{characterData:true});return function(){b.data=a=++a%2}}function K(){var a=new MessageChannel;a.port1.onmessage=l;return function(){a.port2.postMessage(0)}}function U(){return function(){setTimeout(l,1)}}var m=new Array(1e3);function l(){for(var a=0;a<n;a+=2){var b=m[a],c=m[a+1];b(c);m[a]=undefined;m[a+1]=undefined}n=0}var q;if(ib)q=ab();else if(gb)q=K();else q=U();function k(){}var g=void 0,i=1,f=2,o=new x;function G(){return new TypeError("You cannot resolve a promise with itself")}function H(){return new TypeError("A promises callback cannot return that same promise.")}function W(a){try{return a.then}catch(b){o.error=b;return o}}function X(d,c,a,b){try{d.call(c,a,b)}catch(e){return e}}function A(c,a,e){h(function(f){var c=false,g=X(e,a,function(b){if(c)return;c=true;if(a!==b)j(f,b);else d(f,b)},function(a){if(c)return;c=true;b(f,a)},"Settle: "+(f._label||" unknown promise"));if(!c&&g){c=true;b(f,g)}},c)}function D(c,a){if(a._state===i)d(c,a._result);else if(a._state===f)b(c,a._result);else p(a,undefined,function(a){j(c,a)},function(a){b(c,a)})}function B(c,a){if(a.constructor===c.constructor)D(c,a);else{var e=W(a);if(e===o)b(c,o.error);else if(e===undefined)d(c,a);else if(u(e))A(c,a,e);else d(c,a)}}function j(a,c){if(a===c)b(a,G());else if(M(c))B(a,c);else d(a,c)}function F(a){a._onerror&&a._onerror(a._result);t(a)}function d(a,b){if(a._state!==g)return;a._result=b;a._state=i;a._subscribers.length!==0&&h(t,a)}function b(a,b){if(a._state!==g)return;a._state=f;a._result=b;h(F,a)}function p(c,g,d,e){var a=c._subscribers,b=a.length;c._onerror=null;a[b]=g;a[b+i]=d;a[b+f]=e;b===0&&c._state&&h(t,c)}function t(b){var a=b._subscribers,f=b._state;if(a.length===0)return;for(var e,d,g=b._result,c=0;c<a.length;c+=3){e=a[c];d=a[c+f];if(e)w(f,e,d,g);else d(g)}b._subscribers.length=0}function x(){this.error=null}var r=new x;function S(a,b){try{return a(b)}catch(c){r.error=c;return r}}function w(l,c,k,m){var h=u(k),a,o,e,n;if(h){a=S(k,m);if(a===r){n=true;o=a.error;a=null}else e=true;if(c===a){b(c,H());return}}else{a=m;e=true}if(c._state===g)if(h&&e)j(c,a);else if(n)b(c,o);else if(l===i)d(c,a);else l===f&&b(c,a)}function E(a,c){try{c(function(b){j(a,b)},function(c){b(a,c)})}catch(d){b(a,d)}}function e(e,c){var a=this;a._instanceConstructor=e;a.promise=new e(k);if(a._validateInput(c)){a._input=c;a.length=c.length;a._remaining=c.length;a._init();if(a.length===0)d(a.promise,a._result);else{a.length=a.length||0;a._enumerate();a._remaining===0&&d(a.promise,a._result)}}else b(a.promise,a._validationError())}e.prototype._validateInput=function(a){return z(a)};e.prototype._validationError=function(){return new a.Error("Array Methods must be provided an Array")};e.prototype._init=function(){this._result=new Array(this.length)};var V=e;e.prototype._enumerate=function(){for(var a=this,d=a.length,c=a.promise,e=a._input,b=0;c._state===g&&b<d;b++)a._eachEntry(e[b],b)};e.prototype._eachEntry=function(a,c){var b=this,d=b._instanceConstructor;if(P(a))if(a.constructor===d&&a._state!==g){a._onerror=null;b._settledAt(a._state,c,a._result)}else b._willSettleAt(d.resolve(a),c);else{b._remaining--;b._result[c]=a}};e.prototype._settledAt=function(h,i,e){var a=this,c=a.promise;if(c._state===g){a._remaining--;if(h===f)b(c,e);else a._result[i]=e}a._remaining===0&&d(c,a._result)};e.prototype._willSettleAt=function(c,b){var a=this;p(c,undefined,function(c){a._settledAt(i,b,c)},function(c){a._settledAt(f,b,c)})};function eb(a){return new V(this,a).promise}var R=eb;function Z(c){var e=this,a=new e(k);if(!z(c)){b(a,new TypeError("You must pass an array to race."));return a}var i=c.length;function f(b){j(a,b)}function h(c){b(a,c)}for(var d=0;a._state===g&&d<i;d++)p(e.resolve(c[d]),undefined,f,h);return a}var Q=Z;function J(a){var b=this;if(a&&typeof a==="object"&&a.constructor===b)return a;var c=new b(k);j(c,a);return c}var I=J;function O(d){var c=this,a=new c(k);b(a,d);return a}var L=O,cb=0;function N(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}function bb(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}var db=c;function c(a){this._id=cb++;this._state=undefined;this._result=undefined;this._subscribers=[];if(k!==a){!u(a)&&N();!(this instanceof c)&&bb();E(this,a)}}c.all=R;c.race=Q;c.resolve=I;c.reject=L;c._setScheduler=Y;c._setAsap=hb;c._asap=h;c.prototype={constructor:c,then:function(d,e){var b=this,a=b._state;if(a===i&&!d||a===f&&!e)return this;var c=new this.constructor(k),j=b._result;if(a){var g=arguments[a-1];h(function(){w(a,c,g,j)})}else p(b,c,d,e);return c},"catch":function(a){return this.then(null,a)}};return db}.call(this)}b.Init=c})(b=a.PromiseImpl||(a.PromiseImpl={}))})(b=a._Internal||(a._Internal={}));(function(a){function c(){var a=window.navigator.userAgent,b=a.indexOf("Edge/");if(b>=0){a=a.substring(b+5,a.length);if(a<"14.14393")return true;else return false}return false}function b(){if(typeof window==="undefined"&&typeof Promise==="function")return Promise;if(typeof window!=="undefined"&&window.Promise)if(c())return a.PromiseImpl.Init();else return window.Promise;else return a.PromiseImpl.Init()}a.OfficePromise=b()})(b=a._Internal||(a._Internal={}));var c=b.OfficePromise;a.Promise=c})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(c){var u=function(){function b(){}b.prototype._resolveRequestUrlAndHeaderInfo=function(){return a._createPromiseFromResult(null)};b.prototype._createRequestExecutorOrNull=function(){return null};Object.defineProperty(b.prototype,"eventRegistration",{"get":function(){return null},enumerable:true,configurable:true});return b}();c.SessionBase=u;var I=function(){function b(){}b.setCustomSendRequestFunc=function(a){b.s_customSendRequestFunc=a};b.xhrSendRequestFunc=function(b){return a.createPromise(function(f,h){var c=new XMLHttpRequest;c.open(b.method,b.url);c.onload=function(){var b={statusCode:c.status,headers:a._parseHttpResponseHeaders(c.getAllResponseHeaders()),body:c.responseText};f(b)};c.onerror=function(){h(new d.RuntimeError({code:g.connectionFailure,message:a._getResourceString(i.connectionFailureWithStatus,c.statusText)}))};if(b.headers)for(var e in b.headers)c.setRequestHeader(e,b.headers[e]);c.send(a._getRequestBodyText(b))})};b.sendRequest=function(c){b.validateAndNormalizeRequest(c);var a=b.s_customSendRequestFunc;if(!a)a=b.xhrSendRequestFunc;return a(c)};b.setCustomSendLocalDocumentRequestFunc=function(a){b.s_customSendLocalDocumentRequestFunc=a};b.sendLocalDocumentRequest=function(a){b.validateAndNormalizeRequest(a);var c;c=b.s_customSendLocalDocumentRequestFunc||b.officeJsSendLocalDocumentRequestFunc;return c(a)};b.officeJsSendLocalDocumentRequestFunc=function(b){b=a._validateLocalDocumentRequest(b);var c=a._buildRequestMessageSafeArray(b);return a.createPromise(function(b,d){OSF.DDA.RichApi.executeRichApiRequestAsync(c,function(c){var d;if(c.status=="succeeded")d={statusCode:k.getResponseStatusCode(c),headers:k.getResponseHeaders(c),body:k.getResponseBody(c)};else d=k.buildHttpResponseFromOfficeJsError(c.error.code,c.error.message);a.log("Response:");a.log(JSON.stringify(d));b(d)})})};b.validateAndNormalizeRequest=function(b){if(a.isNullOrUndefined(b))throw d.RuntimeError._createInvalidArgError({argumentName:"request"});if(a.isNullOrEmptyString(b.method))b.method="GET";b.method=b.method.toUpperCase()};b.logRequest=function(c){if(a._logEnabled){a.log("---HTTP Request---");a.log(c.method+" "+c.url);if(c.headers)for(var d in c.headers)a.log(d+": "+c.headers[d]);b._logBodyEnabled&&a.log(a._getRequestBodyText(c))}};b.logResponse=function(c){if(a._logEnabled){a.log("---HTTP Response---");a.log(""+c.statusCode);if(c.headers)for(var d in c.headers)a.log(d+": "+c.headers[d]);b._logBodyEnabled&&a.log(c.body)}};b._logBodyEnabled=false;return b}();c.HttpUtility=I;var x=function(){function b(a){var b=this;this.m_bridge=a;this.m_promiseResolver={};this.m_handlers=[];this.m_bridge.onMessageFromHost=function(f){var e=JSON.parse(f);if(e.type==3){var c=e.message;if(c&&c.entries)for(var d=0;d<c.entries.length;d++){var a=c.entries[d];if(Array.isArray(a)){var g={messageCategory:a[0],messageType:a[1],targetId:a[2],message:a[3],id:a[4]};c.entries[d]=g}}}b.dispatchMessage(e)}}b.init=function(d){if(typeof d!=="object"||!d)return;var c=new b(d);b.s_instance=c;I.setCustomSendLocalDocumentRequestFunc(function(d){d=a._validateLocalDocumentRequest(d);var e=0;if(!a.isReadonlyRestRequest(d.method))e=1;var g=d.url.indexOf("?");if(g>=0){var i=d.url.substr(g+1),f=a._parseRequestFlagsAndCustomDataFromQueryStringIfAny(i);if(f.flags>=0)e=f.flags}var h={id:b.nextId(),type:1,flags:e,message:d};return c.sendMessageToHostAndExpectResponse(h).then(function(a){var b=a.message;return b})});for(var e=0;e<b.s_onInitedHandlers.length;e++)b.s_onInitedHandlers[e](c)};Object.defineProperty(b,"instance",{"get":function(){return b.s_instance},enumerable:true,configurable:true});b.prototype.sendMessageToHost=function(a){this.m_bridge.sendMessageToHost(JSON.stringify(a))};b.prototype.sendMessageToHostAndExpectResponse=function(b){var c=this,d=a.createPromise(function(a,d){c.m_promiseResolver[b.id]=a});this.m_bridge.sendMessageToHost(JSON.stringify(b));return d};b.prototype.addHostMessageHandler=function(a){this.m_handlers.push(a)};b.prototype.removeHostMessageHandler=function(b){var a=this.m_handlers.indexOf(b);a>=0&&this.m_handlers.splice(a,1)};b.onInited=function(a){b.s_onInitedHandlers.push(a);b.s_instance&&a(b.s_instance)};b.prototype.dispatchMessage=function(a){if(typeof a.id==="number"){var c=this.m_promiseResolver[a.id];if(c){c(a);delete this.m_promiseResolver[a.id];return}}for(var b=0;b<this.m_handlers.length;b++)this.m_handlers[b](a)};b.nextId=function(){return b.s_nextId++};b.s_onInitedHandlers=[];b.s_nextId=1;return b}();c.HostBridge=x;typeof _richApiNativeBridge==="object"&&_richApiNativeBridge&&x.init(_richApiNativeBridge);var d;(function(b){var c=function(d){__extends(c,d);function c(a){var b=d.call(this,typeof a==="string"?a:a.message)||this;Object.setPrototypeOf(b,c.prototype);b.name="RichApi.Error";if(typeof a==="string")b.message=a;else{b.code=a.code;b.message=a.message;b.traceMessages=a.traceMessages||[];b.innerError=a.innerError||null;b.debugInfo=b._createDebugInfo(a.debugInfo||{})}return b}c.prototype.toString=function(){return this.code+": "+this.message};c.prototype._createDebugInfo=function(c){var a={code:this.code,message:this.message};a.toString=function(){return JSON.stringify(this)};for(var d in c)a[d]=c[d];if(this.innerError)if(this.innerError instanceof b.RuntimeError)a.innerError=this.innerError.debugInfo;else a.innerError=this.innerError;return a};c._createInvalidArgError=function(c){return new b.RuntimeError({code:g.invalidArgument,message:a.isNullOrEmptyString(c.argumentName)?a._getResourceString(i.invalidArgumentGeneric):a._getResourceString(i.invalidArgument,c.argumentName),debugInfo:c.errorLocation?{errorLocation:c.errorLocation}:{},innerError:c.innerError})};return c}(Error);b.RuntimeError=c})(d=c._Internal||(c._Internal={}));c.Error=d.RuntimeError;var g=function(){function a(){}a.apiNotFound="ApiNotFound";a.accessDenied="AccessDenied";a.generalException="GeneralException";a.activityLimitReached="ActivityLimitReached";a.invalidArgument="InvalidArgument";a.connectionFailure="ConnectionFailure";a.timeout="Timeout";a.invalidOrTimedOutSession="InvalidOrTimedOutSession";a.invalidObjectPath="InvalidObjectPath";a.invalidRequestContext="InvalidRequestContext";a.valueNotLoaded="ValueNotLoaded";return a}();c.CoreErrorCodes=g;var i=function(){function a(){}a.apiNotFoundDetails="ApiNotFoundDetails";a.connectionFailureWithStatus="ConnectionFailureWithStatus";a.connectionFailureWithDetails="ConnectionFailureWithDetails";a.invalidArgument="InvalidArgument";a.invalidArgumentGeneric="InvalidArgumentGeneric";a.timeout="Timeout";a.invalidOrTimedOutSessionMessage="InvalidOrTimedOutSessionMessage";a.invalidObjectPath="InvalidObjectPath";a.invalidRequestContext="InvalidRequestContext";a.valueNotLoaded="ValueNotLoaded";return a}();c.CoreResourceStrings=i;var l=function(){function a(){}a.flags="flags";a.sourceLibHeader="SdkVersion";a.processQuery="ProcessQuery";a.localDocument="http://document.localhost/";a.localDocumentApiPrefix="http://document.localhost/_api/";a.customData="customdata";return a}();c.CoreConstants=l;var k=function(){function b(){}b.buildMessageArrayForIRequestExecutor=function(i,h,e,f){var d=JSON.stringify(e.Body);a.log("Request:");a.log(d);var c={};a._copyHeaders(e.Headers,c);c[l.sourceLibHeader]=f;var g=b.buildRequestMessageSafeArray(i,h,"POST",l.processQuery,c,d);return g};b.buildResponseOnSuccess=function(c,b){var a={ErrorCode:"",ErrorMessage:"",Headers:null,Body:null};a.Body=JSON.parse(c);a.Headers=b;return a};b.buildResponseOnError=function(d,e){var c={ErrorCode:"",ErrorMessage:"",Headers:null,Body:null};c.ErrorCode=g.generalException;c.ErrorMessage=e;if(d==b.OfficeJsErrorCode_ooeNoCapability)c.ErrorCode=g.accessDenied;else if(d==b.OfficeJsErrorCode_ooeActivityLimitReached)c.ErrorCode=g.activityLimitReached;else if(d==b.OfficeJsErrorCode_ooeInvalidOrTimedOutSession){c.ErrorCode=g.invalidOrTimedOutSession;c.ErrorMessage=a._getResourceString(i.invalidOrTimedOutSessionMessage)}return c};b.buildHttpResponseFromOfficeJsError=function(d,e){var c=500,a={};a.error={};a.error.code=g.generalException;a.error.message=e;if(d===b.OfficeJsErrorCode_ooeNoCapability){c=403;a.error.code=g.accessDenied}else if(d===b.OfficeJsErrorCode_ooeActivityLimitReached){c=429;a.error.code=g.activityLimitReached}return{statusCode:c,headers:{},body:JSON.stringify(a)}};b.buildRequestMessageSafeArray=function(g,f,j,l,b,k){var a=[];if(b)for(var c in b){a.push(c);a.push(b[c])}var e=0,i="",h="",d="";return[g,j,l,a,k,e,f,i,h,d]};b.getResponseBody=function(a){return b.getResponseBodyFromSafeArray(a.value.data)};b.getResponseHeaders=function(a){return b.getResponseHeadersFromSafeArray(a.value.data)};b.getResponseBodyFromSafeArray=function(b){var a=b[2];if(typeof a==="string")return a;var c=a;return c.join("")};b.getResponseHeadersFromSafeArray=function(d){var a=d[1];if(!a)return null;for(var c={},b=0;b<a.length-1;b+=2)c[a[b]]=a[b+1];return c};b.getResponseStatusCode=function(a){return b.getResponseStatusCodeFromSafeArray(a.value.data)};b.getResponseStatusCodeFromSafeArray=function(a){return a[0]};b.OfficeJsErrorCode_ooeInvalidOrTimedOutSession=5012;b.OfficeJsErrorCode_ooeActivityLimitReached=5102;b.OfficeJsErrorCode_ooeNoCapability=7e3;return b}();c.RichApiMessageUtility=k;(function(a){function b(){if(typeof Promise!=="undefined")return Promise;if(typeof Office!=="undefined")if(Office.Promise)return Office.Promise;if(typeof OfficeExtension!=="undefined")if(OfficeExtension.Promise)return OfficeExtension.Promise;throw new a.Error("No Promise implementation found");}a.getPromiseType=b})(d=c._Internal||(c._Internal={}));var a=function(){function a(){}a.log=function(b){a._logEnabled&&typeof console!=="undefined"&&console.log&&console.log(b)};a.checkArgumentNull=function(b,c){if(a.isNullOrUndefined(b))throw d.RuntimeError._createInvalidArgError({argumentName:c});};a.isNullOrUndefined=function(a){if(a===null)return true;if(typeof a==="undefined")return true;return false};a.isUndefined=function(a){if(typeof a==="undefined")return true;return false};a.isNullOrEmptyString=function(a){if(a===null)return true;if(typeof a==="undefined")return true;if(a.length==0)return true;return false};a.isPlainJsonObject=function(b){if(a.isNullOrUndefined(b))return false;if(typeof b!=="object")return false;if(Object.prototype.toString.apply(b)!=="[object Object]")return false;if(b.constructor&&!Object.prototype.hasOwnProperty.call(b,"constructor")&&!Object.prototype.hasOwnProperty.call(b.constructor.prototype,"hasOwnProperty"))return false;for(var c in b)if(!Object.prototype.hasOwnProperty.call(b,c))return false;return true};a.trim=function(a){return a.replace(new RegExp("^\\s+|\\s+$","g"),"")};a.caseInsensitiveCompareString=function(c,b){if(a.isNullOrUndefined(c))return a.isNullOrUndefined(b);else if(a.isNullOrUndefined(b))return false;else return c.toUpperCase()==b.toUpperCase()};a.isReadonlyRestRequest=function(b){return a.caseInsensitiveCompareString(b,"GET")};a._getResourceString=function(d,c){var b;if(typeof window!=="undefined"&&window.Strings&&window.Strings.OfficeOM){var f="L_"+d,e=window.Strings.OfficeOM[f];if(e)b=e}if(!b)b=a.s_resourceStringValues[d];if(!b)b=d;if(!a.isNullOrUndefined(c))if(Array.isArray(c)){var g=c;b=a._formatString(b,g)}else b=b.replace("{0}",c);return b};a._formatString=function(b,a){return b.replace(/\{\d\}/g,function(c){var b=parseInt(c.substr(1,c.length-2));if(b<a.length)return a[b];else throw d.RuntimeError._createInvalidArgError({argumentName:"format"});})};Object.defineProperty(a,"Promise",{"get":function(){return d.getPromiseType()},enumerable:true,configurable:true});a.createPromise=function(b){var c=new a.Promise(b);return c};a._createPromiseFromResult=function(b){return a.createPromise(function(a,c){a(b)})};a._createPromiseFromException=function(b){return a.createPromise(function(c,a){a(b)})};a._createTimeoutPromise=function(b){return a.createPromise(function(a,c){setTimeout(function(){a(null)},b)})};a._createInvalidArgError=function(a){return d.RuntimeError._createInvalidArgError(a)};a._isLocalDocumentUrl=function(b){return a._getLocalDocumentUrlPrefixLength(b)>0};a._getLocalDocumentUrlPrefixLength=function(d){for(var b=["http://document.localhost","https://document.localhost","//document.localhost"],c=d.toLowerCase().trim(),a=0;a<b.length;a++)if(c===b[a])return b[a].length;else if(c.substr(0,b[a].length+1)===b[a]+"/")return b[a].length+1;return 0};a._validateLocalDocumentRequest=function(b){var f=a._getLocalDocumentUrlPrefixLength(b.url);if(f<=0)throw d.RuntimeError._createInvalidArgError({argumentName:"request"});var c=b.url.substr(f),e=c.toLowerCase();if(e==="_api")c="";else if(e.substr(0,"_api/".length)==="_api/")c=c.substr("_api/".length);return{method:b.method,url:c,headers:b.headers,body:b.body}};a._parseRequestFlagsAndCustomDataFromQueryStringIfAny=function(f){for(var c={flags:-1,customData:""},e=f.split("&"),d=0;d<e.length;d++){var a=e[d].split("=");if(a[0].toLowerCase()===l.flags){var b=parseInt(a[1]);b=b&4095;c.flags=b}else if(a[0].toLowerCase()===l.customData)c.customData=decodeURIComponent(a[1])}return c};a._getRequestBodyText=function(a){var b="";if(typeof a.body==="string")b=a.body;else if(a.body&&typeof a.body==="object")b=JSON.stringify(a.body);return b};a._parseResponseBody=function(b){if(typeof b.body==="string"){var c=a.trim(b.body);return JSON.parse(c)}else return b.body};a._buildRequestMessageSafeArray=function(b){var d=0;if(!a.isReadonlyRestRequest(b.method))d=1;var e="";if(b.url.substr(0,l.processQuery.length).toLowerCase()===l.processQuery.toLowerCase()){var f=b.url.indexOf("?");if(f>0){var g=b.url.substr(f+1),c=a._parseRequestFlagsAndCustomDataFromQueryStringIfAny(g);if(c.flags>=0)d=c.flags;e=c.customData}}return k.buildRequestMessageSafeArray(e,d,b.method,b.url,b.headers,a._getRequestBodyText(b))};a._parseHttpResponseHeaders=function(g){var h={};if(!a.isNullOrEmptyString(g))for(var j=new RegExp("\x0d?\x0a"),i=g.split(j),f=0;f<i.length;f++){var b=i[f];if(b!=null){var c=b.indexOf(":");if(c>0){var e=b.substr(0,c),d=b.substr(c+1);e=a.trim(e);d=a.trim(d);h[e.toUpperCase()]=d}}}return h};a._parseErrorResponse=function(c){var b=null;if(a.isPlainJsonObject(c.body))b=c.body;else if(!a.isNullOrEmptyString(c.body)){var f=a.trim(c.body);try{b=JSON.parse(f)}catch(h){a.log("Error when parse "+f)}}var e,d;if(!a.isNullOrUndefined(b)&&typeof b==="object"&&b.error){d=b.error.code;e=a._getResourceString(i.connectionFailureWithDetails,[c.statusCode.toString(),b.error.code,b.error.message])}else e=a._getResourceString(i.connectionFailureWithStatus,c.statusCode.toString());if(a.isNullOrEmptyString(d))d=g.connectionFailure;return{errorCode:d,errorMessage:e}};a._copyHeaders=function(a,b){if(a&&b)for(var c in a)b[c]=a[c]};a.addResourceStringValues=function(b){for(var c in b)a.s_resourceStringValues[c]=b[c]};a._logEnabled=false;a.s_resourceStringValues={ApiNotFoundDetails:"The method or property {0} is part of the {1} requirement set, which is not available in your version of {2}.",ConnectionFailureWithStatus:"The request failed with status code of {0}.",ConnectionFailureWithDetails:"The request failed with status code of {0}, error code {1} and the following error message: {2}",InvalidArgument:"The argument '{0}' doesn't work for this situation, is missing, or isn't in the right format.",InvalidObjectPath:'The object path \'{0}\' isn\'t working for what you\'re trying to do. If you\'re using the object across multiple "context.sync" calls and outside the sequential execution of a ".run" batch, please use the "context.trackedObjects.add()" and "context.trackedObjects.remove()" methods to manage the object\'s lifetime.',InvalidRequestContext:"Cannot use the object across different request contexts.",Timeout:"The operation has timed out.",ValueNotLoaded:'The value of the result object has not been loaded yet. Before reading the value property, call "context.sync()" on the associated request context.'};return a}();c.CoreUtility=a;var C=function(){function a(){}a.setMock=function(b){a.s_isMock=b};a.isMock=function(){return a.s_isMock};return a}();c.TestUtility=C;c._internalConfig={showDisposeInfoInDebugInfo:false,showInternalApiInDebugInfo:false,enableEarlyDispose:true,alwaysPolyfillClientObjectUpdateMethod:false,alwaysPolyfillClientObjectRetrieveMethod:false,enableConcurrentFlag:true,enableUndoableFlag:true};c.config={extendedErrorLogging:false};var v=function(){function a(){}a.createSetPropertyAction=function(e,a,g,i,h){f.validateObjectPath(a);var d={Id:e._nextId(),ActionType:4,Name:g,ObjectPathId:a._objectPath.objectPathInfo.Id,ArgumentInfo:{}},j=[i],c=f.setMethodArguments(e,d.ArgumentInfo,j);f.validateReferencedObjectPaths(c);var b=new n(d,0,h);b.referencedObjectPath=a._objectPath;b.referencedArgumentObjectPaths=c;return a._addAction(b)};a.createQueryAction=function(g,a,d,c){f.validateObjectPath(a);var e={Id:g._nextId(),ActionType:2,Name:"",ObjectPathId:a._objectPath.objectPathInfo.Id,QueryInfo:d},b=new n(e,1,4);b.referencedObjectPath=a._objectPath;return a._addAction(b,c)};a.createQueryAsJsonAction=function(g,a,d,c){f.validateObjectPath(a);var e={Id:g._nextId(),ActionType:7,Name:"",ObjectPathId:a._objectPath.objectPathInfo.Id,QueryInfo:d},b=new n(e,1,4);b.referencedObjectPath=a._objectPath;return a._addAction(b,c)};a.createUpdateAction=function(e,a,c){f.validateObjectPath(a);var d={Id:e._nextId(),ActionType:9,Name:"",ObjectPathId:a._objectPath.objectPathInfo.Id,ObjectState:c},b=new n(d,0,0);b.referencedObjectPath=a._objectPath;return a._addAction(b)};return a}();c.CommonActionFactory=v;var B=function(){function b(a,b){this.m_contextBase=a;this.m_objectPath=b}Object.defineProperty(b.prototype,"_objectPath",{"get":function(){return this.m_objectPath},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_context",{"get":function(){return this.m_contextBase},enumerable:true,configurable:true});b.prototype._addAction=function(c,b){var d=this;if(b===void 0)b=null;return a.createPromise(function(a,e){d._context._addServiceApiAction(c,b,a,e)})};b.prototype._retrieve=function(e,b){var a=c._internalConfig.alwaysPolyfillClientObjectRetrieveMethod;if(!a)a=!f.isSetSupported("RichApiRuntime","1.1");var d=F._parseQueryOption(e);if(a)return v.createQueryAction(this._context,this,d,b);return v.createQueryAsJsonAction(this._context,this,d,b)};b.prototype._recursivelyUpdate=function(p){var n=c._internalConfig.alwaysPolyfillClientObjectUpdateMethod;if(!n)n=!f.isSetSupported("RichApiRuntime","1.2");try{var e=this[j.scalarPropertyNames];if(!e)e=[];var k=this[j.scalarPropertyUpdateable];if(!k){k=[];for(var h=0;h<e.length;h++)k.push(false)}var l=this[j.navigationPropertyNames];if(!l)l=[];var o={},m={},q=0;for(var b in p){var s=e.indexOf(b);if(s>=0){if(!k[s])throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(y.attemptingToSetReadOnlyProperty,b),debugInfo:{errorLocation:b}});o[b]=p[b];++q}else if(l.indexOf(b)>=0)m[b]=p[b];else throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(y.propertyDoesNotExist,b),debugInfo:{errorLocation:b}});}if(q>0)if(n)for(var h=0;h<e.length;h++){var b=e[h],r=o[b];!f.isUndefined(r)&&v.createSetPropertyAction(this._context,this,b,r)}else v.createUpdateAction(this._context,this,o);for(var b in m){var t=this[b],u=m[b];t._recursivelyUpdate(u)}}catch(w){throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(i.invalidArgument,"properties"),debugInfo:{errorLocation:this._className+".update"},innerError:w});}};return b}();c.ClientObjectBase=B;var n=function(){function a(b,a,c){this.m_actionInfo=b;this.m_operationType=a;this.m_flags=c}Object.defineProperty(a.prototype,"actionInfo",{"get":function(){return this.m_actionInfo},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"operationType",{"get":function(){return this.m_operationType},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"flags",{"get":function(){return this.m_flags},enumerable:true,configurable:true});return a}();c.Action=n;var m=function(){function b(c,b,e,a,d,f){this.m_objectPathInfo=c;this.m_parentObjectPath=b;this.m_isCollection=e;this.m_isInvalidAfterRequest=a;this.m_isValid=true;this.m_operationType=d;this.m_flags=f}Object.defineProperty(b.prototype,"id",{"get":function(){var a=this.m_objectPathInfo.ArgumentInfo;if(!a)return undefined;var b=a.Arguments;if(!b)return undefined;return b[0]},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"parent",{"get":function(){var a=this.m_parentObjectPath;if(!a)return undefined;return a},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"parentId",{"get":function(){return this.parent?this.parent.id:undefined},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"objectPathInfo",{"get":function(){return this.m_objectPathInfo},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"operationType",{"get":function(){return this.m_operationType},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"flags",{"get":function(){return this.m_flags},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"isCollection",{"get":function(){return this.m_isCollection},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"isInvalidAfterRequest",{"get":function(){return this.m_isInvalidAfterRequest},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"parentObjectPath",{"get":function(){return this.m_parentObjectPath},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"argumentObjectPaths",{"get":function(){return this.m_argumentObjectPaths},"set":function(a){this.m_argumentObjectPaths=a},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"isValid",{"get":function(){return this.m_isValid},"set":function(a){this.m_isValid=a;if(!a&&this.m_objectPathInfo.ObjectPathType===6&&this.m_savedObjectPathInfo){b.copyObjectPathInfo(this.m_savedObjectPathInfo.pathInfo,this.m_objectPathInfo);this.m_parentObjectPath=this.m_savedObjectPathInfo.parent;this.m_isValid=true;this.m_savedObjectPathInfo=null}},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"originalObjectPathInfo",{"get":function(){return this.m_originalObjectPathInfo},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"getByIdMethodName",{"get":function(){return this.m_getByIdMethodName},"set":function(a){this.m_getByIdMethodName=a},enumerable:true,configurable:true});b.prototype._updateAsNullObject=function(){this.resetForUpdateUsingObjectData();this.m_objectPathInfo.ObjectPathType=7;this.m_objectPathInfo.Name="";this.m_parentObjectPath=null};b.prototype.saveOriginalObjectPathInfo=function(){if(c.config.extendedErrorLogging&&!this.m_originalObjectPathInfo){this.m_originalObjectPathInfo={};b.copyObjectPathInfo(this.m_objectPathInfo,this.m_originalObjectPathInfo)}};b.prototype.updateUsingObjectData=function(i,c){var m=i[j.referenceId];if(!a.isNullOrEmptyString(m)){if(!this.m_savedObjectPathInfo&&!this.isInvalidAfterRequest&&b.isRestorableObjectPath(this.m_objectPathInfo.ObjectPathType)){var n={};b.copyObjectPathInfo(this.m_objectPathInfo,n);this.m_savedObjectPathInfo={pathInfo:n,parent:this.m_parentObjectPath}}this.saveOriginalObjectPathInfo();this.resetForUpdateUsingObjectData();this.m_objectPathInfo.ObjectPathType=6;this.m_objectPathInfo.Name=m;delete this.m_objectPathInfo.ParentObjectPathId;this.m_parentObjectPath=null;return}if(c){var l=c[j.collectionPropertyPath];if(!a.isNullOrEmptyString(l)&&c.context){var d=f.tryGetObjectIdFromLoadOrRetrieveResult(i);if(!a.isNullOrUndefined(d)){for(var g=l.split("."),h=c.context[g[0]],k=1;k<g.length;k++)h=h[g[k]];this.saveOriginalObjectPathInfo();this.resetForUpdateUsingObjectData();this.m_parentObjectPath=h._objectPath;this.m_objectPathInfo.ParentObjectPathId=this.m_parentObjectPath.objectPathInfo.Id;this.m_objectPathInfo.ObjectPathType=5;this.m_objectPathInfo.Name="";this.m_objectPathInfo.ArgumentInfo.Arguments=[d];return}}}var o=this.parentObjectPath&&this.parentObjectPath.isCollection,e=this.getByIdMethodName;if(o||!a.isNullOrEmptyString(e)){var d=f.tryGetObjectIdFromLoadOrRetrieveResult(i);if(!a.isNullOrUndefined(d)){this.saveOriginalObjectPathInfo();this.resetForUpdateUsingObjectData();if(!a.isNullOrEmptyString(e)){this.m_objectPathInfo.ObjectPathType=3;this.m_objectPathInfo.Name=e}else{this.m_objectPathInfo.ObjectPathType=5;this.m_objectPathInfo.Name=""}this.m_objectPathInfo.ArgumentInfo.Arguments=[d];return}}};b.prototype.resetForUpdateUsingObjectData=function(){this.m_isInvalidAfterRequest=false;this.m_isValid=true;this.m_operationType=1;this.m_flags=4;this.m_objectPathInfo.ArgumentInfo={};this.m_argumentObjectPaths=null;this.m_getByIdMethodName=null};b.isRestorableObjectPath=function(a){return a===1||a===5||a===3||a===4};b.copyObjectPathInfo=function(b,a){a.Id=b.Id;a.ArgumentInfo=b.ArgumentInfo;a.Name=b.Name;a.ObjectPathType=b.ObjectPathType;a.ParentObjectPathId=b.ParentObjectPathId};return b}();c.ObjectPath=m;var F=function(){function a(){this.m_nextId=0}a.prototype._nextId=function(){return++this.m_nextId};a.prototype._addServiceApiAction=function(c,a,b,d){if(!this.m_serviceApiQueue)this.m_serviceApiQueue=new jb(this);this.m_serviceApiQueue.add(c,a,b,d)};a._parseQueryOption=function(e){var c={};if(typeof e==="string"){var g=e;c.Select=f._parseSelectExpand(g)}else if(Array.isArray(e))c.Select=e;else if(typeof e==="object"){var b=e;if(a.isLoadOption(b)){if(typeof b.select==="string")c.Select=f._parseSelectExpand(b.select);else if(Array.isArray(b.select))c.Select=b.select;else if(!f.isNullOrUndefined(b.select))throw d.RuntimeError._createInvalidArgError({argumentName:"option.select"});if(typeof b.expand==="string")c.Expand=f._parseSelectExpand(b.expand);else if(Array.isArray(b.expand))c.Expand=b.expand;else if(!f.isNullOrUndefined(b.expand))throw d.RuntimeError._createInvalidArgError({argumentName:"option.expand"});if(typeof b.top==="number")c.Top=b.top;else if(!f.isNullOrUndefined(b.top))throw d.RuntimeError._createInvalidArgError({argumentName:"option.top"});if(typeof b.skip==="number")c.Skip=b.skip;else if(!f.isNullOrUndefined(b.skip))throw d.RuntimeError._createInvalidArgError({argumentName:"option.skip"});}else c=a.parseStrictLoadOption(e)}else if(!f.isNullOrUndefined(e))throw d.RuntimeError._createInvalidArgError({argumentName:"option"});return c};a.isLoadOption=function(a){if(!f.isUndefined(a.select)&&(typeof a.select==="string"||Array.isArray(a.select)))return true;if(!f.isUndefined(a.expand)&&(typeof a.expand==="string"||Array.isArray(a.expand)))return true;if(!f.isUndefined(a.top)&&typeof a.top==="number")return true;if(!f.isUndefined(a.skip)&&typeof a.skip==="number")return true;for(var b in a)return false;return true};a.parseStrictLoadOption=function(c){var b={Select:[]};a.parseStrictLoadOptionHelper(b,"","option",c);return b};a.combineQueryPath=function(a,b,c){if(a.length===0)return b;else return a+c+b};a.parseStrictLoadOptionHelper=function(g,e,f,h){for(var b in h){var c=h[b];if(b==="$all"){if(typeof c!=="boolean")throw d.RuntimeError._createInvalidArgError({argumentName:a.combineQueryPath(f,b,".")});c&&g.Select.push(a.combineQueryPath(e,"*","/"))}else if(b==="$top"){if(typeof c!=="number"||e.length>0)throw d.RuntimeError._createInvalidArgError({argumentName:a.combineQueryPath(f,b,".")});g.Top=c}else if(b==="$skip"){if(typeof c!=="number"||e.length>0)throw d.RuntimeError._createInvalidArgError({argumentName:a.combineQueryPath(f,b,".")});g.Skip=c}else if(typeof c==="boolean")c&&g.Select.push(a.combineQueryPath(e,b,"/"));else if(typeof c==="object")a.parseStrictLoadOptionHelper(g,a.combineQueryPath(e,b,"/"),a.combineQueryPath(f,b,"."),c);else throw d.RuntimeError._createInvalidArgError({argumentName:a.combineQueryPath(f,b,".")});}};return a}();c.ClientRequestContextBase=F;var W=function(){function b(a){this.m_objectPath=a}b.prototype._handleResult=function(b){if(a.isNullOrUndefined(b))this.m_objectPath._updateAsNullObject();else this.m_objectPath.updateUsingObjectData(b,null)};return b}(),M=function(){function b(a){this.m_contextBase=a;this.m_actions=[];this.m_actionResultHandler={};this.m_referencedObjectPaths={};this.m_instantiatedObjectPaths={};this.m_preSyncPromises=[]}b.prototype.addAction=function(a){this.m_actions.push(a);if(a.actionInfo.ActionType==1)this.m_instantiatedObjectPaths[a.actionInfo.ObjectPathId]=a};Object.defineProperty(b.prototype,"hasActions",{"get":function(){return this.m_actions.length>0},enumerable:true,configurable:true});b.prototype._getLastAction=function(){return this.m_actions[this.m_actions.length-1]};b.prototype.ensureInstantiateObjectPath=function(a){if(a){if(this.m_instantiatedObjectPaths[a.objectPathInfo.Id])return;this.ensureInstantiateObjectPath(a.parentObjectPath);this.ensureInstantiateObjectPaths(a.argumentObjectPaths);if(!this.m_instantiatedObjectPaths[a.objectPathInfo.Id]){var d={Id:this.m_contextBase._nextId(),ActionType:1,Name:"",ObjectPathId:a.objectPathInfo.Id},b=new n(d,1,4);b.referencedObjectPath=a;this.addReferencedObjectPath(a);this.addAction(b);var c=new W(a);this.addActionResultHandler(b,c)}}};b.prototype.ensureInstantiateObjectPaths=function(a){if(a)for(var b=0;b<a.length;b++)this.ensureInstantiateObjectPath(a[b])};b.prototype.addReferencedObjectPath=function(b){if(!b||this.m_referencedObjectPaths[b.objectPathInfo.Id])return;if(!b.isValid)throw new d.RuntimeError({code:g.invalidObjectPath,message:a._getResourceString(i.invalidObjectPath,f.getObjectPathExpression(b)),debugInfo:{errorLocation:f.getObjectPathExpression(b)}});while(b){this.m_referencedObjectPaths[b.objectPathInfo.Id]=b;b.objectPathInfo.ObjectPathType==3&&this.addReferencedObjectPaths(b.argumentObjectPaths);b=b.parentObjectPath}};b.prototype.addReferencedObjectPaths=function(a){if(a)for(var b=0;b<a.length;b++)this.addReferencedObjectPath(a[b])};b.prototype.addActionResultHandler=function(b,a){this.m_actionResultHandler[b.actionInfo.Id]=a};b.prototype.aggregrateRequestFlags=function(a,c,b){if(c===0){a=a|1;if((b&2)===0)a=a&~16;if((b&8)===0)a=a&~256;a=a&~4}if(b&1)a=a|2;if((b&4)===0)a=a&~4;return a};b.prototype.finallyNormalizeFlags=function(a){if((a&1)===0){a=a&~16;a=a&~256}if(!c._internalConfig.enableConcurrentFlag)a=a&~4;if(!c._internalConfig.enableUndoableFlag)a=a&~16;if(!f.isSetSupported("RichApiRuntimeFlag","1.1")){a=a&~4;a=a&~16}if(!f.isSetSupported("RichApiRuntimeFlag","1.2"))a=a&~256;if(typeof this.m_flagsForTesting==="number")a=this.m_flagsForTesting;return a};b.prototype.buildRequestMessageBodyAndRequestFlags=function(){c._internalConfig.enableEarlyDispose&&b._calculateLastUsedObjectPathIds(this.m_actions);var a=4|16|256,h={};for(var e in this.m_referencedObjectPaths){a=this.aggregrateRequestFlags(a,this.m_referencedObjectPaths[e].operationType,this.m_referencedObjectPaths[e].flags);h[e]=this.m_referencedObjectPaths[e].objectPathInfo}for(var i=[],g=false,f=0;f<this.m_actions.length;f++){var d=this.m_actions[f];if(d.actionInfo.ActionType===3&&d.actionInfo.Name===j.keepReference)g=true;a=this.aggregrateRequestFlags(a,d.operationType,d.flags);i.push(d.actionInfo)}a=this.finallyNormalizeFlags(a);var k={AutoKeepReference:this.m_contextBase._autoCleanup&&g,Actions:i,ObjectPaths:h};return{body:k,flags:a}};b.prototype.processResponse=function(a){if(a)for(var b=0;b<a.length;b++){var c=a[b],d=this.m_actionResultHandler[c.ActionId];d&&d._handleResult(c.Value)}};b.prototype.invalidatePendingInvalidObjectPaths=function(){for(var a in this.m_referencedObjectPaths)if(this.m_referencedObjectPaths[a].isInvalidAfterRequest)this.m_referencedObjectPaths[a].isValid=false};b.prototype._addPreSyncPromise=function(a){this.m_preSyncPromises.push(a)};Object.defineProperty(b.prototype,"_preSyncPromises",{"get":function(){return this.m_preSyncPromises},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_actions",{"get":function(){return this.m_actions},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_objectPaths",{"get":function(){return this.m_referencedObjectPaths},enumerable:true,configurable:true});b.prototype._removeKeepReferenceAction=function(c){for(var a=this.m_actions.length-1;a>=0;a--){var b=this.m_actions[a].actionInfo;if(b.ObjectPathId===c&&b.ActionType===3&&b.Name===j.keepReference){this.m_actions.splice(a,1);break}}};b._updateLastUsedActionIdOfObjectPathId=function(c,a,f){while(a){if(c[a.objectPathInfo.Id])return;c[a.objectPathInfo.Id]=f;var d=a.argumentObjectPaths;if(d)for(var g=d.length,e=0;e<g;e++)b._updateLastUsedActionIdOfObjectPathId(c,d[e],f);a=a.parentObjectPath}};b._calculateLastUsedObjectPathIds=function(k){for(var d={},l=k.length,c=l-1;c>=0;--c){var a=k[c],f=a.actionInfo.Id;a.referencedObjectPath&&b._updateLastUsedActionIdOfObjectPathId(d,a.referencedObjectPath,f);var i=a.referencedArgumentObjectPaths;if(i)for(var n=i.length,j=0;j<n;j++)b._updateLastUsedActionIdOfObjectPathId(d,i[j],f)}var g={};for(var m in d){var f=d[m],e=g[f];if(!e){e=[];g[f]=e}e.push(parseInt(m))}for(var c=0;c<l;c++){var a=k[c],h=g[a.actionInfo.Id];if(h&&h.length>0)a.actionInfo.L=h;else if(a.actionInfo.L)delete a.actionInfo.L}};return b}();c.ClientRequestBase=M;var A=function(){function b(a){this.m_type=a}Object.defineProperty(b.prototype,"value",{"get":function(){if(!this.m_isLoaded)throw new d.RuntimeError({code:g.valueNotLoaded,message:a._getResourceString(i.valueNotLoaded),debugInfo:{errorLocation:"clientResult.value"}});return this.m_value},enumerable:true,configurable:true});b.prototype._handleResult=function(a){this.m_isLoaded=true;if(typeof a==="object"&&a&&a._IsNull)return;if(this.m_type===1)this.m_value=f.adjustToDateTime(a);else this.m_value=a};return b}();c.ClientResult=A;var jb=function(){function b(a){this.m_context=a;this.m_actions=[]}b.prototype.add=function(c,a,b,d){var e=this;this.m_actions.push({action:c,resultHandler:a,resolve:b,reject:d});this.m_actions.length===1&&setTimeout(function(){return e.processActions()},0)};b.prototype.processActions=function(){var k=this;if(this.m_actions.length===0)return;var c=this.m_actions;this.m_actions=[];for(var b=new M(this.m_context),e=0;e<c.length;e++){var d=c[e];b.ensureInstantiateObjectPath(d.action.referencedObjectPath);b.ensureInstantiateObjectPaths(d.action.referencedArgumentObjectPaths);b.addAction(d.action);b.addReferencedObjectPath(d.action.referencedObjectPath);b.addReferencedObjectPaths(d.action.referencedArgumentObjectPaths)}var g=b.buildRequestMessageBodyAndRequestFlags(),f=g.body,j=g.flags,h={Url:l.localDocumentApiPrefix,Headers:null,Body:f};a.log("Request:");a.log(JSON.stringify(f));var i=new K;i.executeAsync(this.m_context._customData,j,h).then(function(a){k.processResponse(b,c,a)}).catch(function(d){for(var a=0;a<c.length;a++){var b=c[a];b.reject(d)}})};b.prototype.processResponse=function(d,c,a){var e=this.getErrorFromResponse(a),b=null;if(a.Body.Results)b=a.Body.Results;else if(a.Body.ProcessedResults&&a.Body.ProcessedResults.Results)b=a.Body.ProcessedResults.Results;if(!b)b=[];this.processActionResults(d,c,b,e)};b.prototype.getErrorFromResponse=function(b){if(!a.isNullOrEmptyString(b.ErrorCode))return new d.RuntimeError({code:b.ErrorCode,message:b.ErrorMessage});if(b.Body&&b.Body.Error)return new d.RuntimeError({code:b.Body.Error.Code,message:b.Body.Error.Message});return null};b.prototype.processActionResults=function(j,g,b,h){j.processResponse(b);for(var e=0;e<g.length;e++){for(var a=g[e],i=a.action.actionInfo.Id,f=false,c=0;c<b.length;c++)if(i==b[c].ActionId){var d=b[c].Value;if(a.resultHandler){a.resultHandler._handleResult(d);d=a.resultHandler.value}a.resolve&&a.resolve(d);f=true;break}if(!f&&a.reject)if(h)a.reject(h);else a.reject("No response for the action.")}};return b}(),K=function(){function b(){}b.prototype.getRequestUrl=function(a,b){if(a.charAt(a.length-1)!="/")a=a+"/";a=a+l.processQuery;a=a+"?"+l.flags+"="+b.toString();return a};b.prototype.executeAsync=function(i,g,c){var h=this.getRequestUrl(c.Url,g),d={method:"POST",url:h,headers:{},body:c.Body};d.headers[l.sourceLibHeader]=b.SourceLibHeaderValue;d.headers["CONTENT-TYPE"]="application/json";if(c.Headers)for(var e in c.Headers)d.headers[e]=c.Headers[e];var f=a._isLocalDocumentUrl(d.url)?I.sendLocalDocumentRequest:I.sendRequest;return f(d).then(function(b){var c;if(b.statusCode===200)c={ErrorCode:null,ErrorMessage:null,Headers:b.headers,Body:a._parseResponseBody(b)};else{a.log("Error Response:"+b.body);var d=a._parseErrorResponse(b);c={ErrorCode:d.errorCode,ErrorMessage:d.errorMessage,Headers:b.headers,Body:null}}return c})};b.SourceLibHeaderValue="officejs-rest";return b}();c.HttpRequestExecutor=K;var j=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}a.collectionPropertyPath="_collectionPropertyPath";a.id="Id";a.idLowerCase="id";a.idPrivate="_Id";a.keepReference="_KeepReference";a.objectPathIdPrivate="_ObjectPathId";a.referenceId="_ReferenceId";a.items="_Items";a.itemsLowerCase="items";a.scalarPropertyNames="_scalarPropertyNames";a.scalarPropertyOriginalNames="_scalarPropertyOriginalNames";a.navigationPropertyNames="_navigationPropertyNames";a.scalarPropertyUpdateable="_scalarPropertyUpdateable";return a}(l);c.CommonConstants=j;var f=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}b.validateObjectPath=function(e){var c=e._objectPath;while(c){if(!c.isValid)throw new d.RuntimeError({code:g.invalidObjectPath,message:a._getResourceString(i.invalidObjectPath,b.getObjectPathExpression(c)),debugInfo:{errorLocation:b.getObjectPathExpression(c)}});c=c.parentObjectPath}};b.validateReferencedObjectPaths=function(e){if(e)for(var f=0;f<e.length;f++){var c=e[f];while(c){if(!c.isValid)throw new d.RuntimeError({code:g.invalidObjectPath,message:a._getResourceString(i.invalidObjectPath,b.getObjectPathExpression(c))});c=c.parentObjectPath}}};b._toCamelLowerCase=function(b){if(a.isNullOrEmptyString(b))return b;var c=0;while(c<b.length&&b.charCodeAt(c)>=65&&b.charCodeAt(c)<=90)c++;if(c<b.length)return b.substr(0,c).toLowerCase()+b.substr(c);else return b.toLowerCase()};b.adjustToDateTime=function(c){if(a.isNullOrUndefined(c))return null;if(typeof c==="string")return new Date(c);if(Array.isArray(c)){for(var d=c,e=0;e<d.length;e++)d[e]=b.adjustToDateTime(d[e]);return d}throw a._createInvalidArgError({argumentName:"date"});};b.tryGetObjectIdFromLoadOrRetrieveResult=function(c){var b=c[j.id];if(a.isNullOrUndefined(b))b=c[j.idLowerCase];if(a.isNullOrUndefined(b))b=c[j.idPrivate];return b};b.getObjectPathExpression=function(c){var a="";while(c){switch(c.objectPathInfo.ObjectPathType){case 1:a=a;break;case 2:a="new()"+(a.length>0?".":"")+a;break;case 3:a=b.normalizeName(c.objectPathInfo.Name)+"()"+(a.length>0?".":"")+a;break;case 4:a=b.normalizeName(c.objectPathInfo.Name)+(a.length>0?".":"")+a;break;case 5:a="getItem()"+(a.length>0?".":"")+a;break;case 6:a="_reference()"+(a.length>0?".":"")+a;break}c=c.parentObjectPath}return a};b.setMethodArguments=function(g,f,c){if(a.isNullOrUndefined(c))return null;var e=[],d=[],h=b.collectObjectPathInfos(g,c,e,d);f.Arguments=c;if(h)f.ReferencedObjectPathIds=d;return e};b.validateContext=function(b,c){if(b&&c&&c._context!==b)throw new d.RuntimeError({code:g.invalidRequestContext,message:a._getResourceString(i.invalidRequestContext)});};b.isSetSupported=function(b,a){if(typeof window!=="undefined"&&window.Office&&window.Office.context&&window.Office.context.requirements)return window.Office.context.requirements.isSetSupported(b,a);return true};b.throwIfApiNotSupported=function(e,f,c,h){if(!b._doApiNotSupportedCheck)return;if(!b.isSetSupported(f,c)){var j=a._getResourceString(i.apiNotFoundDetails,[e,f+" "+c,h]);throw new d.RuntimeError({code:g.apiNotFound,message:j,debugInfo:{errorLocation:e}});}};b._parseSelectExpand=function(e){var f=[];if(!a.isNullOrEmptyString(e))for(var d=e.split(","),c=0;c<d.length;c++){var b=d[c];b=g(b.trim());b.length>0&&f.push(b)}return f;function g(b){var a=b.toLowerCase();if(a==="items"||a==="items/")return"*";var c=6,d=a.substr(0,c)==="items/"||a.substr(0,c)==="items.";if(d)b=b.substr(c);return b.replace(new RegExp("[/.]items[/.]","gi"),"/")}};b.changePropertyNameToCamelLowerCase=function(a){var h=95;if(Array.isArray(a)){for(var c=[],e=0;e<a.length;e++)c.push(this.changePropertyNameToCamelLowerCase(a[e]));return c}else if(typeof a==="object"&&a!==null){var c={};for(var d in a){var f=a[d];if(d===j.items){c={};c[j.itemsLowerCase]=this.changePropertyNameToCamelLowerCase(f);break}else{var g=b._toCamelLowerCase(d);c[g]=this.changePropertyNameToCamelLowerCase(f)}}return c}else return a};b.purifyJson=function(a){var f=95;if(Array.isArray(a)){for(var c=[],e=0;e<a.length;e++)c.push(this.purifyJson(a[e]));return c}else if(typeof a==="object"&&a!==null){var c={};for(var d in a)if(d.charCodeAt(0)!==f){var b=a[d];if(typeof b==="object"&&b!==null&&Array.isArray(b.items))b=b.items;c[d]=this.purifyJson(b)}return c}else return a};b.collectObjectPathInfos=function(j,d,g,e){for(var h=false,c=0;c<d.length;c++)if(d[c]instanceof B){var f=d[c];b.validateContext(j,f);d[c]=f._objectPath.objectPathInfo.Id;e.push(f._objectPath.objectPathInfo.Id);g.push(f._objectPath);h=true}else if(Array.isArray(d[c])){var i=[],k=b.collectObjectPathInfos(j,d[c],g,i);if(k){e.push(i);h=true}else e.push(0)}else if(a.isPlainJsonObject(d[c])){e.push(0);b.replaceClientObjectPropertiesWithObjectPathIds(d[c],g)}else e.push(0);return h};b.replaceClientObjectPropertiesWithObjectPathIds=function(f,e){var g,h;for(var k in f){var c=f[k];if(c instanceof B){e.push(c._objectPath);f[k]=(g={},g[j.objectPathIdPrivate]=c._objectPath.objectPathInfo.Id,g)}else if(Array.isArray(c))for(var d=0;d<c.length;d++)if(c[d]instanceof B){var i=c[d];e.push(i._objectPath);c[d]=(h={},h[j.objectPathIdPrivate]=i._objectPath.objectPathInfo.Id,h)}else a.isPlainJsonObject(c[d])&&b.replaceClientObjectPropertiesWithObjectPathIds(c[d],e);else a.isPlainJsonObject(c)&&b.replaceClientObjectPropertiesWithObjectPathIds(c,e)}};b.normalizeName=function(a){return a.substr(0,1).toLowerCase()+a.substr(1)};b._doApiNotSupportedCheck=false;return b}(a);c.CommonUtility=f;var y=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}a.propertyDoesNotExist="PropertyDoesNotExist";a.attemptingToSetReadOnlyProperty="AttemptingToSetReadOnlyProperty";return a}(i);c.CommonResourceStrings=y;var S=function(b){__extends(a,b);function a(c){var a=b.call(this)||this;a.m_shouldPolyfill=c;return a}a.prototype._handleResult=function(a){b.prototype._handleResult.call(this,a);if(this.m_shouldPolyfill)this.m_value=f.changePropertyNameToCamelLowerCase(this.m_value);this.m_value=this.removeItemNodes(this.m_value)};a.prototype.removeItemNodes=function(a){if(typeof a==="object"&&a!==null&&a[j.itemsLowerCase])a=a[j.itemsLowerCase];return f.purifyJson(a)};return a}(A);c.ClientRetrieveResult=S;var db=function(){function a(a){this.callback=a}a.prototype._handleResult=function(a){this.callback&&this.callback()};return a}(),R=function(b){__extends(a,b);function a(c){var a=b.call(this)||this;a.callback=c;return a}a.prototype._handleResult=function(a){b.prototype._handleResult.call(this,a);this.callback()};return a}(A);c.ClientResultCallback=R;var H=function(){function b(){}b.invokeMethod=function(b,h,c,e,d,g){if(c===void 0)c=0;if(e===void 0)e=[];if(d===void 0)d=0;if(g===void 0)g=0;return a.createPromise(function(j,k){var l=new A,g={Id:b._context._nextId(),ActionType:3,Name:h,ObjectPathId:b._objectPath.objectPathInfo.Id,ArgumentInfo:{}},i=f.setMethodArguments(b._context,g.ArgumentInfo,e),a=new n(g,c,d);a.referencedObjectPath=b._objectPath;a.referencedArgumentObjectPaths=i;b._context._addServiceApiAction(a,l,j,k)})};b.invokeMethodWithClientResultCallback=function(e,b,d){var c=0,h=[],g=0;return a.createPromise(function(k,l){var m=new R(e),i={Id:b._context._nextId(),ActionType:3,Name:d,ObjectPathId:b._objectPath.objectPathInfo.Id,ArgumentInfo:{}},j=f.setMethodArguments(b._context,i.ArgumentInfo,h),a=new n(i,c,g);a.referencedObjectPath=b._objectPath;a.referencedArgumentObjectPaths=j;b._context._addServiceApiAction(a,m,k,l)})};b.invokeRetrieve=function(g,a){var d=c._internalConfig.alwaysPolyfillClientObjectRetrieveMethod;if(!d)d=!f.isSetSupported("RichApiRuntime","1.1");var e;if(typeof a[0]==="object"&&a[0].hasOwnProperty("$all")){if(!a[0].$all)throw c.Error._createInvalidArgError({});e=a[0]}else e=b._parseSelectOption(a);return g._retrieve(e,new S(d))};b._parseSelectOption=function(a){if(!a||!a[0])throw c.Error._createInvalidArgError({});var d=a[0]&&typeof a[0]!=="string"?a[0]:a;return Array.isArray(d)?d:b.parseRecursiveSelect(d)};b.parseRecursiveSelect=function(b){var a=function(b){return Object.keys(b).reduce(function(c,e){var d=b[e];if(typeof d==="object")return c.concat(a(d).map(function(a){return e+"/"+a}));if(d)return c.concat(e);return c},[])};return a(b)};b.invokeRecursiveUpdate=function(b,c){return a.createPromise(function(d,f){b._recursivelyUpdate(c);var a={Id:b._context._nextId(),ActionType:5,Name:"Trace",ObjectPathId:0},e=new n(a,1,4);b._context._addServiceApiAction(e,null,d,f)})};b.createRootServiceObject=function(d,a){var b={Id:a._nextId(),ObjectPathType:1,Name:""},c=new m(b,null,false,false,1,4);return new d(a,c)};b.createTopLevelServiceObject=function(g,a,e,c,f){var b={Id:a._nextId(),ObjectPathType:2,Name:e},d=new m(b,null,c,false,1,f|4);return new g(a,d)};b.createPropertyObject=function(g,a,d,c,f){var b={Id:a._context._nextId(),ObjectPathType:4,Name:d,ParentObjectPathId:a._objectPath.objectPathInfo.Id},e=new m(b,a._objectPath,c,false,1,f|4);return new g(a._context,e)};b.createIndexerObject=function(e,a,d){var b={Id:a._context._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:a._objectPath.objectPathInfo.Id,ArgumentInfo:{}};b.ArgumentInfo.Arguments=d;var c=new m(b,a._objectPath,false,false,1,4);return new e(a._context,c)};b.createMethodObject=function(n,a,j,h,l,i,d,g,k){var o=a._context._nextId(),c={Id:o,ObjectPathType:3,Name:j,ParentObjectPathId:a._objectPath.objectPathInfo.Id,ArgumentInfo:{}},e=f.setMethodArguments(a._context,c.ArgumentInfo,l),b=new m(c,a._objectPath,i,d,h,k);b.argumentObjectPaths=e;b.getByIdMethodName=g;var p=new n(a._context,b);return p};b.createAndInstantiateMethodObject=function(k,b,h,e,j,g,c,d,i){return a.createPromise(function(r,s){var l={Id:b._context._nextId(),ObjectPathType:3,Name:h,ParentObjectPathId:b._objectPath.objectPathInfo.Id,ArgumentInfo:{}},p=f.setMethodArguments(b._context,l.ArgumentInfo,j),a=new m(l,b._objectPath,g,c,e,i);a.argumentObjectPaths=p;a.getByIdMethodName=d;var t=new A,q={Id:b._context._nextId(),ActionType:1,Name:"",ObjectPathId:a.objectPathInfo.Id,QueryInfo:{}},o=new n(q,1,4);o.referencedObjectPath=a;b._context._addServiceApiAction(o,t,function(){return r(new k(b._context,a))},s)})};b.createTraceAction=function(b,c){return a.createPromise(function(d,f){var a={Id:b._nextId(),ActionType:5,Name:"Trace",ObjectPathId:0},e=new n(a,1,4),g=new db(c);b._addServiceApiAction(e,g,d,f)})};b.localDocumentContext=new F;return b}();c.OperationalApiHelper=H;var Q=function(){function b(c,b,a){this.eventId=c;this.targetId=b;this.eventArgumentTransform=a;this.registeredCallbacks=[]}b.prototype.add=function(a){this.hasZero()&&o.getGenericEventRegistration().register(this.eventId,this.targetId,this.registerCallback);this.registeredCallbacks.push(a)};b.prototype.remove=function(b){var a=this.registeredCallbacks.lastIndexOf(b);a!==-1&&this.registeredCallbacks.splice(a,1)};b.prototype.removeAll=function(){this.registeredCallbacks=[];o.getGenericEventRegistration().unregister(this.eventId,this.targetId,this.registerCallback)};b.prototype.hasZero=function(){return this.registeredCallbacks.length===0};Object.defineProperty(b.prototype,"registerCallback",{"get":function(){var a=this;if(!this.outsideCallback)this.outsideCallback=function(b){a.call(b)};return this.outsideCallback},enumerable:true,configurable:true});b.prototype.call=function(c){var d=this;this.eventArgumentTransform(c).then(function(c){var e=d.registeredCallbacks.map(function(a){return b.callCallback(a,c)});a.Promise.all(e)})};b.callCallback=function(d,c){return a._createPromiseFromResult(null).then(b.wrapCallbackInFunction(d,c)).catch(function(b){a.log("Error when invoke handler: "+JSON.stringify(b))})};b.wrapCallbackInFunction=function(a,b){return function(){return a(b)}};return b}();c.GenericEventRegistryOperational=Q;var E=function(){function a(){this.eventToTargetToHandlerMap={}}Object.defineProperty(a,"globalEventRegistry",{"get":function(){if(!a.singleton)a.singleton=new a;return a.singleton},enumerable:true,configurable:true});a.getGlobalEventRegistry=function(c,b,f){var g=a.globalEventRegistry,d=g.eventToTargetToHandlerMap;if(!d.hasOwnProperty(c))d[c]={};var e=d[c];if(!e.hasOwnProperty(b))e[b]=new Q(c,b,f);var h=e[b];return h};a.singleton=undefined;return a}();c.GlobalEventRegistryOperational=E;var Z=function(){function a(a){this.genericEventInfo=a}a.prototype.add=function(c){var a=this,b=function(){var d=a.genericEventInfo.eventType,b=a.genericEventInfo.getTargetIdFunc(),e=E.getGlobalEventRegistry(d,b,a.genericEventInfo.eventArgsTransformFunc);e.add(c)};this.register();this.createTrace(b)};a.prototype.remove=function(c){var a=this,b=function(){var d=a.genericEventInfo.eventType,b=a.genericEventInfo.getTargetIdFunc(),e=E.getGlobalEventRegistry(d,b,a.genericEventInfo.eventArgsTransformFunc);e.remove(c)};this.register();this.createTrace(b)};a.prototype.removeAll=function(){var a=this,b=function(){var c=a.genericEventInfo.eventType,b=a.genericEventInfo.getTargetIdFunc(),d=E.getGlobalEventRegistry(c,b,a.genericEventInfo.eventArgsTransformFunc);d.removeAll()};this.unregister();this.createTrace(b)};a.prototype.createTrace=function(a){H.createTraceAction(this.genericEventInfo.object._context,a)};a.prototype.register=function(){var a=0,c=[],b=0;H.invokeMethod(this.genericEventInfo.object,this.genericEventInfo.register,a,c,b);!o.getGenericEventRegistration().isReady&&o.getGenericEventRegistration().ready()};a.prototype.unregister=function(){H.invokeMethod(this.genericEventInfo.object,this.genericEventInfo.unregister)};return a}();c.GenericEventHandlerOperational=Z;var lb=function(){function b(){}b.invokeOn=function(b,c,d){b.add(c);return a._createPromiseFromResult({})};b.invokeOff=function(e,f,c,d){if(!c&&!d){var g=Object.keys(e).map(function(a){return e[a]});return b.invokeAllOff(g)}if(!c)return a._createPromiseFromException(c+" must be supplied if handler is supplied.");if(d)f.remove(d);else f.removeAll();return a.createPromise(function(a,b){return a()})};b.invokeAllOff=function(b){b.forEach(function(a){a.removeAll()});return a.createPromise(function(a,b){return a()})};return b}();c.EventHelper=lb;var D=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}a.propertyNotLoaded="PropertyNotLoaded";a.runMustReturnPromise="RunMustReturnPromise";a.cannotRegisterEvent="CannotRegisterEvent";a.invalidOrTimedOutSession="InvalidOrTimedOutSession";a.cannotUpdateReadOnlyProperty="CannotUpdateReadOnlyProperty";return a}(g);c.ErrorCodes=D;var bb=function(){function a(a){this.m_callback=a}a.prototype._handleResult=function(a){this.m_callback&&this.m_callback()};return a}(),q=function(c){__extends(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}a.createMethodAction=function(f,c,h,g,j,i){b.validateObjectPath(c);var e={Id:f._nextId(),ActionType:3,Name:h,ObjectPathId:c._objectPath.objectPathInfo.Id,ArgumentInfo:{}},d=b.setMethodArguments(f,e.ArgumentInfo,j);b.validateReferencedObjectPaths(d);var a=new n(e,g,b._fixupApiFlags(i));a.referencedObjectPath=c._objectPath;a.referencedArgumentObjectPaths=d;c._addAction(a);return a};a.createRecursiveQueryAction=function(e,a,f){b.validateObjectPath(a);var d={Id:e._nextId(),ActionType:6,Name:"",ObjectPathId:a._objectPath.objectPathInfo.Id,RecursiveQueryInfo:f},c=new n(d,1,4);c.referencedObjectPath=a._objectPath;a._addAction(c);return c};a.createEnsureUnchangedAction=function(f,a,d){b.validateObjectPath(a);var e={Id:f._nextId(),ActionType:8,Name:"",ObjectPathId:a._objectPath.objectPathInfo.Id,ObjectState:d},c=new n(e,1,4);c.referencedObjectPath=a._objectPath;a._addAction(c);return c};a.createInstantiateAction=function(c,a){b.validateObjectPath(a);c._pendingRequest.ensureInstantiateObjectPath(a._objectPath.parentObjectPath);c._pendingRequest.ensureInstantiateObjectPaths(a._objectPath.argumentObjectPaths);var e={Id:c._nextId(),ActionType:1,Name:"",ObjectPathId:a._objectPath.objectPathInfo.Id},d=new n(e,1,4);d.referencedObjectPath=a._objectPath;a._addAction(d,new ab(a),true);return d};a.createTraceAction=function(a,e,d){var b={Id:a._nextId(),ActionType:5,Name:"Trace",ObjectPathId:0},c=new n(b,1,4);a._pendingRequest.addAction(c);d&&a._pendingRequest.addTrace(b.Id,e);return c};a.createTraceMarkerForCallback=function(b,c){var d=a.createTraceAction(b,null,false);b._pendingRequest.addActionResultHandler(d,new bb(c))};return a}(v);c.ActionFactory=q;var t=function(e){__extends(c,e);function c(a,d){var c=e.call(this,a,d)||this;b.checkArgumentNull(a,"context");c.m_context=a;if(c._objectPath)if(!a._processingResult&&a._pendingRequest){q.createInstantiateAction(a,c);a._autoCleanup&&c._KeepReference&&a.trackedObjects._autoAdd(c)}return c}Object.defineProperty(c.prototype,"context",{"get":function(){return this.m_context},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"isNull",{"get":function(){if(typeof this.m_isNull==="undefined"&&C.isMock())return false;b.throwIfNotLoaded("isNull",this._isNull,null,this._isNull);return this._isNull},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"isNullObject",{"get":function(){if(typeof this.m_isNull==="undefined"&&C.isMock())return false;b.throwIfNotLoaded("isNullObject",this._isNull,null,this._isNull);return this._isNull},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"_isNull",{"get":function(){return this.m_isNull},"set":function(a){this.m_isNull=a;a&&this._objectPath&&this._objectPath._updateAsNullObject()},enumerable:true,configurable:true});c.prototype._addAction=function(b,c,d){if(c===void 0)c=null;if(!d){this.context._pendingRequest.ensureInstantiateObjectPath(this._objectPath);this.context._pendingRequest.ensureInstantiateObjectPaths(b.referencedArgumentObjectPaths)}this.context._pendingRequest.addAction(b);this.context._pendingRequest.addReferencedObjectPath(this._objectPath);this.context._pendingRequest.addReferencedObjectPaths(b.referencedArgumentObjectPaths);this.context._pendingRequest.addActionResultHandler(b,c);return a._createPromiseFromResult(null)};c.prototype._handleResult=function(a){this._isNull=b.isNullOrUndefined(a);this.context.trackedObjects._autoTrackIfNecessaryWhenHandleObjectResultValue(this,a)};c.prototype._handleIdResult=function(a){this._isNull=b.isNullOrUndefined(a);b.fixObjectPathIfNecessary(this,a);this.context.trackedObjects._autoTrackIfNecessaryWhenHandleObjectResultValue(this,a)};c.prototype._handleRetrieveResult=function(a,b){this._handleIdResult(a)};c.prototype._recursivelySet=function(f,n,k,l,o){var m=f instanceof c,s=f;if(m)if(Object.getPrototypeOf(this)===Object.getPrototypeOf(f))f=JSON.parse(JSON.stringify(f));else throw d.RuntimeError._createInvalidArgError({argumentName:"properties",errorLocation:this._className+".set"});try{for(var e,h=0;h<k.length;h++){e=k[h];if(f.hasOwnProperty(e))if(typeof f[e]!=="undefined")this[e]=f[e]}for(var h=0;h<l.length;h++){e=l[h];if(f.hasOwnProperty(e))if(typeof f[e]!=="undefined"){var q=m?s[e]:f[e];this[e].set(q,n)}}var j=!m;if(n&&!b.isNullOrUndefined(j))j=n.throwOnReadOnly;for(var h=0;h<o.length;h++){e=o[h];if(f.hasOwnProperty(e))if(typeof f[e]!=="undefined"&&j)throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(r.cannotApplyPropertyThroughSetMethod,e),debugInfo:{errorLocation:e}});}for(e in f)if(k.indexOf(e)<0&&l.indexOf(e)<0){var p=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),e);if(!p)throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(y.propertyDoesNotExist,e),debugInfo:{errorLocation:e}});if(j&&!p.set)throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(y.attemptingToSetReadOnlyProperty,e),debugInfo:{errorLocation:e}});}}catch(t){throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(i.invalidArgument,"properties"),debugInfo:{errorLocation:this._className+".set"},innerError:t});}};return c}(B);c.ClientObject=t;var cb=function(){function b(a){this.m_session=a}b.prototype.executeAsync=function(f,e,b){var d={url:l.processQuery,method:"POST",headers:b.Headers,body:b.Body},c={id:x.nextId(),type:1,flags:e,message:d};a.log(JSON.stringify(c));return this.m_session.sendMessageToHost(c).then(function(d){a.log("Received response: "+JSON.stringify(d));var b=d.message,c;if(b.statusCode===200)c={ErrorCode:null,ErrorMessage:null,Headers:b.headers,Body:a._parseResponseBody(b)};else{a.log("Error Response:"+b.body);var e=a._parseErrorResponse(b);c={ErrorCode:e.errorCode,ErrorMessage:e.errorMessage,Headers:b.headers,Body:null}}return c})};return b}(),O=function(c){__extends(b,c);function b(b){var a=c.call(this)||this;a.m_bridge=b;a.m_bridge.addHostMessageHandler(function(a){a.type===3&&o.getGenericEventRegistration()._handleRichApiMessage(a.message)});return a}b.getInstanceIfHostBridgeInited=function(){if(x.instance){if(a.isNullOrUndefined(b.s_instance)||b.s_instance.m_bridge!==x.instance)b.s_instance=new b(x.instance);return b.s_instance}return null};b.prototype._resolveRequestUrlAndHeaderInfo=function(){return a._createPromiseFromResult(null)};b.prototype._createRequestExecutorOrNull=function(){a.log("NativeBridgeSession::CreateRequestExecutor");return new cb(this)};Object.defineProperty(b.prototype,"eventRegistration",{"get":function(){return o.getGenericEventRegistration()},enumerable:true,configurable:true});b.prototype.sendMessageToHost=function(a){return this.m_bridge.sendMessageToHostAndExpectResponse(a)};return b}(u);c.HostBridgeSession=O;var gb=function(h){__extends(f,h);function f(g){var c=h.call(this)||this;c.m_customRequestHeaders={};c.m_batchMode=0;c._onRunFinishedNotifiers=[];if(u._overrideSession)c.m_requestUrlAndHeaderInfoResolver=u._overrideSession;else{if(b.isNullOrUndefined(g)||typeof g==="string"&&g.length===0){g=f.defaultRequestUrlAndHeaders;if(!g)g={url:l.localDocument,headers:{}}}if(typeof g==="string")c.m_requestUrlAndHeaderInfo={url:g,headers:{}};else if(f.isRequestUrlAndHeaderInfoResolver(g))c.m_requestUrlAndHeaderInfoResolver=g;else if(f.isRequestUrlAndHeaderInfo(g)){var i=g;c.m_requestUrlAndHeaderInfo={url:i.url,headers:{}};a._copyHeaders(i.headers,c.m_requestUrlAndHeaderInfo.headers)}else throw d.RuntimeError._createInvalidArgError({argumentName:"url"});}if(!c.m_requestUrlAndHeaderInfoResolver&&c.m_requestUrlAndHeaderInfo&&a._isLocalDocumentUrl(c.m_requestUrlAndHeaderInfo.url)&&O.getInstanceIfHostBridgeInited()){c.m_requestUrlAndHeaderInfo=null;c.m_requestUrlAndHeaderInfoResolver=O.getInstanceIfHostBridgeInited()}if(c.m_requestUrlAndHeaderInfoResolver instanceof u)c.m_session=c.m_requestUrlAndHeaderInfoResolver;c._processingResult=false;c._customData=e.iterativeExecutor;c.sync=c.sync.bind(c);return c}Object.defineProperty(f.prototype,"session",{"get":function(){return this.m_session},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"eventRegistration",{"get":function(){if(this.m_session)return this.m_session.eventRegistration;return d.officeJsEventRegistration},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"_url",{"get":function(){if(this.m_requestUrlAndHeaderInfo)return this.m_requestUrlAndHeaderInfo.url;return null},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"_pendingRequest",{"get":function(){if(this.m_pendingRequest==null)this.m_pendingRequest=new z(this);return this.m_pendingRequest},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"debugInfo",{"get":function(){var a=new J(this._rootObjectPropertyName,this._pendingRequest._objectPaths,this._pendingRequest._actions,c._internalConfig.showDisposeInfoInDebugInfo),b=a.process();return{pendingStatements:b}},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"trackedObjects",{"get":function(){if(!this.m_trackedObjects)this.m_trackedObjects=new U(this);return this.m_trackedObjects},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"requestHeaders",{"get":function(){return this.m_customRequestHeaders},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"batchMode",{"get":function(){return this.m_batchMode},enumerable:true,configurable:true});f.prototype.ensureInProgressBatchIfBatchMode=function(){if(this.m_batchMode===1&&!this.m_explicitBatchInProgress)throw b.createRuntimeError(g.generalException,a._getResourceString(r.notInsideBatch),null);};f.prototype.load=function(a,d){b.validateContext(this,a);var c=f._parseQueryOption(d);v.createQueryAction(this,a,c,a)};f.prototype.loadRecursive=function(c,a,h){if(!b.isPlainJsonObject(a))throw d.RuntimeError._createInvalidArgError({argumentName:"options"});var e={};for(var g in a)e[g]=f._parseQueryOption(a[g]);var i=q.createRecursiveQueryAction(this,c,{Queries:e,MaxDepth:h});this._pendingRequest.addActionResultHandler(i,c)};f.prototype.trace=function(a){q.createTraceAction(this,a,true)};f.prototype._processOfficeJsErrorResponse=function(a,b){};f.prototype.ensureRequestUrlAndHeaderInfo=function(){var a=this;return b._createPromiseFromResult(null).then(function(){if(!a.m_requestUrlAndHeaderInfo)return a.m_requestUrlAndHeaderInfoResolver._resolveRequestUrlAndHeaderInfo().then(function(d){a.m_requestUrlAndHeaderInfo=d;if(!a.m_requestUrlAndHeaderInfo)a.m_requestUrlAndHeaderInfo={url:l.localDocument,headers:{}};if(b.isNullOrEmptyString(a.m_requestUrlAndHeaderInfo.url))a.m_requestUrlAndHeaderInfo.url=l.localDocument;if(!a.m_requestUrlAndHeaderInfo.headers)a.m_requestUrlAndHeaderInfo.headers={};if(typeof a.m_requestUrlAndHeaderInfoResolver._createRequestExecutorOrNull==="function"){var c=a.m_requestUrlAndHeaderInfoResolver._createRequestExecutorOrNull();if(c)a._requestExecutor=c}})})};f.prototype.syncPrivateMain=function(){var a=this;return this.ensureRequestUrlAndHeaderInfo().then(function(){var b=a._pendingRequest;a.m_pendingRequest=null;return a.processPreSyncPromises(b).then(function(){return a.syncPrivate(b)})})};f.prototype.syncPrivate=function(f){var j=this;if(C.isMock())return a._createPromiseFromResult(null);if(!f.hasActions)return this.processPendingEventHandlers(f);var k=f.buildRequestMessageBodyAndRequestFlags(),n=k.body,h=k.flags;if(this._requestFlagModifier)h|=this._requestFlagModifier;if(!this._requestExecutor)if(a._isLocalDocumentUrl(this.m_requestUrlAndHeaderInfo.url))this._requestExecutor=new fb(this);else this._requestExecutor=new K;var m=this._requestExecutor,i={};a._copyHeaders(this.m_requestUrlAndHeaderInfo.headers,i);a._copyHeaders(this.m_customRequestHeaders,i);delete this.m_customRequestHeaders[e.officeScriptEventId];var l={Url:this.m_requestUrlAndHeaderInfo.url,Headers:i,Body:n};f.invalidatePendingInvalidObjectPaths();var g=null,c=null;this._lastSyncStart=typeof performance==="undefined"?0:performance.now();this._lastRequestFlags=h;return m.executeAsync(this._customData,h,l).then(function(b){j._lastSyncEnd=typeof performance==="undefined"?0:performance.now();g=j.processRequestExecutorResponseMessage(f,b);return j.processPendingEventHandlers(f).catch(function(b){a.log("Error in processPendingEventHandlers");a.log(JSON.stringify(b));c=b})}).then(function(){if(g){a.log("Throw error from response: "+JSON.stringify(g));throw g;}if(c){a.log("Throw error from ProcessEventHandler: "+JSON.stringify(c));var h=null;if(c instanceof d.RuntimeError){h=c;h.traceMessages=f._responseTraceMessages}else{var e=null;if(typeof c==="string")e=c;else e=c.message;if(b.isNullOrEmptyString(e))e=a._getResourceString(r.cannotRegisterEvent);h=new d.RuntimeError({code:D.cannotRegisterEvent,message:e,traceMessages:f._responseTraceMessages})}throw h;}})};f.prototype.processRequestExecutorResponseMessage=function(e,a){a.Body&&a.Body.TraceIds&&e._setResponseTraceIds(a.Body.TraceIds);var k=e._responseTraceMessages,f=null;if(a.Body){if(a.Body.Error&&a.Body.Error.ActionIndex>=0){var i=new J(this._rootObjectPropertyName,e._objectPaths,e._actions,false,true),j=i.processForDebugStatementInfo(a.Body.Error.ActionIndex);f={statement:j.statement,surroundingStatements:j.surroundingStatements,fullStatements:["Please enable config.extendedErrorLogging to see full statements."]};if(c.config.extendedErrorLogging){i=new J(this._rootObjectPropertyName,e._objectPaths,e._actions,false,false);f.fullStatements=i.process()}}var g=null;if(a.Body.Results)g=a.Body.Results;else if(a.Body.ProcessedResults&&a.Body.ProcessedResults.Results)g=a.Body.ProcessedResults.Results;if(g){this._processingResult=true;try{e.processResponse(g)}finally{this._processingResult=false}}}if(!b.isNullOrEmptyString(a.ErrorCode))return new d.RuntimeError({code:a.ErrorCode,message:a.ErrorMessage,traceMessages:k});else if(a.Body&&a.Body.Error){var h={errorLocation:a.Body.Error.Location};if(f){h.statement=f.statement;h.surroundingStatements=f.surroundingStatements;h.fullStatements=f.fullStatements}return new d.RuntimeError({code:a.Body.Error.Code,message:a.Body.Error.Message,traceMessages:k,debugInfo:h})}return null};f.prototype.processPendingEventHandlers=function(a){for(var c=b._createPromiseFromResult(null),d=0;d<a._pendingProcessEventHandlers.length;d++){var e=a._pendingProcessEventHandlers[d];c=c.then(this.createProcessOneEventHandlersFunc(e,a))}return c};f.prototype.createProcessOneEventHandlersFunc=function(a,b){return function(){return a._processRegistration(b)}};f.prototype.processPreSyncPromises=function(d){for(var a=b._createPromiseFromResult(null),c=0;c<d._preSyncPromises.length;c++){var e=d._preSyncPromises[c];a=a.then(this.createProcessOneProSyncFunc(e))}return a};f.prototype.createProcessOneProSyncFunc=function(a){return function(){return a}};f.prototype.sync=function(b){if(C.isMock())return a._createPromiseFromResult(b);return this.syncPrivateMain().then(function(){return b})};f.prototype.batch=function(i){var c=this;if(this.m_batchMode!==1)return a._createPromiseFromException(b.createRuntimeError(g.generalException,null,null));if(this.m_explicitBatchInProgress)return a._createPromiseFromException(b.createRuntimeError(g.generalException,a._getResourceString(r.pendingBatchInProgress),null));if(b.isNullOrUndefined(i))return b._createPromiseFromResult(null);this.m_explicitBatchInProgress=true;var e=this.m_pendingRequest;this.m_pendingRequest=new z(this);var d;try{d=i(this._rootObject,this)}catch(j){this.m_explicitBatchInProgress=false;this.m_pendingRequest=e;return a._createPromiseFromException(j)}var f,h;if(typeof d==="object"&&d&&typeof d.then==="function")h=b._createPromiseFromResult(null).then(function(){return d}).then(function(a){c.m_explicitBatchInProgress=false;f=c.m_pendingRequest;c.m_pendingRequest=e;return a}).catch(function(b){c.m_explicitBatchInProgress=false;f=c.m_pendingRequest;c.m_pendingRequest=e;return a._createPromiseFromException(b)});else{this.m_explicitBatchInProgress=false;f=this.m_pendingRequest;this.m_pendingRequest=e;h=b._createPromiseFromResult(d)}return h.then(function(a){return c.ensureRequestUrlAndHeaderInfo().then(function(){return c.syncPrivate(f)}).then(function(){return a})})};f._run=function(e,g,a,b,d,c){if(a===void 0)a=3;if(b===void 0)b=5e3;return f._runCommon("run",null,e,0,g,a,b,null,d,c)};f.isValidRequestInfo=function(a){return typeof a==="string"||f.isRequestUrlAndHeaderInfo(a)||f.isRequestUrlAndHeaderInfoResolver(a)};f.isRequestUrlAndHeaderInfo=function(a){return typeof a==="object"&&a!==null&&Object.getPrototypeOf(a)===Object.getPrototypeOf({})&&!b.isNullOrUndefined(a.url)};f.isRequestUrlAndHeaderInfoResolver=function(a){return typeof a==="object"&&a!==null&&typeof a._resolveRequestUrlAndHeaderInfo==="function"};f._runBatch=function(h,e,g,i,a,b,d,c){if(a===void 0)a=3;if(b===void 0)b=5e3;return f._runBatchCommon(0,h,e,g,a,b,i,d,c)};f._runExplicitBatch=function(h,e,g,i,a,b,d,c){if(a===void 0)a=3;if(b===void 0)b=5e3;return f._runBatchCommon(1,h,e,g,a,b,i,d,c)};f._runBatchCommon=function(v,d,a,u,l,m,p,s,q){if(l===void 0)l=3;if(m===void 0)m=5e3;var h,n,i=null,c=null,e=0,j=null;if(a.length>0)if(f.isValidRequestInfo(a[0])){i=a[0];e=1}else if(b.isPlainJsonObject(a[0])){j=a[0];i=j.session;if(i!=null&&!f.isValidRequestInfo(i))return f.createErrorPromise(d);c=j.previousObjects;e=1}if(a.length==e+1)n=a[e+0];else if(j==null&&a.length==e+2){c=a[e+0];n=a[e+1]}else return f.createErrorPromise(d);if(c!=null)if(c instanceof t)h=function(){return c.context};else if(c instanceof f)h=function(){return c};else if(Array.isArray(c)){var g=c;if(g.length==0)return f.createErrorPromise(d);for(var k=0;k<g.length;k++){if(!(g[k]instanceof t))return f.createErrorPromise(d);if(g[k].context!=g[0].context)return f.createErrorPromise(d,r.invalidRequestContext)}h=function(){return g[0].context}}else return f.createErrorPromise(d);else h=u;var o=null;if(p)o=function(a){return p(j||{},a)};return f._runCommon(d,i,h,v,n,l,m,o,s,q)};f.createErrorPromise=function(d,c){if(c===void 0)c=i.invalidArgument;return a._createPromiseFromException(b.createRuntimeError(c,a._getResourceString(c),d))};f._runCommon=function(s,g,q,h,i,o,t,m,l,k){if(u._overrideSession)g=u._overrideSession;var p=a.createPromise(function(a,b){a()}),d,n=false,e,j;return p.then(function(){d=q(g);if(d._autoCleanup)return new c.Promise(function(a,b){d._onRunFinishedNotifiers.push(function(){d._autoCleanup=true;a()})});else d._autoCleanup=true}).then(function(){if(typeof i!=="function")return f.createErrorPromise(s);j=d.m_batchMode;d.m_batchMode=h;m&&m(d);var a;if(h==1)a=i(d.batch.bind(d));else a=i(d);(b.isNullOrUndefined(a)||typeof a.then!=="function")&&b.throwError(r.runMustReturnPromise);return a}).then(function(a){if(h===1)return a;else return d.sync(a)}).then(function(a){n=true;e=a}).catch(function(a){e=a}).then(function(){var c=d.trackedObjects._retrieveAndClearAutoCleanupList();d._autoCleanup=false;d.m_batchMode=j;for(var h in c)c[h]._objectPath.isValid=false;var a=0;if(b._synchronousCleanup||f.isRequestUrlAndHeaderInfoResolver(g))return e();else e();function e(){a++;var f=d.m_pendingRequest,g=d.m_batchMode,b=new z(d);d.m_pendingRequest=b;d.m_batchMode=0;try{for(var h in c)d.trackedObjects.remove(c[h])}finally{d.m_batchMode=g;d.m_pendingRequest=f}return d.syncPrivate(b).then(function(){l&&l(a)}).catch(function(){k&&k(a);a<o&&setTimeout(function(){e()},t)})}}).then(function(){if(d._onRunFinishedNotifiers&&d._onRunFinishedNotifiers.length>0){var a=d._onRunFinishedNotifiers.shift();a()}if(n)return e;else throw e;})};return f}(F);c.ClientRequestContext=gb;var hb=function(){function c(c,h){this.m_proxy=c;this.m_shouldPolyfill=h;var f=c[e.scalarPropertyNames],d=c[e.navigationPropertyNames],g=c[e.className],i=c[e.isCollection];if(f)for(var a=0;a<f.length;a++)b.definePropertyThrowUnloadedException(this,g,f[a]);if(d)for(var a=0;a<d.length;a++)b.definePropertyThrowUnloadedException(this,g,d[a]);i&&b.definePropertyThrowUnloadedException(this,g,e.itemsLowerCase)}Object.defineProperty(c.prototype,"$proxy",{"get":function(){return this.m_proxy},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"$isNullObject",{"get":function(){if(!this.m_isLoaded)throw new d.RuntimeError({code:D.valueNotLoaded,message:a._getResourceString(r.valueNotLoaded),debugInfo:{errorLocation:"retrieveResult.$isNullObject"}});return this.m_isNullObject},enumerable:true,configurable:true});c.prototype.toJSON=function(){if(!this.m_isLoaded)return undefined;if(this.m_isNullObject)return null;if(b.isUndefined(this.m_json))this.m_json=b.purifyJson(this.m_value);return this.m_json};c.prototype.toString=function(){return JSON.stringify(this.toJSON())};c.prototype._handleResult=function(a){this.m_isLoaded=true;if(a===null||typeof a==="object"&&a&&a._IsNull){this.m_isNullObject=true;a=null}else this.m_isNullObject=false;if(this.m_shouldPolyfill)a=b.changePropertyNameToCamelLowerCase(a);this.m_value=a;this.m_proxy._handleRetrieveResult(a,this)};return c}(),e=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}a.getItemAt="GetItemAt";a.index="_Index";a.iterativeExecutor="IterativeExecutor";a.isTracked="_IsTracked";a.eventMessageCategory=65536;a.eventWorkbookId="Workbook";a.eventSourceRemote="Remote";a.proxy="$proxy";a.className="_className";a.isCollection="_isCollection";a.collectionPropertyPath="_collectionPropertyPath";a.objectPathInfoDoNotKeepReferenceFieldName="D";a.officeScriptEventId="X-OfficeScriptEventId";return a}(j);c.Constants=e;var z=function(c){__extends(b,c);function b(b){var a=c.call(this,b)||this;a.m_context=b;a.m_pendingProcessEventHandlers=[];a.m_pendingEventHandlerActions={};a.m_traceInfos={};a.m_responseTraceIds={};a.m_responseTraceMessages=[];return a}Object.defineProperty(b.prototype,"traceInfos",{"get":function(){return this.m_traceInfos},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_responseTraceMessages",{"get":function(){return this.m_responseTraceMessages},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_responseTraceIds",{"get":function(){return this.m_responseTraceIds},enumerable:true,configurable:true});b.prototype._setResponseTraceIds=function(c){if(c)for(var d=0;d<c.length;d++){var b=c[d];this.m_responseTraceIds[b]=b;var e=this.m_traceInfos[b];!a.isNullOrUndefined(e)&&this.m_responseTraceMessages.push(e)}};b.prototype.addTrace=function(a,b){this.m_traceInfos[a]=b};b.prototype._addPendingEventHandlerAction=function(a,b){if(!this.m_pendingEventHandlerActions[a._id]){this.m_pendingEventHandlerActions[a._id]=[];this.m_pendingProcessEventHandlers.push(a)}this.m_pendingEventHandlerActions[a._id].push(b)};Object.defineProperty(b.prototype,"_pendingProcessEventHandlers",{"get":function(){return this.m_pendingProcessEventHandlers},enumerable:true,configurable:true});b.prototype._getPendingEventHandlerActions=function(a){return this.m_pendingEventHandlerActions[a._id]};return b}(M);c.ClientRequest=z;var P=function(){function b(a,e,d,c){var b=this;this.m_id=a._nextId();this.m_context=a;this.m_name=d;this.m_handlers=[];this.m_registered=false;this.m_eventInfo=c;this.m_callback=function(a){b.m_eventInfo.eventArgsTransformFunc(a).then(function(a){return b.fireEvent(a)})}}Object.defineProperty(b.prototype,"_registered",{"get":function(){return this.m_registered},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_id",{"get":function(){return this.m_id},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_handlers",{"get":function(){return this.m_handlers},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_context",{"get":function(){return this.m_context},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_callback",{"get":function(){return this.m_callback},enumerable:true,configurable:true});b.prototype.add=function(a){var b=q.createTraceAction(this.m_context,null,false);this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:b.actionInfo.Id,handler:a,operation:0});return new L(this.m_context,this,a)};b.prototype.remove=function(a){var b=q.createTraceAction(this.m_context,null,false);this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:b.actionInfo.Id,handler:a,operation:1})};b.prototype.removeAll=function(){var a=q.createTraceAction(this.m_context,null,false);this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:a.actionInfo.Id,handler:null,operation:2})};b.prototype._processRegistration=function(i){var e=this,d=a._createPromiseFromResult(null),f=i._getPendingEventHandlerActions(this);if(!f)return d;for(var b=[],c=0;c<this.m_handlers.length;c++)b.push(this.m_handlers[c]);for(var h=false,c=0;c<f.length;c++)if(i._responseTraceIds[f[c].id]){h=true;switch(f[c].operation){case 0:b.push(f[c].handler);break;case 1:for(var g=b.length-1;g>=0;g--)if(b[g]===f[c].handler){b.splice(g,1);break}break;case 2:b=[];break}}if(h){if(!this.m_registered&&b.length>0)d=d.then(function(){return e.m_eventInfo.registerFunc(e.m_callback)}).then(function(){return e.m_registered=true});else if(this.m_registered&&b.length==0)d=d.then(function(){return e.m_eventInfo.unregisterFunc(e.m_callback)}).catch(function(b){a.log("Error when unregister event: "+JSON.stringify(b))}).then(function(){return e.m_registered=false});d=d.then(function(){return e.m_handlers=b})}return d};b.prototype.fireEvent=function(e){for(var c=[],b=0;b<this.m_handlers.length;b++){var d=this.m_handlers[b],f=a._createPromiseFromResult(null).then(this.createFireOneEventHandlerFunc(d,e)).catch(function(b){a.log("Error when invoke handler: "+JSON.stringify(b))});c.push(f)}a.Promise.all(c)};b.prototype.createFireOneEventHandlerFunc=function(a,b){return function(){return a(b)}};return b}();c.EventHandlers=P;var L=function(){function a(b,a,c){this.m_context=b;this.m_allHandlers=a;this.m_handler=c}Object.defineProperty(a.prototype,"context",{"get":function(){return this.m_context},enumerable:true,configurable:true});a.prototype.remove=function(){if(this.m_allHandlers&&this.m_handler){this.m_allHandlers.remove(this.m_handler);this.m_allHandlers=null;this.m_handler=null}};return a}();c.EventHandlerResult=L;(function(a){var c=function(){function c(){}c.prototype.register=function(e,d,c){switch(e){case 4:return b.promisify(function(a){return Office.context.document.bindings.getByIdAsync(d,a)}).then(function(a){return b.promisify(function(b){return a.addHandlerAsync(Office.EventType.BindingDataChanged,c,b)})});case 3:return b.promisify(function(a){return Office.context.document.bindings.getByIdAsync(d,a)}).then(function(a){return b.promisify(function(b){return a.addHandlerAsync(Office.EventType.BindingSelectionChanged,c,b)})});case 2:return b.promisify(function(a){return Office.context.document.addHandlerAsync(Office.EventType.DocumentSelectionChanged,c,a)});case 1:return b.promisify(function(a){return Office.context.document.settings.addHandlerAsync(Office.EventType.SettingsChanged,c,a)});case 5:return b.promisify(function(a){return OSF.DDA.RichApi.richApiMessageManager.addHandlerAsync("richApiMessage",c,a)});case 13:return b.promisify(function(a){return Office.context.document.addHandlerAsync(Office.EventType.ObjectDeleted,c,{id:d},a)});case 14:return b.promisify(function(a){return Office.context.document.addHandlerAsync(Office.EventType.ObjectSelectionChanged,c,{id:d},a)});case 15:return b.promisify(function(a){return Office.context.document.addHandlerAsync(Office.EventType.ObjectDataChanged,c,{id:d},a)});case 16:return b.promisify(function(a){return Office.context.document.addHandlerAsync(Office.EventType.ContentControlAdded,c,{id:d},a)});default:throw a.RuntimeError._createInvalidArgError({argumentName:"eventId"});}};c.prototype.unregister=function(e,d,c){switch(e){case 4:return b.promisify(function(a){return Office.context.document.bindings.getByIdAsync(d,a)}).then(function(a){return b.promisify(function(b){return a.removeHandlerAsync(Office.EventType.BindingDataChanged,{handler:c},b)})});case 3:return b.promisify(function(a){return Office.context.document.bindings.getByIdAsync(d,a)}).then(function(a){return b.promisify(function(b){return a.removeHandlerAsync(Office.EventType.BindingSelectionChanged,{handler:c},b)})});case 2:return b.promisify(function(a){return Office.context.document.removeHandlerAsync(Office.EventType.DocumentSelectionChanged,{handler:c},a)});case 1:return b.promisify(function(a){return Office.context.document.settings.removeHandlerAsync(Office.EventType.SettingsChanged,{handler:c},a)});case 5:return b.promisify(function(a){return OSF.DDA.RichApi.richApiMessageManager.removeHandlerAsync("richApiMessage",{handler:c},a)});case 13:return b.promisify(function(a){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectDeleted,{id:d,handler:c},a)});case 14:return b.promisify(function(a){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectSelectionChanged,{id:d,handler:c},a)});case 15:return b.promisify(function(a){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectDataChanged,{id:d,handler:c},a)});case 16:return b.promisify(function(a){return Office.context.document.removeHandlerAsync(Office.EventType.ContentControlAdded,{id:d,handler:c},a)});default:throw a.RuntimeError._createInvalidArgError({argumentName:"eventId"});}};return c}();a.officeJsEventRegistration=new c})(d=c._Internal||(c._Internal={}));var N=function(){function a(b,a){this.m_handlersByEventByTarget={};this.m_registerEventImpl=b;this.m_unregisterEventImpl=a}a.getTargetIdOrDefault=function(a){if(b.isNullOrUndefined(a))return"";return a};a.prototype.getHandlers=function(e,d){d=a.getTargetIdOrDefault(d);var b=this.m_handlersByEventByTarget[e];if(!b){b={};this.m_handlersByEventByTarget[e]=b}var c=b[d];if(!c){c=[];b[d]=c}return c};a.prototype.callHandlers=function(e,d,c){for(var b=this.getHandlers(e,d),a=0;a<b.length;a++)b[a](c)};a.prototype.hasHandlers=function(b,a){return this.getHandlers(b,a).length>0};a.prototype.register=function(e,c,f){if(!f)throw d.RuntimeError._createInvalidArgError({argumentName:"handler"});var a=this.getHandlers(e,c);a.push(f);if(a.length===1)return this.m_registerEventImpl(e,c);return b._createPromiseFromResult(null)};a.prototype.unregister=function(f,e,g){if(!g)throw d.RuntimeError._createInvalidArgError({argumentName:"handler"});for(var a=this.getHandlers(f,e),c=a.length-1;c>=0;c--)if(a[c]===g){a.splice(c,1);break}if(a.length===0)return this.m_unregisterEventImpl(f,e);return b._createPromiseFromResult(null)};return a}();c.EventRegistration=N;var o=function(){function c(){this.m_eventRegistration=new N(this._registerEventImpl.bind(this),this._unregisterEventImpl.bind(this));this.m_richApiMessageHandler=this._handleRichApiMessage.bind(this)}c.prototype.ready=function(){var a=this;if(!this.m_ready)if(c._testReadyImpl)this.m_ready=c._testReadyImpl().then(function(){a.m_isReady=true});else if(x.instance)this.m_ready=b._createPromiseFromResult(null).then(function(){a.m_isReady=true});else this.m_ready=d.officeJsEventRegistration.register(5,"",this.m_richApiMessageHandler).then(function(){a.m_isReady=true});return this.m_ready};Object.defineProperty(c.prototype,"isReady",{"get":function(){return this.m_isReady},enumerable:true,configurable:true});c.prototype.register=function(b,a,c){var d=this;return this.ready().then(function(){return d.m_eventRegistration.register(b,a,c)})};c.prototype.unregister=function(b,a,c){var d=this;return this.ready().then(function(){return d.m_eventRegistration.unregister(b,a,c)})};c.prototype._registerEventImpl=function(c,a){return b._createPromiseFromResult(null)};c.prototype._unregisterEventImpl=function(c,a){return b._createPromiseFromResult(null)};c.prototype._handleRichApiMessage=function(c){if(c&&c.entries)for(var d=0;d<c.entries.length;d++){var b=c.entries[d];if(b.messageCategory==e.eventMessageCategory){a._logEnabled&&a.log(JSON.stringify(b));var g=b.messageType,f=b.targetId,i=this.m_eventRegistration.hasHandlers(g,f);if(i){var h=JSON.parse(b.message);if(b.isRemoteOverride)h.source=e.eventSourceRemote;this.m_eventRegistration.callHandlers(g,f,h)}}}};c.getGenericEventRegistration=function(){if(!c.s_genericEventRegistration)c.s_genericEventRegistration=new c;return c.s_genericEventRegistration};c.richApiMessageEventCategory=65536;return c}();c.GenericEventRegistration=o;function X(a){o._testReadyImpl=a}c._testSetRichApiMessageReadyImpl=X;function Y(a){o.getGenericEventRegistration()._handleRichApiMessage(a)}c._testTriggerRichApiMessageEvent=Y;var T=function(b){__extends(a,b);function a(e,d,f,a){var c=b.call(this,e,d,f,a)||this;c.m_genericEventInfo=a;return c}a.prototype.add=function(b){var a=this;this._handlers.length==0&&this.m_genericEventInfo.registerFunc&&this.m_genericEventInfo.registerFunc();!o.getGenericEventRegistration().isReady&&this._context._pendingRequest._addPreSyncPromise(o.getGenericEventRegistration().ready());q.createTraceMarkerForCallback(this._context,function(){a._handlers.push(b);a._handlers.length==1&&o.getGenericEventRegistration().register(a.m_genericEventInfo.eventType,a.m_genericEventInfo.getTargetIdFunc(),a._callback)});return new L(this._context,this,b)};a.prototype.remove=function(b){var a=this;this._handlers.length==1&&this.m_genericEventInfo.unregisterFunc&&this.m_genericEventInfo.unregisterFunc();q.createTraceMarkerForCallback(this._context,function(){for(var c=a._handlers,d=c.length-1;d>=0;d--)if(c[d]===b){c.splice(d,1);break}c.length==0&&o.getGenericEventRegistration().unregister(a.m_genericEventInfo.eventType,a.m_genericEventInfo.getTargetIdFunc(),a._callback)})};a.prototype.removeAll=function(){};return a}(P);c.GenericEventHandlers=T;var ab=function(){function a(a){this.m_clientObject=a}a.prototype._handleResult=function(a){this.m_clientObject._handleIdResult(a)};return a}(),s=function(){function a(){}a.createGlobalObjectObjectPath=function(b){var a={Id:b._nextId(),ObjectPathType:1,Name:""};return new m(a,null,false,false,1,4)};a.createNewObjectObjectPath=function(e,d,c,f){var a={Id:e._nextId(),ObjectPathType:2,Name:d},g=new m(a,null,c,false,1,b._fixupApiFlags(f));return g};a.createPropertyObjectPath=function(g,a,f,e,c,h){var d={Id:g._nextId(),ObjectPathType:4,Name:f,ParentObjectPathId:a._objectPath.objectPathInfo.Id},i=new m(d,a._objectPath,e,c,1,b._fixupApiFlags(h));return i};a.createIndexerObjectPath=function(c,b,d){var a={Id:c._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:b._objectPath.objectPathInfo.Id,ArgumentInfo:{}};a.ArgumentInfo.Arguments=d;return new m(a,b._objectPath,false,false,1,4)};a.createIndexerObjectPathUsingParentPath=function(c,a,d){var b={Id:c._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:a.objectPathInfo.Id,ArgumentInfo:{}};b.ArgumentInfo.Arguments=d;return new m(b,a,false,false,1,4)};a.createMethodObjectPath=function(d,e,k,i,n,j,f,h,l){var c={Id:d._nextId(),ObjectPathType:3,Name:k,ParentObjectPathId:e._objectPath.objectPathInfo.Id,ArgumentInfo:{}},g=b.setMethodArguments(d,c.ArgumentInfo,n),a=new m(c,e._objectPath,j,f,i,b._fixupApiFlags(l));a.argumentObjectPaths=g;a.getByIdMethodName=h;return a};a.createReferenceIdObjectPath=function(c,b){var a={Id:c._nextId(),ObjectPathType:6,Name:b,ArgumentInfo:{}},d=new m(a,null,false,false,1,4);return d};a.createChildItemObjectPathUsingIndexerOrGetItemAt=function(f,d,e,c,g){var h=b.tryGetObjectIdFromLoadOrRetrieveResult(c);if(f&&!b.isNullOrUndefined(h))return a.createChildItemObjectPathUsingIndexer(d,e,c);else return a.createChildItemObjectPathUsingGetItemAt(d,e,c,g)};a.createChildItemObjectPathUsingIndexer=function(e,c,d){var f=b.tryGetObjectIdFromLoadOrRetrieveResult(d),a=a={Id:e._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:c._objectPath.objectPathInfo.Id,ArgumentInfo:{}};a.ArgumentInfo.Arguments=[f];return new m(a,c._objectPath,false,false,1,4)};a.createChildItemObjectPathUsingGetItemAt=function(g,c,f,d){var a=f[e.index];if(a)d=a;var b={Id:g._nextId(),ObjectPathType:3,Name:e.getItemAt,ParentObjectPathId:c._objectPath.objectPathInfo.Id,ArgumentInfo:{}};b.ArgumentInfo.Arguments=[d];return new m(b,c._objectPath,false,false,1,4)};return a}();c.ObjectPathFactory=s;var fb=function(){function b(a){this.m_context=a}b.prototype.executeAsync=function(g,f,e){var h=this,d=k.buildMessageArrayForIRequestExecutor(g,f,e,b.SourceLibHeaderValue);return new c.Promise(function(b,c){OSF.DDA.RichApi.executeRichApiRequestAsync(d,function(c){a.log("Response:");a.log(JSON.stringify(c));var d;if(c.status=="succeeded")d=k.buildResponseOnSuccess(k.getResponseBody(c),k.getResponseHeaders(c));else{d=k.buildResponseOnError(c.error.code,c.error.message);h.m_context._processOfficeJsErrorResponse(c.error.code,d)}b(d)})})};b.SourceLibHeaderValue="officejs";return b}(),U=function(){function c(a){this._autoCleanupList={};this.m_context=a}c.prototype.add=function(a){var b=this;if(Array.isArray(a))a.forEach(function(a){return b._addCommon(a,true)});else this._addCommon(a,true)};c.prototype._autoAdd=function(a){this._addCommon(a,false);this._autoCleanupList[a._objectPath.objectPathInfo.Id]=a};c.prototype._autoTrackIfNecessaryWhenHandleObjectResultValue=function(a,c){var d=this.m_context._autoCleanup&&!a[e.isTracked]&&a!==this.m_context._rootObject&&c&&!b.isNullOrEmptyString(c[e.referenceId]);if(d){this._autoCleanupList[a._objectPath.objectPathInfo.Id]=a;a[e.isTracked]=true}};c.prototype._addCommon=function(c,d){if(c[e.isTracked]){if(d&&this.m_context._autoCleanup)delete this._autoCleanupList[c._objectPath.objectPathInfo.Id];return}var h=c[e.referenceId],f=c._objectPath.objectPathInfo[e.objectPathInfoDoNotKeepReferenceFieldName];if(f)throw b.createRuntimeError(g.generalException,a._getResourceString(r.objectIsUntracked),null);if(b.isNullOrEmptyString(h)&&c._KeepReference){c._KeepReference();q.createInstantiateAction(this.m_context,c);if(d&&this.m_context._autoCleanup)delete this._autoCleanupList[c._objectPath.objectPathInfo.Id];c[e.isTracked]=true}};c.prototype.remove=function(a){var b=this;if(Array.isArray(a))a.forEach(function(a){return b._removeCommon(a)});else this._removeCommon(a)};c.prototype._removeCommon=function(a){a._objectPath.objectPathInfo[e.objectPathInfoDoNotKeepReferenceFieldName]=true;a.context._pendingRequest._removeKeepReferenceAction(a._objectPath.objectPathInfo.Id);var c=a[e.referenceId];if(!b.isNullOrEmptyString(c)){var d=this.m_context._rootObject;d._RemoveReference&&d._RemoveReference(c)}delete a[e.isTracked]};c.prototype._retrieveAndClearAutoCleanupList=function(){var a=this._autoCleanupList;this._autoCleanupList={};return a};return c}();c.TrackedObjects=U;var J=function(){function a(a,b,e,c,d){if(!a)a="root";this.m_globalObjName=a;this.m_referencedObjectPaths=b;this.m_actions=e;this.m_statements=[];this.m_variableNameForObjectPathMap={};this.m_variableNameToObjectPathMap={};this.m_declaredObjectPathMap={};this.m_showDispose=c;this.m_removePII=d}a.prototype.process=function(){this.m_showDispose&&z._calculateLastUsedObjectPathIds(this.m_actions);for(var a=0;a<this.m_actions.length;a++)this.processOneAction(this.m_actions[a]);return this.m_statements};a.prototype.processForDebugStatementInfo=function(i){this.m_showDispose&&z._calculateLastUsedObjectPathIds(this.m_actions);var f=5;this.m_statements=[];for(var j="",a=-1,e=0;e<this.m_actions.length;e++){this.processOneAction(this.m_actions[e]);if(i==e)a=this.m_statements.length-1;if(a>=0&&this.m_statements.length>a+f+1)break}if(a<0)return null;var c=a-f;if(c<0)c=0;var d=a+1+f;if(d>this.m_statements.length)d=this.m_statements.length;var b=[];c!=0&&b.push("...");for(var g=c;g<a;g++)b.push(this.m_statements[g]);b.push("// >>>>>");b.push(this.m_statements[a]);b.push("// <<<<<");for(var h=a+1;h<d;h++)b.push(this.m_statements[h]);d<this.m_statements.length&&b.push("...");return{statement:this.m_statements[a],surroundingStatements:b}};a.prototype.processOneAction=function(a){var b=a.actionInfo;switch(b.ActionType){case 1:this.processInstantiateAction(a);break;case 3:this.processMethodAction(a);break;case 2:this.processQueryAction(a);break;case 7:this.processQueryAsJsonAction(a);break;case 6:this.processRecursiveQueryAction(a);break;case 4:this.processSetPropertyAction(a);break;case 5:this.processTraceAction(a);break;case 8:this.processEnsureUnchangedAction(a);break;case 9:this.processUpdateAction(a);break}};a.prototype.processInstantiateAction=function(d){var b=d.actionInfo.ObjectPathId,e=this.m_referencedObjectPaths[b],c=this.getObjVarName(b);if(!this.m_declaredObjectPathMap[b]){var a="var "+c+" = "+this.buildObjectPathExpressionWithParent(e)+";";a=this.appendDisposeCommentIfRelevant(a,d);this.m_statements.push(a);this.m_declaredObjectPathMap[b]=c}else{var a="// Instantiate {"+c+"}";a=this.appendDisposeCommentIfRelevant(a,d);this.m_statements.push(a)}};a.prototype.processMethodAction=function(a){var d=a.actionInfo.Name;if(d==="_KeepReference"){if(!c._internalConfig.showInternalApiInDebugInfo)return;d="track"}var e=this.getObjVarName(a.actionInfo.ObjectPathId)+"."+b._toCamelLowerCase(d)+"("+this.buildArgumentsExpression(a.actionInfo.ArgumentInfo)+");";e=this.appendDisposeCommentIfRelevant(e,a);this.m_statements.push(e)};a.prototype.processQueryAction=function(b){var c=this.buildQueryExpression(b),a=this.getObjVarName(b.actionInfo.ObjectPathId)+".load("+c+");";a=this.appendDisposeCommentIfRelevant(a,b);this.m_statements.push(a)};a.prototype.processQueryAsJsonAction=function(b){var c=this.buildQueryExpression(b),a=this.getObjVarName(b.actionInfo.ObjectPathId)+".retrieve("+c+");";a=this.appendDisposeCommentIfRelevant(a,b);this.m_statements.push(a)};a.prototype.processRecursiveQueryAction=function(a){var c="";if(a.actionInfo.RecursiveQueryInfo)c=JSON.stringify(a.actionInfo.RecursiveQueryInfo);var b=this.getObjVarName(a.actionInfo.ObjectPathId)+".loadRecursive("+c+");";b=this.appendDisposeCommentIfRelevant(b,a);this.m_statements.push(b)};a.prototype.processSetPropertyAction=function(a){var c=this.getObjVarName(a.actionInfo.ObjectPathId)+"."+b._toCamelLowerCase(a.actionInfo.Name)+" = "+this.buildArgumentsExpression(a.actionInfo.ArgumentInfo)+";";c=this.appendDisposeCommentIfRelevant(c,a);this.m_statements.push(c)};a.prototype.processTraceAction=function(b){var a="context.trace();";a=this.appendDisposeCommentIfRelevant(a,b);this.m_statements.push(a)};a.prototype.processEnsureUnchangedAction=function(b){var a=this.getObjVarName(b.actionInfo.ObjectPathId)+".ensureUnchanged("+JSON.stringify(b.actionInfo.ObjectState)+");";a=this.appendDisposeCommentIfRelevant(a,b);this.m_statements.push(a)};a.prototype.processUpdateAction=function(b){var a=this.getObjVarName(b.actionInfo.ObjectPathId)+".update("+JSON.stringify(b.actionInfo.ObjectState)+");";a=this.appendDisposeCommentIfRelevant(a,b);this.m_statements.push(a)};a.prototype.appendDisposeCommentIfRelevant=function(b,d){var e=this;if(this.m_showDispose){var a=d.actionInfo.L;if(a&&a.length>0){var c=a.map(function(a){return e.getObjVarName(a)}).join(", ");return b+" // And then dispose {"+c+"}"}}return b};a.prototype.buildQueryExpression=function(b){if(b.actionInfo.QueryInfo){var a={};a.select=b.actionInfo.QueryInfo.Select;a.expand=b.actionInfo.QueryInfo.Expand;a.skip=b.actionInfo.QueryInfo.Skip;a.top=b.actionInfo.QueryInfo.Top;if(typeof a.top==="undefined"&&typeof a.skip==="undefined"&&typeof a.expand==="undefined")if(typeof a.select==="undefined")return"";else return JSON.stringify(a.select);else return JSON.stringify(a)}return""};a.prototype.buildObjectPathExpressionWithParent=function(a){var b=a.objectPathInfo.ObjectPathType==5||a.objectPathInfo.ObjectPathType==3||a.objectPathInfo.ObjectPathType==4;if(b&&a.objectPathInfo.ParentObjectPathId)return this.getObjVarName(a.objectPathInfo.ParentObjectPathId)+"."+this.buildObjectPathExpression(a);return this.buildObjectPathExpression(a)};a.prototype.buildObjectPathExpression=function(c){var a=this.buildObjectPathInfoExpression(c.objectPathInfo),b=c.originalObjectPathInfo;if(b)a=a+" /* originally "+this.buildObjectPathInfoExpression(b)+" */";return a};a.prototype.buildObjectPathInfoExpression=function(a){switch(a.ObjectPathType){case 1:return"context."+this.m_globalObjName;case 5:return"getItem("+this.buildArgumentsExpression(a.ArgumentInfo)+")";case 3:return b._toCamelLowerCase(a.Name)+"("+this.buildArgumentsExpression(a.ArgumentInfo)+")";case 2:return a.Name+".newObject()";case 7:return"null";case 4:return b._toCamelLowerCase(a.Name);case 6:return"context."+this.m_globalObjName+"._getObjectByReferenceId("+JSON.stringify(a.Name)+")"}};a.prototype.buildArgumentsExpression=function(b){var a="";if(!b.Arguments||b.Arguments.length===0)return a;if(this.m_removePII){if(typeof b.Arguments[0]==="undefined")return a;return"..."}for(var c=0;c<b.Arguments.length;c++){if(c>0)a=a+", ";a=a+this.buildArgumentLiteral(b.Arguments[c],b.ReferencedObjectPathIds?b.ReferencedObjectPathIds[c]:null)}if(a==="undefined")a="";return a};a.prototype.buildArgumentLiteral=function(a,b){if(typeof a=="number"&&a===b)return this.getObjVarName(b);else return JSON.stringify(a)};a.prototype.getObjVarNameBase=function(f){var a="v",e=this.m_referencedObjectPaths[f];if(e)switch(e.objectPathInfo.ObjectPathType){case 1:a=this.m_globalObjName;break;case 4:a=b._toCamelLowerCase(e.objectPathInfo.Name);break;case 3:var c=e.objectPathInfo.Name;if(c.length>3&&c.substr(0,3)==="Get")c=c.substr(3);a=b._toCamelLowerCase(c);break;case 5:var d=this.getObjVarNameBase(e.objectPathInfo.ParentObjectPathId);if(d.charAt(d.length-1)==="s")a=d.substr(0,d.length-1);else a=d+"Item";break}return a};a.prototype.getObjVarName=function(b){if(this.m_variableNameForObjectPathMap[b])return this.m_variableNameForObjectPathMap[b];var a=this.getObjVarNameBase(b);if(!this.m_variableNameToObjectPathMap[a]){this.m_variableNameForObjectPathMap[b]=a;this.m_variableNameToObjectPathMap[a]=b;return a}var c=1;while(this.m_variableNameToObjectPathMap[a+c.toString()])c++;a=a+c.toString();this.m_variableNameForObjectPathMap[b]=a;this.m_variableNameToObjectPathMap[a]=b;return a};return a}(),r=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}a.cannotRegisterEvent="CannotRegisterEvent";a.connectionFailureWithStatus="ConnectionFailureWithStatus";a.connectionFailureWithDetails="ConnectionFailureWithDetails";a.propertyNotLoaded="PropertyNotLoaded";a.runMustReturnPromise="RunMustReturnPromise";a.moreInfoInnerError="MoreInfoInnerError";a.cannotApplyPropertyThroughSetMethod="CannotApplyPropertyThroughSetMethod";a.invalidOperationInCellEditMode="InvalidOperationInCellEditMode";a.objectIsUntracked="ObjectIsUntracked";a.customFunctionDefintionMissing="CustomFunctionDefintionMissing";a.customFunctionImplementationMissing="CustomFunctionImplementationMissing";a.customFunctionNameContainsBadChars="CustomFunctionNameContainsBadChars";a.customFunctionNameCannotSplit="CustomFunctionNameCannotSplit";a.customFunctionUnexpectedNumberOfEntriesInResultBatch="CustomFunctionUnexpectedNumberOfEntriesInResultBatch";a.customFunctionCancellationHandlerMissing="CustomFunctionCancellationHandlerMissing";a.customFunctionInvalidFunction="CustomFunctionInvalidFunction";a.customFunctionInvalidFunctionMapping="CustomFunctionInvalidFunctionMapping";a.customFunctionWindowMissing="CustomFunctionWindowMissing";a.customFunctionDefintionMissingOnWindow="CustomFunctionDefintionMissingOnWindow";a.pendingBatchInProgress="PendingBatchInProgress";a.notInsideBatch="NotInsideBatch";a.cannotUpdateReadOnlyProperty="CannotUpdateReadOnlyProperty";return a}(y);c.ResourceStrings=r;a.addResourceStringValues({CannotRegisterEvent:"The event handler cannot be registered.",PropertyNotLoaded:"The property '{0}' is not available. Before reading the property's value, call the load method on the containing object and call \"context.sync()\" on the associated request context.",RunMustReturnPromise:'The batch function passed to the ".run" method didn\'t return a promise. The function must return a promise, so that any automatically-tracked objects can be released at the completion of the batch operation. Typically, you return a promise by returning the response from "context.sync()".',InvalidOrTimedOutSessionMessage:"Your Office Online session has expired or is invalid. To continue, refresh the page.",InvalidOperationInCellEditMode:"Excel is in cell-editing mode. Please exit the edit mode by pressing ENTER or TAB or selecting another cell, and then try again.",CustomFunctionDefintionMissing:"A property with the name '{0}' that represents the function's definition must exist on Excel.Script.CustomFunctions.",CustomFunctionDefintionMissingOnWindow:"A property with the name '{0}' that represents the function's definition must exist on the window object.",CustomFunctionImplementationMissing:"The property with the name '{0}' on Excel.Script.CustomFunctions that represents the function's definition must contain a 'call' property that implements the function.",CustomFunctionNameContainsBadChars:"The function name may only contain letters, digits, underscores, and periods.",CustomFunctionNameCannotSplit:"The function name must contain a non-empty namespace and a non-empty short name.",CustomFunctionUnexpectedNumberOfEntriesInResultBatch:"The batching function returned a number of results that doesn't match the number of parameter value sets that were passed into it.",CustomFunctionCancellationHandlerMissing:"The cancellation handler onCanceled is missing in the function. The handler must be present as the function is defined as cancelable.",CustomFunctionInvalidFunction:"The property with the name '{0}' that represents the function's definition is not a valid function.",CustomFunctionInvalidFunctionMapping:"The property with the name '{0}' on CustomFunctionMappings that represents the function's definition is not a valid function.",CustomFunctionWindowMissing:"The window object was not found.",PendingBatchInProgress:"There is a pending batch in progress. The batch method may not be called inside another batch, or simultaneously with another batch.",NotInsideBatch:"Operations may not be invoked outside of a batch method.",CannotUpdateReadOnlyProperty:"The property '{0}' is read-only and it cannot be updated.",ObjectIsUntracked:"The object is untracked."});var b=function(f){__extends(b,f);function b(){return f!==null&&f.apply(this,arguments)||this}b.fixObjectPathIfNecessary=function(a,b){a&&a._objectPath&&b&&a._objectPath.updateUsingObjectData(b,a)};b.load=function(a,b){a.context.load(a,b);return a};b.loadAndSync=function(a,b){a.context.load(a,b);return a.context.sync().then(function(){return a})};b.retrieve=function(d,f){var a=c._internalConfig.alwaysPolyfillClientObjectRetrieveMethod;if(!a)a=!b.isSetSupported("RichApiRuntime","1.1");var e=new hb(d,a);d._retrieve(f,e);return e};b.retrieveAndSync=function(a,c){var d=b.retrieve(a,c);return a.context.sync().then(function(){return d})};b.toJson=function(h,g,f,e){var c={};for(var d in g){var a=g[d];if(typeof a!=="undefined")c[d]=a}for(var d in f){var a=f[d];if(typeof a!=="undefined")if(a[b.fieldName_isCollection]&&typeof a[b.fieldName_m__items]!=="undefined")c[d]=a.toJSON().items;else c[d]=a.toJSON()}if(e)c.items=e.map(function(a){return a.toJSON()});return c};b.throwError=function(c,e,b){throw new d.RuntimeError({code:c,message:a._getResourceString(c,e),debugInfo:b?{errorLocation:b}:undefined});};b.createRuntimeError=function(c,b,a){return new d.RuntimeError({code:c,message:b,debugInfo:{errorLocation:a}})};b.throwIfNotLoaded=function(c,e,d,f){if(!f&&a.isUndefined(e)&&c.charCodeAt(0)!=b.s_underscoreCharCode)throw b.createPropertyNotLoadedException(d,c);};b.createPropertyNotLoadedException=function(c,b){return new d.RuntimeError({code:D.propertyNotLoaded,message:a._getResourceString(r.propertyNotLoaded,b),debugInfo:c?{errorLocation:c+"."+b}:undefined})};b.createCannotUpdateReadOnlyPropertyException=function(c,b){return new d.RuntimeError({code:D.cannotUpdateReadOnlyProperty,message:a._getResourceString(r.cannotUpdateReadOnlyProperty,b),debugInfo:c?{errorLocation:c+"."+b}:undefined})};b.promisify=function(a){return new c.Promise(function(c,d){var b=function(a){if(a.status=="failed")d(a.error);else c(a.value)};a(b)})};b._addActionResultHandler=function(b,c,a){b.context._pendingRequest.addActionResultHandler(c,a)};b._handleNavigationPropertyResults=function(e,d,c){for(var b=0;b<c.length-1;b+=2)!a.isUndefined(d[c[b+1]])&&e[c[b]]._handleResult(d[c[b+1]])};b._fixupApiFlags=function(a){if(typeof a==="boolean")if(a)a=1;else a=0;return a};b.definePropertyThrowUnloadedException=function(d,c,a){Object.defineProperty(d,a,{configurable:true,enumerable:true,"get":function(){throw b.createPropertyNotLoadedException(c,a);},"set":function(){throw b.createCannotUpdateReadOnlyPropertyException(c,a);}})};b.defineReadOnlyPropertyWithValue=function(d,a,c){Object.defineProperty(d,a,{configurable:true,enumerable:true,"get":function(){return c},"set":function(){throw b.createCannotUpdateReadOnlyPropertyException(null,a);}})};b.processRetrieveResult=function(i,j,g,o){if(a.isNullOrUndefined(j))return;if(o){var k=j[e.itemsLowerCase];if(Array.isArray(k)){for(var p=[],c=0;c<k.length;c++){var q=o(k[c],c),n={};n[e.proxy]=q;q._handleRetrieveResult(k[c],n);p.push(n)}b.defineReadOnlyPropertyWithValue(g,e.itemsLowerCase,p)}}else{var m=i[e.scalarPropertyNames],l=i[e.navigationPropertyNames],s=i[e.className];if(m)for(var c=0;c<m.length;c++){var d=m[c],h=j[d];if(a.isUndefined(h))b.definePropertyThrowUnloadedException(g,s,d);else b.defineReadOnlyPropertyWithValue(g,d,h)}if(l)for(var c=0;c<l.length;c++){var d=l[c],h=j[d];if(a.isUndefined(h))b.definePropertyThrowUnloadedException(g,s,d);else{var r=i[d],f={};r._handleRetrieveResult(h,f);f[e.proxy]=r;if(Array.isArray(f[e.itemsLowerCase]))f=f[e.itemsLowerCase];b.defineReadOnlyPropertyWithValue(g,d,f)}}}};b.setMockData=function(d,f,j,p){if(a.isNullOrUndefined(f)){d._handleResult(f);return}if(d[e.scalarPropertyOriginalNames]){for(var l={},o=d[e.scalarPropertyOriginalNames],i=d[e.scalarPropertyNames],c=0;c<i.length;c++)if(typeof f[i[c]]!=="undefined")l[o[c]]=f[i[c]];d._handleResult(l)}if(d[e.navigationPropertyNames])for(var g=d[e.navigationPropertyNames],c=0;c<g.length;c++)if(typeof f[g[c]]!=="undefined"){var k=d[g[c]];k.setMockData&&k.setMockData(f[g[c]])}if(d[e.isCollection]&&j){var h=Array.isArray(f)?f:f[e.itemsLowerCase];if(Array.isArray(h)){for(var m=[],c=0;c<h.length;c++){var n=j(h,c);b.setMockData(n,h[c]);m.push(n)}p(m)}}};b.applyMixin=function(b,a){Object.getOwnPropertyNames(a.prototype).forEach(function(c){c!=="constructor"&&Object.defineProperty(b.prototype,c,Object.getOwnPropertyDescriptor(a.prototype,c))})};b.fieldName_m__items="m__items";b.fieldName_isCollection="_isCollection";b._synchronousCleanup=false;b.s_underscoreCharCode="_".charCodeAt(0);return b}(f);c.Utility=b;var p=function(){function a(){}a.invokeMethod=function(a,f,e,i,h,d){var g=q.createMethodAction(a.context,a,f,e,i,h),c=new A(d);b._addActionResultHandler(a,g,c);return c};a.invokeEnsureUnchanged=function(a,b){q.createEnsureUnchangedAction(a.context,a,b)};a.invokeSetProperty=function(a,c,b,d){q.createSetPropertyAction(a.context,a,c,b,d)};a.createRootServiceObject=function(c,a){var b=s.createGlobalObjectObjectPath(a);return new c(a,b)};a.createObjectFromReferenceId=function(d,a,b){var c=s.createReferenceIdObjectPath(a,b);return new d(a,c)};a.createTopLevelServiceObject=function(f,a,d,b,e){var c=s.createNewObjectObjectPath(a,d,b,e);return new f(a,c)};a.createPropertyObject=function(f,a,c,b,e){var d=s.createPropertyObjectPath(a.context,a,c,b,false,e);return new f(a.context,d)};a.createIndexerObject=function(d,a,c){var b=s.createIndexerObjectPath(a.context,a,c);return new d(a.context,b)};a.createMethodObject=function(j,a,f,d,i,e,b,c,h){var g=s.createMethodObjectPath(a.context,a,f,d,i,e,b,c,h);return new j(a.context,g)};a.createChildItemObject=function(f,b,a,d,e){var c=s.createChildItemObjectPathUsingIndexerOrGetItemAt(b,a.context,a,d,e);return new f(a.context,c)};return a}();c.BatchApiHelper=p;var kb=function(){function a(d){this.m_namespaceMap={};this.m_namespace=d.metadata.name;this.m_targetNamespaceObject=d.targetNamespaceObject;this.m_namespaceMap[this.m_namespace]=d.targetNamespaceObject;if(d.namespaceMap)for(var e in d.namespaceMap)this.m_namespaceMap[e]=d.namespaceMap[e];this.m_defaultApiSetName=d.metadata.defaultApiSetName;this.m_hostName=d.metadata.hostName;var b=d.metadata;if(b.enumTypes)for(var c=0;c<b.enumTypes.length;c++)this.buildEnumType(b.enumTypes[c]);if(b.apiSets){for(var c=0;c<b.apiSets.length;c++){var a=b.apiSets[c];if(Array.isArray(a))b.apiSets[c]={version:a[0],name:a[1]||this.m_defaultApiSetName}}this.m_apiSets=b.apiSets}this.m_strings=b.strings;if(b.clientObjectTypes)for(var c=0;c<b.clientObjectTypes.length;c++){var a=b.clientObjectTypes[c];if(Array.isArray(a)){this.ensureArraySize(a,11);b.clientObjectTypes[c]={name:this.getString(a[0]),behaviorFlags:a[1],collectionPropertyPath:this.getString(a[6]),newObjectServerTypeFullName:this.getString(a[9]),newObjectApiFlags:a[10],childItemTypeFullName:this.getString(a[7]),scalarProperties:a[2],navigationProperties:a[3],scalarMethods:a[4],navigationMethods:a[5],events:a[8]}}this.buildClientObjectType(b.clientObjectTypes[c],d.fullyInitialize)}}a.prototype.ensureArraySize=function(b,c){var a=c-b.length;while(a>0){b.push(0);a--}};a.prototype.getString=function(a){if(typeof a==="number"){if(a>0)return this.m_strings[a-1];return null}return a};a.prototype.buildEnumType=function(b){var a;if(Array.isArray(b)){a={name:b[0],fields:b[2]};if(!a.fields)a.fields={};var c=b[1];if(Array.isArray(c))for(var d=0;d<c.length;d++)a.fields[c[d]]=this.toSimpleCamelUpperCase(c[d])}else a=b;this.m_targetNamespaceObject[a.name]=a.fields};a.prototype.buildClientObjectType=function(b,e){var d=this,c=function(c,a){t.apply(this,arguments);if(!d.m_targetNamespaceObject[b.name]._typeInited){d.buildPrototype(d.m_targetNamespaceObject[b.name],b);d.m_targetNamespaceObject[b.name]._typeInited=true}};this.m_targetNamespaceObject[b.name]=c;this.extendsType(c,t);this.buildNewObject(c,b);if((b.behaviorFlags&2)!==0)c.prototype._KeepReference=function(){p.invokeMethod(this,"_KeepReference",1,[],0,0)};if((b.behaviorFlags&32)!==0){var f=this.getFunction(a.CustomizationCodeNamespace+"."+b.name+"_StaticCustomize");f.call(null,c)}if(e){this.buildPrototype(c,b);c._typeInited=true}};a.prototype.extendsType=function(c,a){function b(){this.constructor=c}c.prototype=a===null?Object.create(a):(b.prototype=a.prototype,new b)};a.prototype.findObjectUnderPath=function(f,b,e){for(var a=f,d=e;d<b.length;d++){if(typeof a!=="object")throw new c.Error("Cannot find "+b.join("."));a=a[b[d]]}return a};a.prototype.getFunction=function(a){var b=this.resolveObjectByFullName(a);if(typeof b!=="function")throw new c.Error("Cannot find function or type: "+a);return b};a.prototype.resolveObjectByFullName=function(c){var a=c.split(".");if(a.length===1)return this.m_targetNamespaceObject[a[0]];var b=a[0];if(b===this.m_namespace)return this.findObjectUnderPath(this.m_targetNamespaceObject,a,1);if(this.m_namespaceMap[b])return this.findObjectUnderPath(this.m_namespaceMap[b],a,1);return this.findObjectUnderPath(this.m_targetNamespaceObject,a,0)};a.prototype.evaluateExpression=function(a,c){if(b.isNullOrUndefined(a))return null;var d=new Function("return "+a).call(c);return d};a.prototype.evaluateEventTargetId=function(a,c){if(b.isNullOrEmptyString(a))return"";return this.evaluateExpression(a,c)};a.prototype.isAllDigits=function(b){for(var d="0".charCodeAt(0),c="9".charCodeAt(0),a=0;a<b.length;a++)if(b.charCodeAt(a)<d||b.charCodeAt(a)>c)return false;return true};a.prototype.evaluateEventType=function(a){if(b.isNullOrEmptyString(a))return 0;if(this.isAllDigits(a))return parseInt(a);var d=this.resolveObjectByFullName(a);if(typeof d!=="number")throw new c.Error("Invalid event type: "+a);return d};a.prototype.buildPrototype=function(b,a){this.buildScalarProperties(b,a);this.buildNavigationProperties(b,a);this.buildScalarMethods(b,a);this.buildNavigationMethods(b,a);this.buildEvents(b,a);this.buildHandleResult(b,a);this.buildHandleIdResult(b,a);this.buildHandleRetrieveResult(b,a);this.buildLoad(b,a);this.buildRetrieve(b,a);this.buildSetMockData(b,a);this.buildEnsureUnchanged(b,a);this.buildUpdate(b,a);this.buildSet(b,a);this.buildToJSON(b,a);this.buildItems(b,a);this.buildTypeMetadataInfo(b,a);this.buildTrackUntrack(b,a);this.buildMixin(b,a)};a.prototype.toSimpleCamelUpperCase=function(a){return a.substr(0,1).toUpperCase()+a.substr(1)};a.prototype.ensureOriginalName=function(a){if(a.originalName===null)a.originalName=this.toSimpleCamelUpperCase(a.name)};a.prototype.getFieldName=function(a){return"m_"+a.name};a.prototype.throwIfApiNotSupported=function(d,c){if(this.m_apiSets&&c.apiSetInfoOrdinal>0){var a=this.m_apiSets[c.apiSetInfoOrdinal-1];a&&b.throwIfApiNotSupported(d.name+"."+c.name,a.name,a.version,this.m_hostName)}};a.prototype.buildScalarProperties=function(d,b){if(Array.isArray(b.scalarProperties))for(var c=0;c<b.scalarProperties.length;c++){var a=b.scalarProperties[c];if(Array.isArray(a)){this.ensureArraySize(a,5);b.scalarProperties[c]={name:this.getString(a[0]),behaviorFlags:a[1],apiSetInfoOrdinal:a[2],originalName:this.getString(a[3]),setMethodApiFlags:a[4]}}this.buildScalarProperty(d,b,b.scalarProperties[c])}};a.prototype.buildScalarProperty=function(h,e,c){this.ensureOriginalName(c);var f=this,d=this.getFieldName(c),g={"get":function(){b.throwIfNotLoaded(c.name,this[d],e.name,this._isNull);f.throwIfApiNotSupported(e,c);return this[d]},enumerable:true,configurable:true};if((c.behaviorFlags&2)===0)g.set=function(b){if(c.behaviorFlags&4){var g=f.getFunction(a.CustomizationCodeNamespace+"."+e.name+"_"+c.originalName+"_Set"),h=g.call(this,this,b).handled;if(h)return}this[d]=b;p.invokeSetProperty(this,c.originalName,b,c.setMethodApiFlags)};Object.defineProperty(h.prototype,c.name,g)};a.prototype.buildNavigationProperties=function(d,b){if(Array.isArray(b.navigationProperties))for(var c=0;c<b.navigationProperties.length;c++){var a=b.navigationProperties[c];if(Array.isArray(a)){this.ensureArraySize(a,7);b.navigationProperties[c]={name:this.getString(a[0]),behaviorFlags:a[2],apiSetInfoOrdinal:a[3],originalName:this.getString(a[4]),getMethodApiFlags:a[5],setMethodApiFlags:a[6],propertyTypeFullName:this.getString(a[1])}}this.buildNavigationProperty(d,b,b.navigationProperties[c])}};a.prototype.buildNavigationProperty=function(g,e,b){this.ensureOriginalName(b);var c=this,d=this.getFieldName(b),f={"get":function(){if(!this[c.getFieldName(b)]){c.throwIfApiNotSupported(e,b);this[d]=p.createPropertyObject(c.getFunction(b.propertyTypeFullName),this,b.originalName,(b.behaviorFlags&16)!==0,b.getMethodApiFlags)}if(b.behaviorFlags&64){var f=c.getFunction(a.CustomizationCodeNamespace+"."+e.name+"_"+b.originalName+"_Get");f.call(this,this,this[d])}return this[d]},enumerable:true,configurable:true};if((b.behaviorFlags&2)===0)f.set=function(f){if(b.behaviorFlags&4){var g=c.getFunction(a.CustomizationCodeNamespace+"."+e.name+"_"+b.originalName+"_Set"),h=g.call(this,this,f).handled;if(h)return}this[d]=f;p.invokeSetProperty(this,b.originalName,f,b.setMethodApiFlags)};Object.defineProperty(g.prototype,b.name,f)};a.prototype.buildScalarMethods=function(d,b){if(Array.isArray(b.scalarMethods))for(var c=0;c<b.scalarMethods.length;c++){var a=b.scalarMethods[c];if(Array.isArray(a)){this.ensureArraySize(a,6);b.scalarMethods[c]={name:this.getString(a[0]),behaviorFlags:a[2],apiSetInfoOrdinal:a[3],originalName:this.getString(a[5]),apiFlags:a[4],parameterCount:a[1]}}this.buildScalarMethod(d,b,b.scalarMethods[c])}};a.prototype.buildScalarMethod=function(e,d,b){this.ensureOriginalName(b);var c=this;e.prototype[b.name]=function(){var f=[];if(b.behaviorFlags&64&&b.parameterCount>0){for(var e=0;e<b.parameterCount-1;e++)f.push(arguments[e]);for(var j=[],e=b.parameterCount-1;e<arguments.length;e++)j.push(arguments[e]);f.push(j)}else for(var e=0;e<arguments.length;e++)f.push(arguments[e]);if(b.behaviorFlags&1){for(var l=c.getFunction(a.CustomizationCodeNamespace+"."+d.name+"_"+b.originalName),i=[this],e=0;e<f.length;e++)i.push(f[e]);var k=l.apply(this,i),m=k.handled,n=k.result;if(m)return n}c.throwIfApiNotSupported(d,b);var g=0;if(b.behaviorFlags&32)g=1;var h=0;if(b.behaviorFlags&2)h=1;return p.invokeMethod(this,b.originalName,h,f,b.apiFlags,g)}};a.prototype.buildNavigationMethods=function(d,b){if(Array.isArray(b.navigationMethods))for(var c=0;c<b.navigationMethods.length;c++){var a=b.navigationMethods[c];if(Array.isArray(a)){this.ensureArraySize(a,8);b.navigationMethods[c]={name:this.getString(a[0]),behaviorFlags:a[3],apiSetInfoOrdinal:a[4],originalName:this.getString(a[6]),apiFlags:a[5],parameterCount:a[2],returnTypeFullName:this.getString(a[1]),returnObjectGetByIdMethodName:this.getString(a[7])}}this.buildNavigationMethod(d,b,b.navigationMethods[c])}};a.prototype.buildNavigationMethod=function(e,d,b){this.ensureOriginalName(b);var c=this;e.prototype[b.name]=function(){var f=[];if(b.behaviorFlags&64&&b.parameterCount>0){for(var e=0;e<b.parameterCount-1;e++)f.push(arguments[e]);for(var i=[],e=b.parameterCount-1;e<arguments.length;e++)i.push(arguments[e]);f.push(i)}else for(var e=0;e<arguments.length;e++)f.push(arguments[e]);if(b.behaviorFlags&1){for(var k=c.getFunction(a.CustomizationCodeNamespace+"."+d.name+"_"+b.originalName),h=[this],e=0;e<f.length;e++)h.push(f[e]);var j=k.apply(this,h),l=j.handled,m=j.result;if(l)return m}c.throwIfApiNotSupported(d,b);if((b.behaviorFlags&16)!==0)return p.createIndexerObject(c.getFunction(b.returnTypeFullName),this,f);else{var g=0;if(b.behaviorFlags&2)g=1;return p.createMethodObject(c.getFunction(b.returnTypeFullName),this,b.originalName,g,f,(b.behaviorFlags&4)!==0,(b.behaviorFlags&8)!==0,b.returnObjectGetByIdMethodName,b.apiFlags)}}};a.prototype.buildHandleResult=function(f,c){var d=this;f.prototype._handleResult=function(f){t.prototype._handleResult.call(this,f);if(b.isNullOrUndefined(f))return;b.fixObjectPathIfNecessary(this,f);if(c.behaviorFlags&8){var m=d.getFunction(a.CustomizationCodeNamespace+"."+c.name+"_HandleResult");m.call(this,this,f)}if(c.scalarProperties)for(var g=0;g<c.scalarProperties.length;g++)if(!b.isUndefined(f[c.scalarProperties[g].originalName]))if((c.scalarProperties[g].behaviorFlags&8)!==0)this[d.getFieldName(c.scalarProperties[g])]=b.adjustToDateTime(f[c.scalarProperties[g].originalName]);else this[d.getFieldName(c.scalarProperties[g])]=f[c.scalarProperties[g].originalName];if(c.navigationProperties){for(var j=[],i=0;i<c.navigationProperties.length;i++){j.push(c.navigationProperties[i].name);j.push(c.navigationProperties[i].originalName)}b._handleNavigationPropertyResults(this,f,j)}if((c.behaviorFlags&1)!==0){var n=d.hasIndexMethod(c);if(!b.isNullOrUndefined(f[e.items])){this.m__items=[];for(var k=f[e.items],o=d.getFunction(c.childItemTypeFullName),h=0;h<k.length;h++){var l=p.createChildItemObject(o,n,this,k[h],h);l._handleResult(k[h]);this.m__items.push(l)}}}}};a.prototype.buildHandleRetrieveResult=function(d,a){var c=this;d.prototype._handleRetrieveResult=function(d,f){t.prototype._handleRetrieveResult.call(this,d,f);if(b.isNullOrUndefined(d))return;if(a.scalarProperties)for(var e=0;e<a.scalarProperties.length;e++)if(a.scalarProperties[e].behaviorFlags&8)if(!b.isNullOrUndefined(d[a.scalarProperties[e].name]))d[a.scalarProperties[e].name]=b.adjustToDateTime(d[a.scalarProperties[e].name]);if(a.behaviorFlags&1){var h=c.hasIndexMethod(a),i=c.getFunction(a.childItemTypeFullName),g=this;b.processRetrieveResult(g,d,f,function(a,b){return p.createChildItemObject(i,h,g,a,b)})}else b.processRetrieveResult(this,d,f)}};a.prototype.buildHandleIdResult=function(e,c){var d=this;e.prototype._handleIdResult=function(f){t.prototype._handleIdResult.call(this,f);if(b.isNullOrUndefined(f))return;if(c.behaviorFlags&16){var h=d.getFunction(a.CustomizationCodeNamespace+"."+c.name+"_HandleIdResult");h.call(this,this,f)}if(c.scalarProperties)for(var e=0;e<c.scalarProperties.length;e++){var g=c.scalarProperties[e].originalName;if(g==="Id"||g==="_Id"||g==="_ReferenceId")if(!b.isNullOrUndefined(f[c.scalarProperties[e].originalName]))this[d.getFieldName(c.scalarProperties[e])]=f[c.scalarProperties[e].originalName]}}};a.prototype.buildLoad=function(a,c){a.prototype.load=function(a){return b.load(this,a)}};a.prototype.buildRetrieve=function(a,c){a.prototype.retrieve=function(a){return b.retrieve(this,a)}};a.prototype.buildNewObject=function(c,a){if(!b.isNullOrEmptyString(a.newObjectServerTypeFullName))c.newObject=function(b){return p.createTopLevelServiceObject(c,b,a.newObjectServerTypeFullName,(a.behaviorFlags&1)!==0,a.newObjectApiFlags)}};a.prototype.buildSetMockData=function(d,a){var c=this;if(a.behaviorFlags&1){var e=c.hasIndexMethod(a);d.prototype.setMockData=function(f){var d=this;b.setMockData(d,f,function(b,f){return p.createChildItemObject(c.getFunction(a.childItemTypeFullName),e,d,b,f)},function(a){d.m__items=a})}}else d.prototype.setMockData=function(a){b.setMockData(this,a)}};a.prototype.buildEnsureUnchanged=function(a,b){a.prototype.ensureUnchanged=function(a){p.invokeEnsureUnchanged(this,a)}};a.prototype.buildUpdate=function(a,b){a.prototype.update=function(a){this._recursivelyUpdate(a)}};a.prototype.buildSet=function(f,a){if((a.behaviorFlags&1)!==0)return;var c=[],e=[];if(a.scalarProperties)for(var b=0;b<a.scalarProperties.length;b++)if((a.scalarProperties[b].behaviorFlags&2)===0&&(a.scalarProperties[b].behaviorFlags&1)!==0)e.push(a.scalarProperties[b].name);else c.push(a.scalarProperties[b].name);var d=[];if(a.navigationProperties)for(var b=0;b<a.navigationProperties.length;b++)if((a.navigationProperties[b].behaviorFlags&16)!==0)c.push(a.navigationProperties[b].name);else if((a.navigationProperties[b].behaviorFlags&1)===0)c.push(a.navigationProperties[b].name);else if((a.navigationProperties[b].behaviorFlags&32)===0)c.push(a.navigationProperties[b].name);else d.push(a.navigationProperties[b].name);if(d.length===0&&e.length===0)return;f.prototype.set=function(a,b){this._recursivelySet(a,b,e,d,c)}};a.prototype.buildItems=function(c,a){if((a.behaviorFlags&1)===0)return;Object.defineProperty(c.prototype,"items",{"get":function(){b.throwIfNotLoaded("items",this.m__items,a.name,this._isNull);return this.m__items},enumerable:true,configurable:true})};a.prototype.buildToJSON=function(d,a){var c=this;if((a.behaviorFlags&1)!==0){d.prototype.toJSON=function(){return b.toJson(this,{},{},this.m__items)};return}else d.prototype.toJSON=function(){var e={};if(a.scalarProperties)for(var d=0;d<a.scalarProperties.length;d++)if((a.scalarProperties[d].behaviorFlags&1)!==0)e[a.scalarProperties[d].name]=this[c.getFieldName(a.scalarProperties[d])];var f={};if(a.navigationProperties)for(var d=0;d<a.navigationProperties.length;d++)if((a.navigationProperties[d].behaviorFlags&1)!==0)f[a.navigationProperties[d].name]=this[c.getFieldName(a.navigationProperties[d])];return b.toJson(this,e,f)}};a.prototype.buildTypeMetadataInfo=function(c,a){Object.defineProperty(c.prototype,"_className",{"get":function(){return a.name},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"_isCollection",{"get":function(){return(a.behaviorFlags&1)!==0},enumerable:true,configurable:true});!b.isNullOrEmptyString(a.collectionPropertyPath)&&Object.defineProperty(c.prototype,"_collectionPropertyPath",{"get":function(){return a.collectionPropertyPath},enumerable:true,configurable:true});if(a.scalarProperties&&a.scalarProperties.length>0){Object.defineProperty(c.prototype,"_scalarPropertyNames",{"get":function(){if(!this.m__scalarPropertyNames)this.m__scalarPropertyNames=a.scalarProperties.map(function(a){return a.name});return this.m__scalarPropertyNames},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"_scalarPropertyOriginalNames",{"get":function(){if(!this.m__scalarPropertyOriginalNames)this.m__scalarPropertyOriginalNames=a.scalarProperties.map(function(a){return a.originalName});return this.m__scalarPropertyOriginalNames},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"_scalarPropertyUpdateable",{"get":function(){if(!this.m__scalarPropertyUpdateable)this.m__scalarPropertyUpdateable=a.scalarProperties.map(function(a){return(a.behaviorFlags&2)===0});return this.m__scalarPropertyUpdateable},enumerable:true,configurable:true})}a.navigationProperties&&a.navigationProperties.length>0&&Object.defineProperty(c.prototype,"_navigationPropertyNames",{"get":function(){if(!this.m__navigationPropertyNames)this.m__navigationPropertyNames=a.navigationProperties.map(function(a){return a.name});return this.m__navigationPropertyNames},enumerable:true,configurable:true})};a.prototype.buildTrackUntrack=function(a,b){if(b.behaviorFlags&2){a.prototype.track=function(){this.context.trackedObjects.add(this);return this};a.prototype.untrack=function(){this.context.trackedObjects.remove(this);return this}}};a.prototype.buildMixin=function(d,a){if(a.behaviorFlags&4){var c=this.getFunction(a.name+"Custom");b.applyMixin(d,c)}};a.prototype.getOnEventName=function(a){if(a[0]==="_")return"_on"+a.substr(1);return"on"+a};a.prototype.buildEvents=function(d,b){if(b.events)for(var c=0;c<b.events.length;c++){var a=b.events[c];if(Array.isArray(a)){this.ensureArraySize(a,7);b.events[c]={name:this.getString(a[0]),behaviorFlags:a[1],apiSetInfoOrdinal:a[2],typeExpression:this.getString(a[3]),targetIdExpression:this.getString(a[4]),register:this.getString(a[5]),unregister:this.getString(a[6])}}this.buildEvent(d,b,b.events[c])}};a.prototype.buildEvent=function(c,b,a){if(a.behaviorFlags&1)this.buildV0Event(c,b,a);else this.buildV2Event(c,b,a)};a.prototype.buildV2Event=function(h,f,c){var d=this,g=this.getOnEventName(c.name),e=this.getFieldName(c);Object.defineProperty(h.prototype,g,{"get":function(){if(!this[e]){d.throwIfApiNotSupported(f,c);var g=this,j=null;if(c.register!=="null")j=this[c.register].bind(this);var i=null;if(c.unregister!=="null")i=this[c.unregister].bind(this);var l=function(){return d.evaluateEventTargetId(c.targetIdExpression,g)},h=null;if(c.behaviorFlags&2)h=d.getFunction(a.CustomizationCodeNamespace+"."+f.name+"_"+c.name+"_EventArgsTransform");var k=function(a){if(h)a=h.call(g,g,a);return b._createPromiseFromResult(a)},m=d.evaluateEventType(c.typeExpression);this[e]=new T(this.context,this,c.name,{eventType:m,getTargetIdFunc:l,registerFunc:j,unregisterFunc:i,eventArgsTransformFunc:k})}return this[e]},enumerable:true,configurable:true})};a.prototype.buildV0Event=function(h,f,c){var d=this,g=this.getOnEventName(c.name),e=this.getFieldName(c);Object.defineProperty(h.prototype,g,{"get":function(){if(!this[e]){d.throwIfApiNotSupported(f,c);var g=this,i=null;if(b.isNullOrEmptyString(c.register)){var l=d.evaluateEventType(c.typeExpression);i=function(a){var b=d.evaluateEventTargetId(c.targetIdExpression,g);return g.context.eventRegistration.register(l,b,a)}}else if(c.register!=="null"){var n=d.getFunction(c.register);i=function(a){return n.call(g,g,a)}}var h=null;if(b.isNullOrEmptyString(c.unregister)){var m=d.evaluateEventType(c.typeExpression);h=function(a){var b=d.evaluateEventTargetId(c.targetIdExpression,g);return g.context.eventRegistration.unregister(m,b,a)}}else if(c.unregister!=="null"){var o=d.getFunction(c.unregister);h=function(a){return o.call(g,g,a)}}var j=null;if(c.behaviorFlags&2)j=d.getFunction(a.CustomizationCodeNamespace+"."+f.name+"_"+c.name+"_EventArgsTransform");var k=function(a){if(j)a=j.call(g,g,a);return b._createPromiseFromResult(a)};this[e]=new P(this.context,this,c.name,{registerFunc:i,unregisterFunc:h,eventArgsTransformFunc:k})}return this[e]},enumerable:true,configurable:true})};a.prototype.hasIndexMethod=function(a){var c=false;if(a.navigationMethods)for(var b=0;b<a.navigationMethods.length;b++)if((a.navigationMethods[b].behaviorFlags&16)!==0){c=true;break}return c};a.CustomizationCodeNamespace="_CC";return a}();c.LibraryBuilder=kb;var V=1,G={invokeRequestModifier:function(a){a.DdaMethod.Version=V;return a},invokeResponseModifier:function(a){V=a.Version;if(a.Error){a.error={};a.error.Code=a.Error}return a}},h;(function(a){a.SendingId="sId";a.RespondingId="rId";a.CommandKey="command";a.SessionInfoKey="sessionInfo";a.ParamsKey="params";a.ApiReadyCommand="apiready";a.ExecuteMethodCommand="executeMethod";a.GetAppContextCommand="getAppContext";a.RegisterEventCommand="registerEvent";a.UnregisterEventCommand="unregisterEvent";a.FireEventCommand="fireEvent"})(h||(h={}));var w=function(){function a(){}a.sessionContext="sc";a.embeddingPageOrigin="EmbeddingPageOrigin";a.embeddingPageSessionInfo="EmbeddingPageSessionInfo";return a}();c.EmbeddedConstants=w;var ib=function(d){__extends(c,d);function c(c,b){var a=d.call(this)||this;a.m_chosenWindow=null;a.m_chosenOrigin=null;a.m_enabled=true;a.m_onMessageHandler=a._onMessage.bind(a);a.m_callbackList={};a.m_id=0;a.m_timeoutId=-1;a.m_appContext=null;a.m_url=c;a.m_options=b;if(!a.m_options)a.m_options={sessionKey:Math.random().toString()};if(!a.m_options.sessionKey)a.m_options.sessionKey=Math.random().toString();if(!a.m_options.container)a.m_options.container=document.body;if(!a.m_options.timeoutInMilliseconds)a.m_options.timeoutInMilliseconds=6e4;if(!a.m_options.height)a.m_options.height="400px";if(!a.m_options.width)a.m_options.width="100%";if(!(a.m_options.webApplication&&a.m_options.webApplication.accessToken&&a.m_options.webApplication.accessTokenTtl))a.m_options.webApplication=null;return a}c.prototype._getIFrameSrc=function(){var e=window.location.protocol+"//"+window.location.host,b=w.embeddingPageOrigin+"="+encodeURIComponent(e)+"&"+w.embeddingPageSessionInfo+"="+encodeURIComponent(this.m_options.sessionKey),d=false;if(this.m_url.toLowerCase().indexOf("/_layouts/preauth.aspx")>0||this.m_url.toLowerCase().indexOf("/_layouts/15/preauth.aspx")>0)d=true;var a=document.createElement("a");a.href=this.m_url;if(this.m_options.webApplication){var c=w.embeddingPageOrigin+"="+e+"&"+w.embeddingPageSessionInfo+"="+this.m_options.sessionKey;if(a.search.length===0||a.search==="?")a.search="?"+w.sessionContext+"="+encodeURIComponent(c);else a.search=a.search+"&"+w.sessionContext+"="+encodeURIComponent(c)}else if(d)if(a.hash.length===0||a.hash==="#")a.hash="#"+b;else a.hash=a.hash+"&"+b;else if(a.search.length===0||a.search==="?")a.search="?"+b;else a.search=a.search+"&"+b;var f=a.href;return f};c.prototype.init=function(){var c=this;window.addEventListener("message",this.m_onMessageHandler);var d=this._getIFrameSrc();return a.createPromise(function(k,l){var e=document.createElement("iframe");if(c.m_options.id){e.id=c.m_options.id;e.name=c.m_options.id}e.style.height=c.m_options.height;e.style.width=c.m_options.width;if(!c.m_options.webApplication){e.src=d;c.m_options.container.appendChild(e)}else{var f=document.createElement("form");f.setAttribute("action",d);f.setAttribute("method","post");f.setAttribute("target",e.name);c.m_options.container.appendChild(f);var j=document.createElement("input");j.setAttribute("type","hidden");j.setAttribute("name","access_token");j.setAttribute("value",c.m_options.webApplication.accessToken);f.appendChild(j);var h=document.createElement("input");h.setAttribute("type","hidden");h.setAttribute("name","access_token_ttl");h.setAttribute("value",c.m_options.webApplication.accessTokenTtl);f.appendChild(h);c.m_options.container.appendChild(e);f.submit()}c.m_timeoutId=window.setTimeout(function(){c.close();var d=b.createRuntimeError(g.timeout,a._getResourceString(i.timeout),"EmbeddedSession.init");l(d)},c.m_options.timeoutInMilliseconds);c.m_promiseResolver=k})};c.prototype._invoke=function(c,b,a){if(!this.m_enabled){b(5001,null);return}if(G.invokeRequestModifier)a=G.invokeRequestModifier(a);this._sendMessageWithCallback(this.m_id++,c,a,function(a){if(G.invokeResponseModifier)a=G.invokeResponseModifier(a);var c=a.Error;delete a.Error;b(c||0,a)})};c.prototype.close=function(){window.removeEventListener("message",this.m_onMessageHandler);window.clearTimeout(this.m_timeoutId);this.m_enabled=false};Object.defineProperty(c.prototype,"eventRegistration",{"get":function(){if(!this.m_sessionEventManager)this.m_sessionEventManager=new N(this._registerEventImpl.bind(this),this._unregisterEventImpl.bind(this));return this.m_sessionEventManager},enumerable:true,configurable:true});c.prototype._createRequestExecutorOrNull=function(){return new eb(this)};c.prototype._resolveRequestUrlAndHeaderInfo=function(){return a._createPromiseFromResult(null)};c.prototype._registerEventImpl=function(d,c){var b=this;return a.createPromise(function(a,e){b._sendMessageWithCallback(b.m_id++,h.RegisterEventCommand,{EventId:d,TargetId:c},function(){a(null)})})};c.prototype._unregisterEventImpl=function(d,c){var b=this;return a.createPromise(function(a,e){b._sendMessageWithCallback(b.m_id++,h.UnregisterEventCommand,{EventId:d,TargetId:c},function(){a()})})};c.prototype._onMessage=function(b){var c=this;if(!this.m_enabled)return;if(this.m_chosenWindow&&(this.m_chosenWindow!==b.source||this.m_chosenOrigin!==b.origin))return;var a=b.data;if(a&&a[h.CommandKey]===h.ApiReadyCommand){if(!this.m_chosenWindow&&this._isValidDescendant(b.source)&&a[h.SessionInfoKey]===this.m_options.sessionKey){this.m_chosenWindow=b.source;this.m_chosenOrigin=b.origin;this._sendMessageWithCallback(this.m_id++,h.GetAppContextCommand,null,function(a){c._setupContext(a);window.clearTimeout(c.m_timeoutId);c.m_promiseResolver()})}return}if(a&&a[h.CommandKey]===h.FireEventCommand){var d=a[h.ParamsKey],k=d.EventId,j=d.TargetId,l=d.Data;if(this.m_sessionEventManager)for(var g=this.m_sessionEventManager.getHandlers(k,j),e=0;e<g.length;e++)g[e](l);return}if(a&&a.hasOwnProperty(h.RespondingId)){var i=a[h.RespondingId],f=this.m_callbackList[i];typeof f==="function"&&f(a[h.ParamsKey]);delete this.m_callbackList[i]}};c.prototype._sendMessageWithCallback=function(b,d,e,c){this.m_callbackList[b]=c;var a={};a[h.SendingId]=b;a[h.CommandKey]=d;a[h.ParamsKey]=e;this.m_chosenWindow.postMessage(JSON.stringify(a),this.m_chosenOrigin)};c.prototype._isValidDescendant=function(f){var d=this.m_options.container||document.body;function b(a){if(a===f)return true;for(var c=0,d=a.frames.length;c<d;c++)if(b(a.frames[c]))return true;return false}for(var c=d.getElementsByTagName("iframe"),a=0,e=c.length;a<e;a++)if(b(c[a].contentWindow))return true;return false};c.prototype._setupContext=function(a){if(!(this.m_appContext=a))return};return c}(u);c.EmbeddedSession=ib;var eb=function(){function b(a){this.m_session=a}b.prototype.executeAsync=function(f,e,d){var g=this,c=k.buildMessageArrayForIRequestExecutor(f,e,d,b.SourceLibHeaderValue);return a.createPromise(function(d,e){g.m_session._invoke(h.ExecuteMethodCommand,function(e,b){a.log("Response:");a.log(JSON.stringify(b));var c;if(e==0)c=k.buildResponseOnSuccess(k.getResponseBodyFromSafeArray(b.Data),k.getResponseHeadersFromSafeArray(b.Data));else c=k.buildResponseOnError(b.error.Code,b.error.Message);d(c)},b._transformMessageArrayIntoParams(c))})};b._transformMessageArrayIntoParams=function(a){return{ArrayData:a,DdaMethod:{DispatchId:b.DispidExecuteRichApiRequestMethod}}};b.DispidExecuteRichApiRequestMethod=93;b.SourceLibHeaderValue="Embedded";return b}()})(OfficeExtension||(OfficeExtension={}));var __extends=this&&this.__extends||function(){var a=function(c,b){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(c,a){for(var b in a)if(a.hasOwnProperty(b))c[b]=a[b]};return a(c,b)};return function(c,b){a(c,b);function d(){this.constructor=c}c.prototype=b===null?Object.create(b):(d.prototype=b.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(d,c,b,a){return new(b||(b=Promise))(function(i,f){function g(b){try{e(a.next(b))}catch(c){f(c)}}function h(b){try{e(a["throw"](b))}catch(c){f(c)}}function e(a){a.done?i(a.value):new b(function(b){b(a.value)}).then(g,h)}e((a=a.apply(d,c||[])).next())})},__generator=this&&this.__generator||function(g,h){var b={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},e,c,a,f;return f={next:d(0),"throw":d(1),"return":d(2)},typeof Symbol==="function"&&(f[Symbol.iterator]=function(){return this}),f;function d(a){return function(b){return i([a,b])}}function i(d){if(e)throw new TypeError("Generator is already executing.");while(b)try{if(e=1,c&&(a=d[0]&2?c["return"]:d[0]?c["throw"]||((a=c["return"])&&a.call(c),0):c.next)&&!(a=a.call(c,d[1])).done)return a;if(c=0,a)d=[d[0]&2,a.value];switch(d[0]){case 0:case 1:a=d;break;case 4:b.label++;return{value:d[1],done:false};case 5:b.label++;c=d[1];d=[0];continue;case 7:d=b.ops.pop();b.trys.pop();continue;default:if(!(a=b.trys,a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){b=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){b.label=d[1];break}if(d[0]===6&&b.label<a[1]){b.label=a[1];a=d;break}if(a&&b.label<a[2]){b.label=a[2];b.ops.push(d);break}a[2]&&b.ops.pop();b.trys.pop();continue}d=h.call(g,b)}catch(f){d=[6,f];c=0}finally{e=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:true}}},OfficeCore;(function(b){var x="OfficeCore",r="AgaveVisualApi",o=OfficeExtension.BatchApiHelper.createPropertyObject,q=OfficeExtension.BatchApiHelper.createMethodObject,p=OfficeExtension.BatchApiHelper.createIndexerObject,k=OfficeExtension.BatchApiHelper.createRootServiceObject,c=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,m=OfficeExtension.BatchApiHelper.createChildItemObject,a=OfficeExtension.BatchApiHelper.invokeMethod,n=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,s=OfficeExtension.BatchApiHelper.invokeSetProperty,g=OfficeExtension.Utility.isNullOrUndefined,v=OfficeExtension.Utility.isUndefined,u=OfficeExtension.Utility.throwIfNotLoaded,l=OfficeExtension.Utility.throwIfApiNotSupported,z=OfficeExtension.Utility.load,y=OfficeExtension.Utility.retrieve,h=OfficeExtension.Utility.toJson,d=OfficeExtension.Utility.fixObjectPathIfNecessary,j=OfficeExtension.Utility._handleNavigationPropertyResults,t=OfficeExtension.Utility.adjustToDateTime,e=OfficeExtension.Utility.processRetrieveResult,w="BiShim",i=function(i){__extends(f,i);function f(){return i!==null&&i.apply(this,arguments)||this}Object.defineProperty(f.prototype,"_className",{"get":function(){return"BiShim"},enumerable:true,configurable:true});f.prototype.initialize=function(b){a(this,"Initialize",0,[b],0,0)};f.prototype.getData=function(){return a(this,"getData",1,[],4,0)};f.prototype.setVisualObjects=function(b){a(this,"setVisualObjects",0,[b],2,0)};f.prototype.setVisualObjectsToPersist=function(b){a(this,"setVisualObjectsToPersist",0,[b],2,0)};f.prototype._handleResult=function(a){i.prototype._handleResult.call(this,a);if(g(a))return;var b=a;d(this,b)};f.prototype._handleRetrieveResult=function(b,a){i.prototype._handleRetrieveResult.call(this,b,a);e(this,b,a)};f.newObject=function(a){return c(b.BiShim,a,"Microsoft.AgaveVisual.BiShim",false,4)};f.prototype.toJSON=function(){return h(this,{},{})};return f}(OfficeExtension.ClientObject);b.BiShim=i;var f;(function(a){a.generalException1="GeneralException"})(f=b.AgaveVisualErrorCodes||(b.AgaveVisualErrorCodes={}))})(OfficeCore||(OfficeCore={}));var OfficeCore;(function(a){var C="OfficeCore",z="ExperimentApi",w=OfficeExtension.BatchApiHelper.createPropertyObject,e=OfficeExtension.BatchApiHelper.createMethodObject,y=OfficeExtension.BatchApiHelper.createIndexerObject,t=OfficeExtension.BatchApiHelper.createRootServiceObject,h=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,v=OfficeExtension.BatchApiHelper.createChildItemObject,b=OfficeExtension.BatchApiHelper.invokeMethod,i=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,A=OfficeExtension.BatchApiHelper.invokeSetProperty,f=OfficeExtension.Utility.isNullOrUndefined,m=OfficeExtension.Utility.isUndefined,k=OfficeExtension.Utility.throwIfNotLoaded,u=OfficeExtension.Utility.throwIfApiNotSupported,r=OfficeExtension.Utility.load,p=OfficeExtension.Utility.retrieve,g=OfficeExtension.Utility.toJson,c=OfficeExtension.Utility.fixObjectPathIfNecessary,s=OfficeExtension.Utility._handleNavigationPropertyResults,B=OfficeExtension.Utility.adjustToDateTime,d=OfficeExtension.Utility.processRetrieveResult,x="FlightingService",l=function(j){__extends(i,j);function i(){return j!==null&&j.apply(this,arguments)||this}Object.defineProperty(i.prototype,"_className",{"get":function(){return"FlightingService"},enumerable:true,configurable:true});i.prototype.getClientSessionId=function(){return b(this,"GetClientSessionId",1,[],4,0)};i.prototype.getDeferredFlights=function(){return b(this,"GetDeferredFlights",1,[],4,0)};i.prototype.getFeature=function(d,f,c,b){return e(a.ABType,this,"GetFeature",1,[d,f,c,b],false,false,null,4)};i.prototype.getFeatureGate=function(b,c){return e(a.ABType,this,"GetFeatureGate",1,[b,c],false,false,null,4)};i.prototype.resetOverride=function(a){b(this,"ResetOverride",0,[a],0,0)};i.prototype.setOverride=function(a,d,c){b(this,"SetOverride",0,[a,d,c],0,0)};i.prototype._handleResult=function(a){j.prototype._handleResult.call(this,a);if(f(a))return;var b=a;c(this,b)};i.prototype._handleRetrieveResult=function(b,a){j.prototype._handleRetrieveResult.call(this,b,a);d(this,b,a)};i.newObject=function(b){return h(a.FlightingService,b,"Microsoft.Experiment.FlightingService",false,4)};i.prototype.toJSON=function(){return g(this,{},{})};return i}(OfficeExtension.ClientObject);a.FlightingService=l;var o="ABType",q=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"ABType"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["value"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"value",{"get":function(){k("value",this._V,o,this._isNull);return this._V},enumerable:true,configurable:true});a.prototype._handleResult=function(a){b.prototype._handleResult.call(this,a);if(f(a))return;var d=a;c(this,d);if(!m(d.Value))this._V=d.Value};a.prototype.load=function(a){return r(this,a)};a.prototype.retrieve=function(a){return p(this,a)};a.prototype._handleRetrieveResult=function(c,a){b.prototype._handleRetrieveResult.call(this,c,a);d(this,c,a)};a.prototype.toJSON=function(){return g(this,{value:this._V},{})};a.prototype.ensureUnchanged=function(a){i(this,a);return};return a}(OfficeExtension.ClientObject);a.ABType=q;var n;(function(a){a["boolean"]="Boolean";a.integer="Integer";a.string="String"})(n=a.FeatureType||(a.FeatureType={}));var j;(function(a){a.generalException="GeneralException"})(j=a.ExperimentErrorCodes||(a.ExperimentErrorCodes={}))})(OfficeCore||(OfficeCore={}));var OfficeCore;(function(a){a.OfficeOnlineDomainList=["*.dod.online.office365.us","*.gov.online.office365.us","*.officeapps-df.live.com","*.officeapps.live.com","*.online.office.de","*.partner.officewebapps.cn"];function b(){if(typeof window.external==="undefined"||typeof window.external.GetContext==="undefined"){var d=OSF.getClientEndPoint()._targetUrl,b=c(d);if(d.indexOf("https:")!=0)return false;a.OfficeOnlineDomainList.forEach(function(a){if(a.indexOf("*.")==0)a=a.substring(2);if(b.indexOf(a)==b.length-a.length)return true});return false}return true}a.isHostOriginTrusted=b;function c(b){var a="";a=b.split("/")[2];a=a.split(":")[0];a=a.split("?")[0];return a}})(OfficeCore||(OfficeCore={}));var OfficeCore;(function(a){var b=function(){function b(a){this.context=a}Object.defineProperty(b.prototype,"roamingSettings",{"get":function(){if(!this.m_roamingSettings)this.m_roamingSettings=a.AuthenticationService.newObject(this.context).roamingSettings;return this.m_roamingSettings},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"tap",{"get":function(){if(!this.m_tap)this.m_tap=a.Tap.newObject(this.context);return this.m_tap},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"skill",{"get":function(){if(!this.m_skill)this.m_skill=a.Skill.newObject(this.context);return this.m_skill},enumerable:true,configurable:true});return b}();a.FirstPartyApis=b;var c=function(d){__extends(c,d);function c(a){return d.call(this,a)||this}Object.defineProperty(c.prototype,"firstParty",{"get":function(){if(!this.m_firstPartyApis)this.m_firstPartyApis=new b(this);return this.m_firstPartyApis},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"flighting",{"get":function(){return this.flightingService},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"telemetry",{"get":function(){if(!this.m_telemetry)this.m_telemetry=a.TelemetryService.newObject(this);return this.m_telemetry},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"bi",{"get":function(){if(!this.m_biShim)this.m_biShim=a.BiShim.newObject(this);return this.m_biShim},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"flightingService",{"get":function(){if(!this.m_flightingService)this.m_flightingService=a.FlightingService.newObject(this);return this.m_flightingService},enumerable:true,configurable:true});return c}(OfficeExtension.ClientRequestContext);a.RequestContext=c;function d(b,c){return OfficeExtension.ClientRequestContext._runBatch("OfficeCore.run",arguments,function(b){return new a.RequestContext(b)})}a.run=d})(OfficeCore||(OfficeCore={}));var OfficeCore;(function(a){var x="Office",p="OfficeSharedApi",m=OfficeExtension.BatchApiHelper.createPropertyObject,o=OfficeExtension.BatchApiHelper.createMethodObject,n=OfficeExtension.BatchApiHelper.createIndexerObject,h=OfficeExtension.BatchApiHelper.createRootServiceObject,f=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,j=OfficeExtension.BatchApiHelper.createChildItemObject,u=OfficeExtension.BatchApiHelper.invokeMethod,k=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,q=OfficeExtension.BatchApiHelper.invokeSetProperty,r=OfficeExtension.Utility.isNullOrUndefined,v=OfficeExtension.Utility.isUndefined,t=OfficeExtension.Utility.throwIfNotLoaded,i=OfficeExtension.Utility.throwIfApiNotSupported,B=OfficeExtension.Utility.load,y=OfficeExtension.Utility.retrieve,A=OfficeExtension.Utility.toJson,g=OfficeExtension.Utility.fixObjectPathIfNecessary,e=OfficeExtension.Utility._handleNavigationPropertyResults,s=OfficeExtension.Utility.adjustToDateTime,l=OfficeExtension.Utility.processRetrieveResult,w=OfficeExtension.Utility.setMockData,d;(function(b){function a(c,a){var b={type:a.type,data:a.data};return b}b.Skill_HostSkillEvent_EventArgsTransform=a})(d=a._CC||(a._CC={}));var c;(function(a){a.generalException="GeneralException"})(c=a.SkillErrorCodes||(a.SkillErrorCodes={}));var b={version:"1.0.0",name:"OfficeCore",defaultApiSetName:"OfficeSharedApi",hostName:"Office",apiSets:[],strings:["Skill","registerHostSkillEvent","unregisterHostSkillEvent"],enumTypes:[],clientObjectTypes:[[1,0,0,0,[["executeAction",3,2,0,5],["notifyPaneEvent",2,2,0,5],[2,0,0,0,1],[3,0,0,0,1],["testFireEvent",0,0,0,1]],0,0,0,[["HostSkillEvent",2,0,"RichApiMessageEventType.skillRichApiMessageEvent","",2,3]],"Microsoft.SkillApi.Skill",4]]},z=new OfficeExtension.LibraryBuilder({metadata:b,targetNamespaceObject:a})})(OfficeCore||(OfficeCore={}));var OfficeCore;(function(a){var y="OfficeCore",t="TelemetryApi",p=OfficeExtension.BatchApiHelper.createPropertyObject,s=OfficeExtension.BatchApiHelper.createMethodObject,r=OfficeExtension.BatchApiHelper.createIndexerObject,l=OfficeExtension.BatchApiHelper.createRootServiceObject,b=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,n=OfficeExtension.BatchApiHelper.createChildItemObject,i=OfficeExtension.BatchApiHelper.invokeMethod,o=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,u=OfficeExtension.BatchApiHelper.invokeSetProperty,f=OfficeExtension.Utility.isNullOrUndefined,x=OfficeExtension.Utility.isUndefined,w=OfficeExtension.Utility.throwIfNotLoaded,m=OfficeExtension.Utility.throwIfApiNotSupported,A=OfficeExtension.Utility.load,z=OfficeExtension.Utility.retrieve,j=OfficeExtension.Utility.toJson,c=OfficeExtension.Utility.fixObjectPathIfNecessary,k=OfficeExtension.Utility._handleNavigationPropertyResults,v=OfficeExtension.Utility.adjustToDateTime,d=OfficeExtension.Utility.processRetrieveResult,q="TelemetryService",g=function(g){__extends(e,g);function e(){return g!==null&&g.apply(this,arguments)||this}Object.defineProperty(e.prototype,"_className",{"get":function(){return"TelemetryService"},enumerable:true,configurable:true});e.prototype.sendTelemetryEvent=function(a,d,b,c,e){i(this,"SendTelemetryEvent",1,[a,d,b,c,e],4,0)};e.prototype._handleResult=function(a){g.prototype._handleResult.call(this,a);if(f(a))return;var b=a;c(this,b)};e.prototype._handleRetrieveResult=function(b,a){g.prototype._handleRetrieveResult.call(this,b,a);d(this,b,a)};e.newObject=function(c){return b(a.TelemetryService,c,"Microsoft.Telemetry.TelemetryService",false,4)};e.prototype.toJSON=function(){return j(this,{},{})};return e}(OfficeExtension.ClientObject);a.TelemetryService=g;var h;(function(a){a.unset="Unset";a.string="String";a["boolean"]="Boolean";a.int64="Int64";a["double"]="Double"})(h=a.DataFieldType||(a.DataFieldType={}));var e;(function(a){a.generalException="GeneralException"})(e=a.TelemetryErrorCodes||(a.TelemetryErrorCodes={}))})(OfficeCore||(OfficeCore={}));var OfficeFirstPartyAuth;(function(a){var c=function(){function a(){}a.GetAuthContextAsyncMissing="GetAuthContextAsyncMissing";a.CannotGetAuthContext="CannotGetAuthContext";a.PackageNotLoaded="PackageNotLoaded";a.FailedToLoad="FailedToLoad";return a}(),d="officeWebAuthReplyUrls",e=false,b;a.debugging=false;function g(f){return new OfficeExtension.CoreUtility.Promise(function(h,g){if(OSF.WebAuth&&OSF._OfficeAppFactory.getHostInfo().hostPlatform=="web")try{(!Office||!Office.context||!Office.context.webAuth)&&g({code:c.GetAuthContextAsyncMissing,message:Strings&&Strings.OfficeOM.L_ImplicitGetAuthContextMissing?Strings.OfficeOM.L_ImplicitGetAuthContextMissing:""});Office.context.webAuth.getAuthContextAsync(function(k){if(k.status==="succeeded"){e=true;var i=k.value;if(!i||i.isAnonymous)return false;var p=i.authorityType.toLowerCase()==="msa";OSF.WebAuth.config={idp:i.authorityType.toLowerCase(),appIds:[p?i.msaAppId?i.msaAppId:i.appId:i.appId],authority:a.authorityOverride&&a.debugging?a.authorityOverride:i.authority,redirectUri:f?f:null,upn:i.upn,enableConsoleLogging:a.debugging,telemetryInstance:"otel",telemetry:{HashedUserId:i.userId}};var n=false,o=OSF.WebAuth.load(function(a){if(a){n=true;h()}g({code:c.PackageNotLoaded,message:Strings&&Strings.OfficeOM.L_ImplicitNotLoaded?Strings.OfficeOM.L_ImplicitNotLoaded:""})});l(o,n);var m=f?f:window.location.href.split("?")[0],j=sessionStorage.getItem(d);if(j||j==="")j=m;else j+=", "+m;sessionStorage.setItem(d,j)}else{e=false;OSF.WebAuth.config=null;b=JSON.stringify(k);g({code:c.FailedToLoad,message:b})}})}catch(i){e=false;OSF.WebAuth.config=null;b=i;OSF.WebAuth.load(function(a){a&&h();g({code:c.FailedToLoad,message:b})})}else h()})}a.load=g;function j(c,a){if(OSF.WebAuth&&OSF.WebAuth.loaded&&OSF._OfficeAppFactory.getHostInfo().hostPlatform=="web")return new OfficeExtension.CoreUtility.Promise(function(d,e){a&&a.forceRefresh&&OSF.WebAuth.clearCache();var b=OSF.WebAuth.config.idp.toLowerCase()=="msa"?OfficeCore.IdentityType.microsoftAccount:OfficeCore.IdentityType.organizationAccount;OSF.WebAuth.config.appIds[0]&&OSF.WebAuth.getToken(c.resource,OSF.WebAuth.config.appIds[0],OSF._OfficeAppFactory.getHostInfo().osfControlAppCorrelationId,a&&a.popup?a.popup:null).then(function(e){f(e,true,c.resource,a&&a.popup?a.popup:null);d({accessToken:e.Token,tokenIdenityType:b})}).catch(function(b){f(b,false,c.resource,a&&a.popup?a.popup:null,b.ErrorCode);e({code:b.ErrorCode,message:b.ErrorMessage})})});var b=new OfficeCore.RequestContext,d=OfficeCore.AuthenticationService.newObject(b);b._customData="WacPartition";if(OSF._OfficeAppFactory.getHostInfo().hostPlatform=="web"&&OSF._OfficeAppFactory.getHostInfo().hostType=="word"){var e=d.getAccessToken(c,null);return b.sync().then(function(){return e.value})}else return new OfficeExtension.CoreUtility.Promise(function(e,a){var f=d.onTokenReceived.add(function(c){if(!OfficeExtension.CoreUtility.isNullOrUndefined(c)){f.remove();b.sync().catch(function(){});if(c.code==0)e(c.tokenValue);else if(OfficeExtension.CoreUtility.isNullOrUndefined(c.errorInfo))a({code:c.code});else try{a(JSON.parse(c.errorInfo))}catch(d){a({code:c.code,message:c.errorInfo})}}return null});b.sync().then(function(){var a=d.getAccessToken(c,d._targetId);return b.sync().then(function(){if(OfficeExtension.CoreUtility.isNullOrUndefined(a.value))return null;var b=a.value.accessToken;!OfficeExtension.CoreUtility.isNullOrUndefined(b)&&e(a.value)})}).catch(function(b){a(b)})})}a.getAccessToken=j;function i(){var a=new OfficeCore.RequestContext,c=OfficeCore.AuthenticationService.newObject(a);a._customData="WacPartition";var b=c.getPrimaryIdentityInfo();return a.sync().then(function(){return b.value})}a.getPrimaryIdentityInfo=i;function k(){var a=new OfficeCore.RequestContext,b=OfficeCore.AuthenticationService.newObject(a),c=b.getIdentities();return a.sync().then(function(){return c.value})}a.getIdentities=k;function l(b,c){a.debugging&&console.log("Logging Implicit load event");if(typeof OTel!=="undefined")OTel.OTelLogger.onTelemetryLoaded(function(){var d=[oteljs.makeStringDataField("IdentityProvider",OSF.WebAuth.config.idp),oteljs.makeStringDataField("AppId",OSF.WebAuth.config.appIds[0]),oteljs.makeBooleanDataField("Js",typeof Implicit!=="undefined"?true:false),oteljs.makeBooleanDataField("Result",c)];if(OSF.WebAuth.config.telemetry)for(var a in OSF.WebAuth.config.telemetry)d.push(oteljs.makeStringDataField(a,OSF.WebAuth.config.telemetry[a]));if(b&&b.Telemetry)for(var a in b.Telemetry){if(!b.Telemetry[a])continue;switch(a){case"succeeded":d.push(oteljs.makeBooleanDataField(a,b.Telemetry[a]));break;case"loadedApplicationCount":d.push(oteljs.makeInt64DataField(a,b.Telemetry[a]));break;case"timeToLoad":d.push(oteljs.makeInt64DataField(a,b.Telemetry[a]));break;default:d.push(oteljs.makeStringDataField(a,b.Telemetry[a]))}}OTel.OTelLogger.sendTelemetryEvent({eventName:"Office.Extensibility.OfficeJs.OfficeFirstPartyAuth.Load",dataFields:d,eventFlags:{dataCategories:oteljs.DataCategories.ProductServiceUsage}})})}function f(b,d,f,c,e){a.debugging&&console.log("Logging Implicit acquire event");if(typeof OTel!=="undefined")OTel.OTelLogger.onTelemetryLoaded(function(){var g=[oteljs.makeStringDataField("IdentityProvider",OSF.WebAuth.config.idp),oteljs.makeStringDataField("AppId",OSF.WebAuth.config.appIds[0]),oteljs.makeStringDataField("Target",f),oteljs.makeBooleanDataField("Popup",typeof c==="boolean"?c:false),oteljs.makeBooleanDataField("Result",d),oteljs.makeStringDataField("Error",e)];if(OSF.WebAuth.config.telemetry)for(var a in OSF.WebAuth.config.telemetry)g.push(oteljs.makeStringDataField(a,OSF.WebAuth.config.telemetry[a]));if(b&&b.Telemetry)for(var a in b.Telemetry){if(!b.Telemetry[a])continue;switch(a){case"succeeded":g.push(oteljs.makeBooleanDataField(a,b.Telemetry[a]));break;case"timeToGetToken":g.push(oteljs.makeInt64DataField(a,b.Telemetry[a]));break;default:g.push(oteljs.makeStringDataField(a,b.Telemetry[a]))}}OTel.OTelLogger.sendTelemetryEvent({eventName:"Office.Extensibility.OfficeJs.OfficeFirstPartyAuth.GetAccessToken",dataFields:g,eventFlags:{dataCategories:oteljs.DataCategories.ProductServiceUsage}})})}function h(){if(!window.sessionStorage)return;var a=sessionStorage.getItem(d);a!==null&&a.indexOf(window.location.origin+window.location.pathname)!==-1&&g()}window.OSF&&h()})(OfficeFirstPartyAuth||(OfficeFirstPartyAuth={}));var OfficeCore;(function(a){var D="Office",v="OfficeSharedApi",s=OfficeExtension.BatchApiHelper.createPropertyObject,u=OfficeExtension.BatchApiHelper.createMethodObject,t=OfficeExtension.BatchApiHelper.createIndexerObject,n=OfficeExtension.BatchApiHelper.createRootServiceObject,l=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,p=OfficeExtension.BatchApiHelper.createChildItemObject,A=OfficeExtension.BatchApiHelper.invokeMethod,q=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,w=OfficeExtension.BatchApiHelper.invokeSetProperty,x=OfficeExtension.Utility.isNullOrUndefined,B=OfficeExtension.Utility.isUndefined,z=OfficeExtension.Utility.throwIfNotLoaded,o=OfficeExtension.Utility.throwIfApiNotSupported,H=OfficeExtension.Utility.load,E=OfficeExtension.Utility.retrieve,G=OfficeExtension.Utility.toJson,m=OfficeExtension.Utility.fixObjectPathIfNecessary,k=OfficeExtension.Utility._handleNavigationPropertyResults,y=OfficeExtension.Utility.adjustToDateTime,r=OfficeExtension.Utility.processRetrieveResult,C=OfficeExtension.Utility.setMockData,g=function(){function a(){}Object.defineProperty(a.prototype,"_targetId",{"get":function(){if(this.m_targetId==undefined)if(typeof OSF!=="undefined"&&OSF.OUtil)this.m_targetId=OSF.OUtil.Guid.generateNewGuid();else this.m_targetId=""+this.context._nextId();return this.m_targetId},enumerable:true,configurable:true});return a}();a.AuthenticationServiceCustom=g;var e;(function(b){function a(d,c){var a=c,b={tokenValue:a.tokenValue,code:a.code,errorInfo:a.errorInfo};return b}b.AuthenticationService_TokenReceived_EventArgsTransform=a})(e=a._CC||(a._CC={}));var c;(function(a){a[a.immediate=0]="immediate";a[a.load=3]="load"})(c=a.PersonaPromiseType||(a.PersonaPromiseType={}));var b=function(){function a(){}return a}();a.PersonaInfoAndSource=b;var h=function(){function e(){}e.prototype.performAsyncOperation=function(f,e,a,b){var d=this;if(f==c.immediate){a();return}b().then(function(f){if(f)a();else{var c=d;c.load("hostId");c.context.sync().then(function(){var f=c.hostId;d.getPersonaLifetime().then(function(d){var g=function(h){return new OfficeExtension.CoreUtility.Promise(function(j,l){if(h.sendingPersonaHostId==f)for(var i=0;i<h.dataUpdated.length;++i){var k=h.dataUpdated[i];if(e==k){b().then(function(b){if(b){a();d.onPersonaUpdated.remove(g);c.context.sync()}j(b)});return}}j(false)})};d.onPersonaUpdated.add(g);c.context.sync()})})}})};e.prototype.getOrganizationAsync=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(d,g){var c=a,e=function(){var a=c.organization;a.load("*");c.context.sync().then(function(){d(a)})},f=function(){return new OfficeExtension.CoreUtility.Promise(function(b,d){var a=c.organization;a.load("isWarmedUp");c.context.sync().then(function(){b(a.isWarmedUp)})})};a.performAsyncOperation(b,PersonaDataUpdated.organization,e,f)})};e.prototype.getIsPersonaInfoResolvedCheck=function(){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,d){var b=a.personaInfo;b.load("isPersonResolved");a.context.sync().then(function(){c(b.isPersonResolved)})})};e.prototype.getPersonaInfoAsync=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(d,g){var c=a,e=function(){var a=c.personaInfo;a.load();c.context.sync().then(function(){d(a)})},f=function(){return a.getIsPersonaInfoResolvedCheck()};a.performAsyncOperation(b,PersonaDataUpdated.personaInfo,e,f)})};e.prototype.getPersonaInfoWithSourceAsync=function(c){var a=this;return new OfficeExtension.CoreUtility.Promise(function(e,h){var d=a,f=function(){var a=new b;a.info=d.personaInfo;a.info.load();a.source=d.personaInfo.sources;a.source.load();d.context.sync().then(function(){e(a)})},g=function(){return a.getIsPersonaInfoResolvedCheck()};a.performAsyncOperation(c,PersonaDataUpdated.personaInfo,f,g)})};e.prototype.getUnifiedCommunicationInfo=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(d,g){var c=a,e=function(){var a=c.unifiedCommunicationInfo;a.load("*");c.context.sync().then(function(){d(a)})},f=function(){return a.getIsPersonaInfoResolvedCheck()};a.performAsyncOperation(b,PersonaDataUpdated.personaInfo,e,f)})};e.prototype.getUnifiedGroupInfoAsync=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(d,g){var c=a,e=function(){var a=c.unifiedGroupInfo;a.load("*");c.context.sync().then(function(){d(a)})},f=function(){return a.getIsPersonaInfoResolvedCheck()};a.performAsyncOperation(b,PersonaDataUpdated.personaInfo,e,f)})};e.prototype.getTypeAsync=function(c){var b=this;return new OfficeExtension.CoreUtility.Promise(function(e,h){var d=b,f=function(){d.load("type");d.context.sync().then(function(){e(a.PersonaType[d.type.valueOf()])})},g=function(){return b.getIsPersonaInfoResolvedCheck()};b.performAsyncOperation(c,PersonaDataUpdated.personaInfo,f,g)})};e.prototype.getCustomizationsAsync=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(d,g){var c=a,e=function(){var a=c.getCustomizations();c.context.sync().then(function(){d(a.value)})},f=function(){return a.getIsPersonaInfoResolvedCheck()};a.performAsyncOperation(b,PersonaDataUpdated.personaInfo,e,f)})};e.prototype.getMembersAsync=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(d,g){var c=a,e=function(){var a=c.getMembers();a.load("isWarmedUp");c.context.sync().then(function(){d(a)})},f=function(){return new OfficeExtension.CoreUtility.Promise(function(b,d){var a=c.getMembers();a.load("isWarmedUp");c.context.sync().then(function(){b(a.isWarmedUp)})})};a.performAsyncOperation(b,PersonaDataUpdated.members,e,f)})};e.prototype.getMembershipAsync=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(d,g){var c=a,e=function(){var a=c.getMembership();a.load("*");c.context.sync().then(function(){d(a)})},f=function(){return new OfficeExtension.CoreUtility.Promise(function(b){var a=c.getMembership();a.load("isWarmedUp");c.context.sync().then(function(){b(a.isWarmedUp)})})};a.performAsyncOperation(b,PersonaDataUpdated.membership,e,f)})};e.prototype.getPersonaLifetime=function(){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,e){var b=a;b.load("instanceId");b.context.sync().then(function(){var a=new d(b.context,b.instanceId);a.getPersonaLifetime().then(function(a){c(a)})})})};return e}();a.PersonaCustom=h;var d=function(){function b(b,a){this.context=b;this.instanceId=a}Object.defineProperty(b.prototype,"serviceContext",{"get":function(){if(!this.m_serviceConext)this.m_serviceConext=a.ServiceContext.newObject(this.context);return this.m_serviceConext},enumerable:true,configurable:true});b.prototype.getPersonaLifetime=function(){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,d){var b=a.serviceContext.getPersonaLifetime(a.instanceId);a.context.sync().then(function(){b.load("instanceId");a.context.sync().then(function(){c(b)})})})};b.prototype.getInitialPersona=function(){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,d){var b=a.serviceContext.getInitialPersona(a.instanceId);a.context.sync().then(function(){c(b)})})};b.prototype.getLokiTokenProvider=function(){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,d){var b=a.serviceContext.getLokiTokenProvider(a.instanceId);a.context.sync().then(function(){b.load("instanceId");a.context.sync().then(function(){c(b)})})})};return b}();a.PeopleApiContext=d;(function(b){function a(c,b){var a=b;if(a&&a.message)a.visibility=a.message;return a}b.AppRuntimeService_VisibilityChanged_EventArgsTransform=a})(e=a._CC||(a._CC={}));var i;(function(a){a.apiNotAvailable="ApiNotAvailable";a.clientError="ClientError";a.controlIdNotFound="ControlIdNotFound";a.entryIdRequired="EntryIdRequired";a.generalException="GeneralException";a.instanceNotFound="InstanceNotFound";a.interactiveFlowAborted="InteractiveFlowAborted";a.invalidArgument="InvalidArgument";a.invalidGrant="InvalidGrant";a.invalidResourceUrl="InvalidResourceUrl";a.noPhoto="NoPhoto";a.objectNotFound="ObjectNotFound";a.resourceNotSupported="ResourceNotSupported";a.serverError="ServerError";a.ticketInvalidParams="TicketInvalidParams";a.ticketNetworkError="TicketNetworkError";a.ticketUnauthorized="TicketUnauthorized";a.ticketUninitialized="TicketUninitialized";a.ticketUnknownError="TicketUnknownError";a.unexpectedError="UnexpectedError";a.unsupportedUserIdentity="UnsupportedUserIdentity";a.userNotSignedIn="UserNotSignedIn"})(i=a.ErrorCodes||(a.ErrorCodes={}));var j;(function(a){})(j=a.Interfaces||(a.Interfaces={}));var f={version:"1.0.0",name:"OfficeCore",defaultApiSetName:"OfficeSharedApi",hostName:"Office",apiSets:[["1.2","FirstPartyAuthentication"],["1.3","FirstPartyAuthentication"]],strings:["AuthenticationService","RoamingSetting","RoamingSettingCollection","LinkedIn","NetworkUsage","DynamicRibbon","RibbonTab","RibbonButton","RibbonButtonCollection","OfficeServicesManagerApi","Comment","CommentCollection","MemberInfoList","PersonaActions","PersonaInfoSource","PersonaInfo","PersonaUnifiedCommunicationInfo","PersonaPhotoInfo","PersonaCollection","PersonaOrganizationInfo","UnifiedGroupInfo","Persona","PersonaLifetime","LokiTokenProvider","LokiTokenProviderFactory","ServiceContext","Tap","AppRuntimePersistenceService","AppRuntimeService","null","id","getItem","getCount","isWarmedUp","isWarmingUp","displayName","email","emailAddresses","sipAddresses","birthday","birthdays","title","jobInfoDepartment","companyName","office","linkedTitles","linkedDepartments","linkedCompanyNames","linkedOffices","webSites","notes","getImageUri","instanceId","dispose","_RegisterPersonaUpdatedEvent","_UnregisterPersonaUpdatedEvent","this.instanceId","_RegisterLokiTokenAvailableEvent","_UnregisterLokiTokenAvailableEvent","_RegisterIdentityUniqueIdAvailableEvent","_UnregisterIdentityUniqueIdAvailableEvent","getLokiTokenProvider"],enumTypes:[["IdentityType",["organizationAccount","microsoftAccount","unsupported"]],["CommentTextFormat",["plain","markdown","delta"]],["PersonaCardPerfPoint",["placeHolderRendered","initialCardRendered"]],["MessageType",[],{personaLifetimePersonaUpdatedEvent:3502,lokiTokenProviderLokiTokenAvailableEvent:3503,lokiTokenProviderIdentityUniqueIdAvailableEvent:3504}],["UnifiedCommunicationAvailability",["notSet","free","idle","busy","idleBusy","doNotDisturb","unalertable","unavailable"]],["UnifiedCommunicationStatus",["online","notOnline","away","busy","beRightBack","onThePhone","outToLunch","inAMeeting","outOfOffice","doNotDisturb","inAConference","getting","notABuddy","disconnected","notInstalled","urgentInterruptionsOnly","mayBeAvailable","idle","inPresentation"]],["FreeBusyCalendarState",["unknown","free","busy","elsewhere","tentative","outOfOffice"]],["PersonaType",["unknown","enterprise","contact","bot","phoneOnly","oneOff","distributionList","personalDistributionList","anonymous","unifiedGroup"]],["PhoneType",["workPhone","homePhone","mobilePhone","businessFax","otherPhone"]],["AddressType",["workAddress","homeAddress","otherAddress"]],["MemberType",["unknown","individual","group"]],["PersonaDataUpdated",["hostId","type","photo","personaInfo","unifiedCommunicationInfo","organization","unifiedGroupInfo","members","membership","capabilities","customizations","viewableSources"]],["CustomizedData",["email","workPhone","workPhone2","workFax","mobilePhone","homePhone","homePhone2","otherPhone","sipAddress","profile","office","company","workAddress","homeAddress","otherAddress","birthday"]],["ObjectType",["unknown","chart","smartArt","table","image","slide","text"],{ole:"OLE"}],["AppRuntimeState",["inactive","background","visible"]],["Visibility",["hidden","visible"]]],clientObjectTypes:[[1,4,0,[["roamingSettings",3,2,0,0,4]],[["getAccessToken",2,2,0,5],["getPrimaryIdentityInfo",0,2,1,5],["getIdentities",0,2,2,5]],0,0,0,[["TokenReceived",2,1,3001,"this._targetId",30,30]],"Microsoft.Authentication.AuthenticationService",4],[2,0,[[31,3],["value",1]]],[3,0,0,0,0,[[32,2,1,2,0,4],["getItemOrNullObject",2,1,2,0,4]]],[4,0,0,0,[["isEnabledForOffice"],["recordLinkedInSettingsCompliance",2]],0,0,0,0,"Microsoft.DesktopCompliance.LinkedIn",4],[5,0,0,0,[["isInOnlineMode"]],0,0,0,0,"Microsoft.DesktopCompliance.NetworkUsage",4],[6,0,0,[["buttons",9,19,0,0,4]],0,[["getButton",8,1],["getTab",7,1],["executeRequestUpdate",8,1]],0,0,0,"Microsoft.DynamicRibbon.DynamicRibbon",4],[7,0,[[31,3]],0,[["setVisibility",1]]],[8,0,[[31,3],["enabled",1],["label",3]],0,[["setEnabled",1]]],[9,1,0,0,[[33,0,2,0,4]],[[32,8,1,18,0,4]],0,8],[10,0,0,0,[["bindServiceToProfile",2]],0,0,0,0,"Microsoft.OfficeServicesManager.OfficeServicesManagerApi",4],[11,0,[[31,3],["text",1],["created",11],["level",3],["resolved",1],["author",3],["mentions",3]],[["parent",11,2,0,0,4],["parentOrNullObject",11,2,0,0,4],["replies",12,19,0,0,4]],[["getRichText",1,2,0,4],["setRichText",2],["delete"]],[["getParentOrSelf",11,0,2,0,4],["reply",11,2]]],[12,1,0,0,[[33,0,2,0,4]],[[32,11,1,18,0,4]],0,11],[13,0,[[34,3],[35,3]],0,[["items"]],[["getPersonaForMember",22,1]]],[14,0,0,0,[["addContact"],["editContact"],["composeEmail",1],["composeInstantMessage",1],["callPhoneNumber",1],["pinPersonaToQuickContacts"],["toggleTagForAlerts"],["scheduleMeeting"],["openLinkContactUx"],["editContactByIdentifier",1],["showHoverCardForPersona",6],["hideHoverCardForPersona"],["showContextMenu",6],["showContactCard",6],["showExpandedCard",6]]],[15,0,[[36,3],[37,3],[38,3],[39,3],[40,3],[41,3],[42,3],[43,3],[44,3],[45,3],[46,3],[47,3],[48,3],[49,3],["phones",3],["addresses",3],[50,3],[51,3]]],[16,0,[[36,3],[37,3],[38,3],[39,3],[40,11],[41,11],[42,3],[43,3],[44,3],[45,3],[46,3],[47,3],[48,3],[49,3],[50,3],[51,3],["isPersonResolved",3]],[["sources",15,3,0,0,4]],[["getPhones",0,2,0,4],["getAddresses",0,2,0,4]]],[17,0,[["availability",3],["status",3],["isSelf",3],["isTagged",3],["customStatusString",3],["isBlocked",3],["presenceTooltip",3],["isOutOfOffice",3],["outOfOfficeNote",3],["timezone",3],["meetingLocation",3],["meetingSubject",3],["timezoneBias",3],["idleStartTime",11],["overallCapability",3],["isOnBuddyList",3],["presenceNote",3],["voiceMailUri",3],["availabilityText",3],["availabilityTooltip",3],["isDurationInAvailabilityText",3],["freeBusyStatus",3],["calendarState",3]]],[18,0,0,0,[[52,1,0,0,0,52]]],[19,1,0,0,[[33,0,2,0,4]],[[32,22,1,18,0,4]],0,22],[20,0,[[34,3],[35,3]],[["hierarchy",19,18,0,0,4],["manager",22,2,0,0,4],["directReports",19,18,0,0,4]]],[21,0,[["description",1],["oneDrive",1],["oneNote",1],["isPublic",1],["amIOwner",1],["amIMember",1],["amISubscribed",1],["memberCount",1],["ownerCount",1],["hasGuests",1],["site",1],["planner",1],["classification",1],["subscriptionEnabled",1]]],[22,4,[["hostId",3],["type",3],["capabilities",3],["diagnosticId",3],[53,3]],[["photo",18,3,0,0,4],["personaInfo",16,3,0,0,4],["unifiedCommunicationInfo",17,3,0,0,4],["organization",20,3,0,0,4],["unifiedGroupInfo",21,35,0,0,4],["actions",14,2,0,0,4]],[["getCustomizations"],["warmup",1],[54],["getViewableSources"],["reportTimeForRender",2]],[["getMembers",13],["getMembership",13]]],[23,0,[[53,3]],0,[["getPolicies"],[55],[56]],[["getPersona",22,1],["getPersonaForOrgEntry",22,4],["getPersonaForOrgByEntryId",22,4]],0,0,[["PersonaUpdated",0,0,"MessageType.personaLifetimePersonaUpdatedEvent",57,55,56]]],[24,0,[["emailOrUpn",3],[53,3]],0,[["requestToken"],[58],[59],["requestIdentityUniqueId"],[60],[61]],0,0,0,[["IdentityUniqueIdAvailable",0,0,"MessageType.lokiTokenProviderIdentityUniqueIdAvailableEvent",57,60,61],["LokiTokenAvailable",0,0,"MessageType.lokiTokenProviderLokiTokenAvailableEvent",57,58,59]]],[25,0,0,0,0,[[62,24,1]],0,0,0,"Microsoft.People.LokiTokenProviderFactory",4],[26,0,0,0,[[54,1],["accountEmailOrUpn",1],["getPersonaPolicies"]],[[62,24,1],["getPersonaLifetime",23,1],["getInitialPersona",22,1]],0,0,0,"Microsoft.People.ServiceContext",4],[27,0,0,0,[["getEnterpriseUserInfo",0,2,0,5],["getMruFriendlyPath",1,2,0,5],["launchFileUrlInOfficeApp",2,2,0,5],["performLocalSearch",4,2,0,5],["readSearchCache",3,2,0,5],["writeSearchCache",3,2,0,5]],0,0,0,0,"Microsoft.TapRichApi.Tap",4],[28,0,0,0,[["setAppRuntimeStartState",1],["getAppRuntimeStartState",0,2,0,4]],0,0,0,0,"Microsoft.AppRuntime.AppRuntimePersistenceService",4],[29,0,0,0,[["setAppRuntimeState",1],["getAppRuntimeState",0,2,0,4]],0,0,0,[["VisibilityChanged",2,0,"65539","",30,30]],"Microsoft.AppRuntime.AppRuntimeService",4]]},F=new OfficeExtension.LibraryBuilder({metadata:f,targetNamespaceObject:a})})(OfficeCore||(OfficeCore={}));var Office;(function(b){b.Visibility=OfficeCore.Visibility;var a;(function(a){a.none="None";a.load="Load"})(a=b.StartupBehavior||(b.StartupBehavior={}));var c;(function(b){var k=this;function c(b){var a=new OfficeCore.RequestContext;a._requestFlagModifier|=64;if(b)a._customData="WacPartition";return a}function h(b){return __awaiter(this,void 0,void 0,function(){var f,d,e;return __generator(this,function(g){switch(g.label){case 0:if(b!==a.load&&b!==a.none)throw OfficeExtension.Utility.createRuntimeError(OfficeExtension.ErrorCodes.invalidArgument,null,null);f=b==a.load?OfficeCore.AppRuntimeState.background:OfficeCore.AppRuntimeState.inactive;d=c(false);e=OfficeCore.AppRuntimePersistenceService.newObject(d);e.setAppRuntimeStartState(f);return[4,d.sync()];case 1:g.sent();return[2]}})})}b.setStartupBehavior=h;function g(){return __awaiter(this,void 0,void 0,function(){var b,d,e,f,g;return __generator(this,function(h){switch(h.label){case 0:b=c(false);d=OfficeCore.AppRuntimePersistenceService.newObject(b);e=d.getAppRuntimeStartState();return[4,b.sync()];case 1:h.sent();f=e.value;g=f==OfficeCore.AppRuntimeState.inactive?a.none:a.load;return[2,g]}})})}b.getStartupBehavior=g;function e(a){return __awaiter(this,void 0,void 0,function(){var b,d;return __generator(this,function(e){switch(e.label){case 0:b=c(true);d=OfficeCore.AppRuntimeService.newObject(b);d.setAppRuntimeState(a);return[4,b.sync()];case 1:e.sent();return[2]}})})}function j(){return __awaiter(this,void 0,void 0,function(){var a,b,d;return __generator(this,function(e){switch(e.label){case 0:a=c(true);b=OfficeCore.AppRuntimeService.newObject(a);d=b.getAppRuntimeState();return[4,a.sync()];case 1:e.sent();return[2,d.value]}})})}b._getState=j;function i(){return e(OfficeCore.AppRuntimeState.visible)}b.showAsTaskpane=i;function l(){return e(OfficeCore.AppRuntimeState.background)}b.hide=l;var d;function f(){if(!d){var a=c(true);d=OfficeCore.AppRuntimeService.newObject(a)}return d}b.onVisibilityChanged={add:function(a){return __awaiter(k,void 0,void 0,function(){var b,c,d=this;return __generator(this,function(e){switch(e.label){case 0:b=f();c=b.onVisibilityChanged.add(a);return[4,b.context.sync()];case 1:e.sent();return[2,{remove:function(){return __awaiter(d,void 0,void 0,function(){return __generator(this,function(a){switch(a.label){case 0:c.remove();return[4,b.context.sync()];case 1:a.sent();return[2]}})})}}]}})})}}})(c=b.addin||(b.addin={}))})(Office||(Office={}));var OfficeRuntime;(function(a){var b;(function(a){function b(d,b){try{var c=OSF.Bootstrap.getOfficeAppContext().get_featureGates(),a=c[d];return void 0===a||null===a?b:"true"===a.toString().toLowerCase()}catch(e){return b}}a.getBooleanFeatureGate=b;function d(d,b){try{var c=OSF.Bootstrap.getOfficeAppContext().get_featureGates(),a=parseInt(c[d]);return isNaN(a)?b:a}catch(e){return b}}a.getIntFeatureGate=d;function c(d,b){try{var c=OSF.Bootstrap.getOfficeAppContext().get_featureGates(),a=c[d];return void 0===a||null===a?b:a}catch(e){return b}}a.getStringFeatureGate=c;function e(c,a){return Promise.resolve(b(c,a))}a.getBooleanFeatureGateAsync=e;function g(b,a){return Promise.resolve(d(b,a))}a.getIntFeatureGateAsync=g;function f(b,a){return Promise.resolve(c(b,a))}a.getStringFeatureGateAsync=f})(b=a.experimentation||(a.experimentation={}))})(OfficeRuntime||(OfficeRuntime={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(c,a){for(var b in a)if(a.hasOwnProperty(b))c[b]=a[b]};return function(c,b){a(c,b);function d(){this.constructor=c}c.prototype=b===null?Object.create(b):(d.prototype=b.prototype,new d)}}(),Word;(function(a){function d(e,b){if(OfficeExtension.Utility.isNullOrUndefined(b))return null;typeof b!="object"&&OfficeExtension.Utility.throwError(OfficeExtension.ResourceStrings.invalidArgument,"searchOptions");if(b instanceof a.SearchOptions)return b;var d=a.SearchOptions.newObject(e);for(var c in b)if(b.hasOwnProperty(c))d[c]=b[c];return d}var E="Word",A="WordApi",y=OfficeExtension.BatchApiHelper.createPropertyObject,c=OfficeExtension.BatchApiHelper.createMethodObject,z=OfficeExtension.BatchApiHelper.createIndexerObject,t=OfficeExtension.BatchApiHelper.createRootServiceObject,r=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,v=OfficeExtension.BatchApiHelper.createChildItemObject,C=OfficeExtension.BatchApiHelper.invokeMethod,w=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,h=OfficeExtension.BatchApiHelper.invokeSetProperty,e=OfficeExtension.Utility.isNullOrUndefined,g=OfficeExtension.Utility.isUndefined,m=OfficeExtension.Utility.throwIfNotLoaded,u=OfficeExtension.Utility.throwIfApiNotSupported,I=OfficeExtension.Utility.load,F=OfficeExtension.Utility.retrieve,H=OfficeExtension.Utility.toJson,s=OfficeExtension.Utility.fixObjectPathIfNecessary,q=OfficeExtension.Utility._handleNavigationPropertyResults,B=OfficeExtension.Utility.adjustToDateTime,x=OfficeExtension.Utility.processRetrieveResult,D=OfficeExtension.Utility.setMockData,i=function(){function a(){}a.prototype.getDocument=function(){if(e(this._document))this._document=this.context.document;return this._document};a.prototype.getReferenceId=function(){if(e(this._refId))this._refId=this._ReferenceId;return this._refId};a.prototype._RegisterAddedEvent=function(){this.getDocument()._RegisterEvent(this.getReferenceId(),"AnnotationAdded")};a.prototype._UnregisterAddedEvent=function(){this.getDocument()._UnregisterEvent(this.getReferenceId(),"AnnotationAdded")};a.prototype._RegisterChangedEvent=function(){this.getDocument()._RegisterEvent(this.getReferenceId(),"AnnotationChanged")};a.prototype._UnregisterChangedEvent=function(){this.getDocument()._UnregisterEvent(this.getReferenceId(),"AnnotationChanged")};a.prototype._RegisterDeletedEvent=function(){this.getDocument()._RegisterEvent(this.getReferenceId(),"AnnotationDeleted")};a.prototype._UnregisterDeletedEvent=function(){this.getDocument()._UnregisterEvent(this.getReferenceId(),"AnnotationDeleted")};return a}();a.AnnotationCollectionCustom=i;var b;(function(b){function e(c,d){var b={eventType:a.EventType.annotationAdded,annotation:OfficeExtension.BatchApiHelper.createObjectFromReferenceId(a.Annotation,c.context,d)};b.annotation.load();return b}b.AnnotationCollection_AnnotationAdded_EventArgsTransform=e;function c(c,d){var b={eventType:a.EventType.annotationChanged,annotation:OfficeExtension.BatchApiHelper.createObjectFromReferenceId(a.Annotation,c.context,d)};b.annotation.load();return b}b.AnnotationCollection_AnnotationChanged_EventArgsTransform=c;function d(c,d){var b={eventType:a.EventType.annotationDeleted,annotation:OfficeExtension.BatchApiHelper.createObjectFromReferenceId(a.Annotation,c.context,d)};b.annotation.load();return b}b.AnnotationCollection_AnnotationDeleted_EventArgsTransform=d})(b=a._CC||(a._CC={}));(function(e){function b(e,f,b){b=d(e.context,b);var g=c(a.RangeCollection,e,"Search",1,[f,b],true,false,null,4);return{handled:true,result:g}}e.Body_Search=b})(b=a._CC||(a._CC={}));var k=function(){function a(){}a.prototype.getDocument=function(){if(e(this._document))this._document=this.context.document;return this._document};a.prototype.getReferenceId=function(){if(e(this._refId))this._refId=this._ReferenceId;return this._refId};a.prototype._RegisterDataChangedEvent=function(){this.getDocument()._RegisterEvent(this.getReferenceId(),"ContentControlDataChanged")};a.prototype._UnregisterDataChangedEvent=function(){this.getDocument()._UnregisterEvent(this.getReferenceId(),"ContentControlDataChanged")};a.prototype._RegisterDeletedEvent=function(){this.getDocument()._RegisterEvent(this.getReferenceId(),"ContentControlDeleted")};a.prototype._UnregisterDeletedEvent=function(){this.getDocument()._UnregisterEvent(this.getReferenceId(),"ContentControlDeleted")};a.prototype._RegisterSelectionChangedEvent=function(){this.getDocument()._RegisterEvent(this.getReferenceId(),"ContentControlSelectionChanged")};a.prototype._UnregisterSelectionChangedEvent=function(){this.getDocument()._UnregisterEvent(this.getReferenceId(),"ContentControlSelectionChanged")};return a}();a.ContentControlCustom=k;(function(b){function h(e,f,b){b=d(e.context,b);var g=c(a.RangeCollection,e,"Search",1,[f,b],true,false,null,4);return{handled:true,result:g}}b.ContentControl_Search=h;function f(b,d){var c={eventType:a.EventType.contentControlDataChanged,contentControl:b};return c}b.ContentControl_DataChanged_EventArgsTransform=f;function g(b,d){var c={eventType:a.EventType.contentControlDeleted,contentControl:b};return c}b.ContentControl_Deleted_EventArgsTransform=g;function e(b,d){var c={eventType:a.EventType.contentControlSelectionChanged,contentControl:b};return c}b.ContentControl_SelectionChanged_EventArgsTransform=e})(b=a._CC||(a._CC={}));(function(b){function a(b,a){if(!g(a.Value)&&!g(a.Type)&&a.Type=="Date")a.Value=new Date(a.Value)}b.CustomProperty_HandleResult=a})(b=a._CC||(a._CC={}));var n=function(){function a(){}a.prototype._RegisterContentControlAddedEvent=function(){var a=this;a._RegisterEvent(a._ReferenceId,"ContentControlAdded")};a.prototype._UnregisterContentControlAddedEvent=function(){var a=this;a._RegisterEvent(a._ReferenceId,"ContentControlAdded")};return a}();a.DocumentCustom=n;(function(c){function b(c,d){var b={eventType:a.EventType.contentControlAdded,contentControl:OfficeExtension.BatchApiHelper.createObjectFromReferenceId(a.ContentControl,c.context,d)};b.contentControl.load();return b}c.Document_ContentControlAdded_EventArgsTransform=b})(b=a._CC||(a._CC={}));(function(e){function b(e,f,b){b=d(e.context,b);var g=c(a.RangeCollection,e,"Search",1,[f,b],true,false,null,4);return{handled:true,result:g}}e.Paragraph_Search=b})(b=a._CC||(a._CC={}));(function(e){function b(e,f,b){b=d(e.context,b);var g=c(a.RangeCollection,e,"Search",1,[f,b],true,false,null,4);return{handled:true,result:g}}e.Range_Search=b})(b=a._CC||(a._CC={}));var l=function(){function a(){}Object.defineProperty(a.prototype,"matchWildCards",{"get":function(){m("matchWildCards",this.m_matchWildcards);return this.m_matchWildcards},"set":function(a){this.m_matchWildcards=a;h(this,"MatchWildCards",a,0)},enumerable:true,configurable:true});return a}();a.SearchOptionsCustom=l;var f=function(){function a(){}a.replaceStringDateWithDate=function(b){var c=JSON.stringify(b);b=JSON.parse(c,function(d,b){var c;if(typeof b==="string"&&b&&b.length>6&&b.slice(0,5)===a.DateJSONPrefix&&b.slice(-1)===a.DateJSONSuffix){c=new Date(parseInt(b.slice(5,-1)));if(c)return c}return b});return b};a.replaceDateWithStringDate=function(b){var c=JSON.stringify(b,function(b,c){return this[b]instanceof Date?a.DateJSONPrefix+this[b].getTime()+a.DateJSONSuffix:c});b=JSON.parse(c);return b};a.DateJSONPrefix="Date(";a.DateJSONSuffix=")";return a}();a.SettingCustom=f;(function(a){function b(d,a){function b(c,a){var b=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/;if(b.exec(a))return new Date(a);return a}if(!g(a.Value)&&typeof a.Value==="string"){var c=JSON.parse(a.Value,b);a.Value=f.replaceStringDateWithDate(c)}}a.Setting_HandleResult=b;function c(b,c){var a=JSON.stringify(f.replaceDateWithStringDate(c));if(a!==null){this.m_value=a;h(b,"Value",a,0);return{handled:true}}}a.Setting_Value_Set=c})(b=a._CC||(a._CC={}));(function(d){function b(d,h,g){var b=JSON.stringify(f.replaceDateWithStringDate(g));if(b!==null){var e=c(a.Setting,d,"Add",0,[h,b],false,false,null,0);return{handled:true,result:e}}return{handled:false,result:null}}d.SettingCollection_Add=b})(b=a._CC||(a._CC={}));(function(e){function b(e,f,b){b=d(e.context,b);var g=c(a.RangeCollection,e,"Search",1,[f,b],true,false,null,4);return{handled:true,result:g}}e.Table_Search=b})(b=a._CC||(a._CC={}));(function(e){function b(e,f,b){b=d(e.context,b);var g=c(a.RangeCollection,e,"Search",1,[f,b],true,false,null,4);return{handled:true,result:g}}e.TableRow_Search=b})(b=a._CC||(a._CC={}));var o;(function(a){a.accessDenied="AccessDenied";a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.itemNotFound="ItemNotFound";a.notImplemented="NotImplemented"})(o=a.ErrorCodes||(a.ErrorCodes={}));var p;(function(a){})(p=a.Interfaces||(a.Interfaces={}));var j={version:"1.0.0",name:"Word",defaultApiSetName:"WordApi",hostName:"Word",apiSets:[["1.3"],["1.2"],["1.4"],["1.1","WordOnline"],["1.3","WordApiHiddenDocument"],["1.4","WordApiHiddenDocument"]],strings:["Annotation","AnnotationCollection","Application","Body","ContentControl","ContentControlCollection","CustomProperty","CustomPropertyCollection","CustomXmlPart","CustomXmlPartCollection","CustomXmlPartScopedCollection","Document","DocumentCreated","DocumentProperties","Font","InlinePicture","InlinePictureCollection","List","ListCollection","ListItem","Paragraph","ParagraphCollection","Range","RangeCollection","SearchOptions","Section","SectionCollection","Setting","SettingCollection","Table","TableCollection","TableRow","TableRowCollection","TableCell","TableCellCollection","TableBorder","id","_ReferenceId","_KeepReference","delete","getItem","getFirst","getFirstOrNullObject","this._ReferenceId","_RegisterDeletedEvent","_UnregisterDeletedEvent","style","text","type","styleBuiltIn","paragraphs","contentControls","parentContentControl","font","inlinePictures","parentBody","lists","tables","parentContentControlOrNullObject","insertBreak","clear","getHtml","getOoxml","select","insertText","insertHtml","insertOoxml","insertParagraph","insertContentControl","insertFileFromBase64","insertInlinePictureFromBase64","search","getRange","insertTable","title","color","parentTableCell","parentTable","parentTableCellOrNullObject","parentTableOrNullObject","split","getTextRanges","getById","getByIdOrNullObject","key","value","_Id","getCount","deleteAll","add","getItemOrNullObject","saved","sections","body","properties","settings","customXmlParts","save","deleteBookmark","getMetadata","setMetadata","getBookmarkRange","getBookmarkRangeOrNullObject","hyperlink","width","getNext","getNextOrNullObject","_GetItem","alignment","values","shadingColor","horizontalAlignment","verticalAlignment","getCellPadding","setCellPadding","getBorder","rowIndex","insertRows"],enumTypes:[["NumericEventType",[],{contentControlDeleted:0,contentControlSelectionChanged:1,contentControlDataChanged:2,contentControlAdded:3,annotationAdded:4,annotationChanged:5,annotationDeleted:6}],["EventType",["contentControlDeleted","contentControlSelectionChanged","contentControlDataChanged","contentControlAdded","annotationAdded","annotationChanged","annotationDeleted"]],["ContentControlType",["unknown","richTextInline","richTextParagraphs","richTextTableCell","richTextTableRow","richTextTable","plainTextInline","plainTextParagraph","picture","buildingBlockGallery","checkBox","comboBox","dropDownList","datePicker","repeatingSection","richText","plainText"]],["ContentControlAppearance",["boundingBox","tags","hidden"]],["UnderlineType",["mixed","none","hidden","dotLine","single","word","double","thick","dotted","dottedHeavy","dashLine","dashLineHeavy","dashLineLong","dashLineLongHeavy","dotDashLine","dotDashLineHeavy","twoDotDashLine","twoDotDashLineHeavy","wave","waveHeavy","waveDouble"]],["BreakType",["page","next","sectionNext","sectionContinuous","sectionEven","sectionOdd","line"]],["InsertLocation",["before","after","start","end","replace"]],["Alignment",["mixed","unknown","left","centered","right","justified"]],["HeaderFooterType",["primary","firstPage","evenPages"]],["BodyType",["unknown","mainDoc","section","header","footer","tableCell"]],["SelectionMode",["select","start","end"]],["ImageFormat",["unsupported","undefined","bmp","jpeg","gif","tiff","png","icon","exif","wmf","emf","pict","pdf","svg"]],["RangeLocation",["whole","start","end","before","after","content"]],["LocationRelation",["unrelated","equal","containsStart","containsEnd","contains","insideStart","insideEnd","inside","adjacentBefore","overlapsBefore","before","adjacentAfter","overlapsAfter","after"]],["BorderLocation",["top","left","bottom","right","insideHorizontal","insideVertical","inside","outside","all"]],["CellPaddingLocation",["top","left","bottom","right"]],["BorderType",["mixed","none","single","double","dotted","dashed","dotDashed","dot2Dashed","triple","thinThickSmall","thickThinSmall","thinThickThinSmall","thinThickMed","thickThinMed","thinThickThinMed","thinThickLarge","thickThinLarge","thinThickThinLarge","wave","doubleWave","dashedSmall","dashDotStroked","threeDEmboss","threeDEngrave"]],["VerticalAlignment",["mixed","top","center","bottom"]],["ListLevelType",["bullet","number","picture"]],["ListBullet",["custom","solid","hollow","square","diamonds","arrow","checkmark"]],["ListNumbering",["none","arabic","upperRoman","lowerRoman","upperLetter","lowerLetter"]],["Style",["other","normal","heading1","heading2","heading3","heading4","heading5","heading6","heading7","heading8","heading9","toc1","toc2","toc3","toc4","toc5","toc6","toc7","toc8","toc9","footnoteText","header","footer","caption","footnoteReference","endnoteReference","endnoteText","title","subtitle","hyperlink","strong","emphasis","noSpacing","listParagraph","quote","intenseQuote","subtleEmphasis","intenseEmphasis","subtleReference","intenseReference","bookTitle","bibliography","tocHeading","tableGrid","plainTable1","plainTable2","plainTable3","plainTable4","plainTable5","tableGridLight","gridTable1Light","gridTable1Light_Accent1","gridTable1Light_Accent2","gridTable1Light_Accent3","gridTable1Light_Accent4","gridTable1Light_Accent5","gridTable1Light_Accent6","gridTable2","gridTable2_Accent1","gridTable2_Accent2","gridTable2_Accent3","gridTable2_Accent4","gridTable2_Accent5","gridTable2_Accent6","gridTable3","gridTable3_Accent1","gridTable3_Accent2","gridTable3_Accent3","gridTable3_Accent4","gridTable3_Accent5","gridTable3_Accent6","gridTable4","gridTable4_Accent1","gridTable4_Accent2","gridTable4_Accent3","gridTable4_Accent4","gridTable4_Accent5","gridTable4_Accent6","gridTable5Dark","gridTable5Dark_Accent1","gridTable5Dark_Accent2","gridTable5Dark_Accent3","gridTable5Dark_Accent4","gridTable5Dark_Accent5","gridTable5Dark_Accent6","gridTable6Colorful","gridTable6Colorful_Accent1","gridTable6Colorful_Accent2","gridTable6Colorful_Accent3","gridTable6Colorful_Accent4","gridTable6Colorful_Accent5","gridTable6Colorful_Accent6","gridTable7Colorful","gridTable7Colorful_Accent1","gridTable7Colorful_Accent2","gridTable7Colorful_Accent3","gridTable7Colorful_Accent4","gridTable7Colorful_Accent5","gridTable7Colorful_Accent6","listTable1Light","listTable1Light_Accent1","listTable1Light_Accent2","listTable1Light_Accent3","listTable1Light_Accent4","listTable1Light_Accent5","listTable1Light_Accent6","listTable2","listTable2_Accent1","listTable2_Accent2","listTable2_Accent3","listTable2_Accent4","listTable2_Accent5","listTable2_Accent6","listTable3","listTable3_Accent1","listTable3_Accent2","listTable3_Accent3","listTable3_Accent4","listTable3_Accent5","listTable3_Accent6","listTable4","listTable4_Accent1","listTable4_Accent2","listTable4_Accent3","listTable4_Accent4","listTable4_Accent5","listTable4_Accent6","listTable5Dark","listTable5Dark_Accent1","listTable5Dark_Accent2","listTable5Dark_Accent3","listTable5Dark_Accent4","listTable5Dark_Accent5","listTable5Dark_Accent6","listTable6Colorful","listTable6Colorful_Accent1","listTable6Colorful_Accent2","listTable6Colorful_Accent3","listTable6Colorful_Accent4","listTable6Colorful_Accent5","listTable6Colorful_Accent6","listTable7Colorful","listTable7Colorful_Accent1","listTable7Colorful_Accent2","listTable7Colorful_Accent3","listTable7Colorful_Accent4","listTable7Colorful_Accent5","listTable7Colorful_Accent6"]],["DocumentPropertyType",["string","number","date","boolean"]],["TapObjectType",["chart","smartArt","table","image","slide","text"],{ole:"OLE"}],["FileContentFormat",["base64","html","ooxml"]],["AnnotationParentType",["none","document","paragraph","annotation"]],["AnnotationState",["undefined","created","sent","duplicated","seen","tried","kept","rejected"]]],clientObjectTypes:[[1,2,[["content",3],[37,3],[38,2],["_State"]],0,[[39,0,2,0,4],["getParentType",0,2,0,4],[40]],[["getParentAsParagraph",21,0,2,0,4],["getParentAsAnnotation",1,0,2,0,4]]],[2,7,[[38,2]],0,[[39,0,2,0,4],["refresh",0,2,0,4]],[[41,1,1,18,0,4],[42,1,0,2,0,4],[43,1,0,2,0,4]],0,1,[["AnnotationAdded",2,0,"NumericEventType.annotationAdded",44,"_RegisterAddedEvent","_UnregisterAddedEvent"],["AnnotationChanged",2,0,"NumericEventType.annotationChanged",44,"_RegisterChangedEvent","_UnregisterChangedEvent"],["AnnotationDeleted",2,0,"NumericEventType.annotationDeleted",44,45,46]]],[3,0,0,0,[["isTapEnabled",0,2,0,5],["getSharePointTenantRoot",0,2,0,5],["getEnterpriseUserInfo",0,2,0,5],["getMruFriendlyPath",1,2,0,5],["launchFileUrlInOfficeApp",2,2,0,5]],[["createDocument",13,1,2,0,4]],0,0,0,"Microsoft.WordServices.Application",4],[4,2,[[38,2],[47,1],[48,3],[49,3,1],[50,1,1]],[[51,22,19,0,0,4],[52,6,19,0,0,4],[53,5,2,0,0,4],[54,15,35,0,0,4],[55,17,19,0,0,4],[56,4,2,1,0,4],[57,19,19,1,0,4],[58,31,19,1,0,4],["parentSection",26,2,1,0,4],[59,5,2,1,0,4],["parentBodyOrNullObject",4,2,1,0,4],["parentSectionOrNullObject",26,2,1,0,4]],[[39,0,2,0,4],[60,2],[61],[62,0,2,0,4],[63,0,2,0,4],[64,1,2,0,4]],[[65,23,2,8],[66,23,2,8],[67,23,2,8],[68,21,2,8],[69,5,0,8],[70,23,2,8],[71,16,2,8,2],[72,24,2,7,0,4],[73,23,1,2,1,4],[74,30,4,8,1]]],[5,6,[[37,3],[38,2],[75,1],["tag",1],["placeholderText",1],[49,3],["appearance",1],[76,1],["removeWhenEdited",1],["cannotDelete",1],["cannotEdit",1],[47,1],[48,3],["subtype",3,1],[50,1,1]],[[54,15,35,0,0,4],[51,22,19,0,0,4],[52,6,19,0,0,4],[53,5,2,0,0,4],[55,17,19,0,0,4],[57,19,19,1,0,4],[58,31,19,1,0,4],[77,34,2,1,0,4],[78,30,2,1,0,4],[56,4,2,1,0,4],[59,5,2,1,0,4],[79,34,2,1,0,4],[80,30,2,1,0,4]],[[39,0,2,0,4],[60,2],[61],[40,1],[64,1,2,0,4],[62,0,2,0,4],[63,0,2,0,4]],[[65,23,2,8],[66,23,2,8],[67,23,2,8],[70,23,2,8],[68,21,2,8],[71,16,2,8,2],[72,24,2,7,0,4],[73,23,1,2,1,4],[81,24,4,6,1,4],[74,30,4,8,1],[82,24,2,6,1,4]],0,0,[["DataChanged",2,3,"NumericEventType.contentControlDataChanged",44,"_RegisterDataChangedEvent","_UnregisterDataChangedEvent"],["Deleted",2,3,"NumericEventType.contentControlDeleted",44,45,46],["SelectionChanged",2,3,"NumericEventType.contentControlSelectionChanged",44,"_RegisterSelectionChangedEvent","_UnregisterSelectionChangedEvent"]]],[6,3,[[38,2]],0,[[39,0,2,0,4]],[[41,5,1,18,0,4],[83,5,1,2,0,4],["getByTitle",6,1,6,0,4],["getByTag",6,1,6,0,4],["getByTypes",6,1,6,1,4],[42,5,0,2,1,4],[84,5,1,2,1,4],[43,5,0,2,1,4]],0,5],[7,10,[[38,2],[85,3],[86,1],[49,3],[87,2]],0,[[39,0,2,0,4],[40]]],[8,3,[[38,2]],0,[[39,0,2,0,4],[88,0,2,0,4],[89]],[[41,7,1,18,0,4],[90,7,2,8],[91,7,1,2,0,4]],0,7],[9,2,[[38,2],[37,3],["namespaceUri",3]],0,[[39,0,2,0,4],[40],["getXml",0,2,0,4],["setXml",1],["query",2],["insertElement",4],["updateElement",3],["deleteElement",2],["insertAttribute",4],["updateAttribute",4],["deleteAttribute",3]]],[10,3,[[38,2]],0,[[39,0,2,0,4],[88,0,2,0,4]],[[41,9,1,18,0,4],[90,9,1,8],["getByNamespace",11,1,6,0,4],[91,9,1,2,0,4]],0,9],[11,3,[[38,2]],0,[[39,0,2,0,4],[88,0,2,0,4]],[[41,9,1,18,0,4],[91,9,1,2,0,4],["getOnlyItem",9,0,2,0,4],["getOnlyItemOrNullObject",9,0,2,0,4]],0,9],[12,6,[[92,3],[38,2],["allowCloseOnUntitled",1]],[[93,27,19,0,0,4],[94,4,35,0,0,4],[52,6,19,0,0,4],[95,14,35,1,0,4],[96,29,19,3,0,4],[97,10,19,3,0,4]],[["_GetObjectByReferenceId",1,2,0,4],["_GetObjectTypeNameByReferenceId",1,2,0,4],["_RemoveReference",1,2,0,4],["_RemoveAllReferences",0,2,0,4],[98],[39,0,2,0,4],[99,1,0,3],[100,1,2,0,4],[101,2],["setMetadataOnTile",3],["launchTapPane",1,2,0,5],["getNeighborhoodTextAroundSelection",1,2,0,5],["_RegisterEvent",2,2,0,4],["_UnregisterEvent",2,2,0,4],["setNavigationPaneVisibility",1,0,4,1]],[["getSelection",23,0,10,0,4],[102,23,1,2,3,4],[103,23,1,2,3,4],["getAnnotationsByType",2,1,6,4,4]],0,0,[["ContentControlAdded",2,3,"NumericEventType.contentControlAdded",44,"_RegisterContentControlAddedEvent","_UnregisterContentControlAddedEvent"]]],[13,2,[[92,3,5],[38,2]],[[93,27,19,5,0,4],[94,4,35,5,0,4],[52,6,19,5,0,4],[95,14,35,5,0,4],[96,29,19,6,0,4],[97,10,19,6,0,4]],[[98,0,0,5],[39,0,2,0,4],["open",0,2,0,4],[99,1,0,6]],[[102,23,1,2,6,4],[103,23,1,2,6,4]]],[14,2,[[38,2],[75,1],["subject",1],["author",1],["keywords",1],["comments",1],["template",3],["lastAuthor",3],["revisionNumber",3],["applicationName",3],["lastPrintDate",11],["creationDate",11],["lastSaveTime",11],["security",3],["category",1],["format",1],["manager",1],["company",1]],[["customProperties",8,19,0,0,4]],[[39,0,2,0,4]]],[15,2,[[38,2],["name",1],["size",1],["bold",1],["italic",1],[76,1],["underline",1],["subscript",1],["superscript",1],["strikeThrough",1],["doubleStrikeThrough",1],["highlightColor",1]],0,[[39,0,2,0,4]]],[16,2,[[87,2],[38,2],["altTextDescription",1],["altTextTitle",1],["height",1],[104,1],["lockAspectRatio",1],[105,1],["imageFormat",3,3]],[[53,5,2,0,0,4],["paragraph",21,2,2,0,4],[77,34,2,1,0,4],[78,30,2,1,0,4],[59,5,2,1,0,4],[79,34,2,1,0,4],[80,30,2,1,0,4]],[[39,0,2,0,4],["getBase64ImageSrc",0,2,0,4],[60,2,0,2],[40,0,0,2],[64,1,2,2,4]],[[69,5,0,8],[71,16,2,8,2],[65,23,2,8,2],[66,23,2,8,2],[67,23,2,8,2],[68,21,2,8,2],[70,23,2,8,2],[73,23,1,2,1,4],[106,16,0,2,1,4],[107,16,0,2,1,4]]],[17,3,[[38,2]],0,[[39,0,2,0,4]],[[108,16,1,18,0,4],[42,16,0,2,1,4],[43,16,0,2,1,4]],0,16],[18,2,[[37,3],[38,2],["levelTypes",3],["levelExistences",3]],[[51,22,19,0,0,4]],[[39,0,2,0,4],["setLevelBullet",4],["setLevelNumbering",3],["getLevelString",1,2,0,4],["setLevelPicture",2,0,3],["getLevelPicture",1,2,3,4],["resetLevelFont",2,0,3],["setLevelAlignment",2],["setLevelIndents",3],["setLevelStartingNumber",2]],[[68,21,2,8],["getLevelParagraphs",22,1,6,0,4],["getLevelFont",15,1,2,3,4]]],[19,3,[[38,2]],0,[[39,0,2,0,4]],[[41,18,1,18,0,4],[83,18,1,2,0,4],[42,18,0,2,0,4],[84,18,1,2,0,4],[43,18,0,2,0,4]],0,18],[20,2,[[38,2],["siblingIndex",3],["listString",3],["level",1]],0,[[39,0,2,0,4]],[["getAncestor",21,1,2,0,4],["getDescendants",22,1,6,0,4],["getAncestorOrNullObject",21,1,2,0,4]]],[21,2,[[87,2],[38,2],[47,1],[109,1],["firstLineIndent",1],["leftIndent",1],["rightIndent",1],["lineSpacing",1],["outlineLevel",1],["spaceBefore",1],["spaceAfter",1],["lineUnitBefore",1],["lineUnitAfter",1],[48,3],["isListItem",3,1],["tableNestingLevel",3,1],["isLastParagraph",3,1],[50,1,1]],[[54,15,35,0,0,4],[52,6,18,0,0,4],[53,5,2,0,0,4],[55,17,19,0,0,4],[56,4,2,1,0,4],["list",18,2,1,0,4],[77,34,2,1,0,4],[78,30,2,1,0,4],["listItem",20,35,1,0,4],[59,5,2,1,0,4],[79,34,2,1,0,4],[80,30,2,1,0,4],["listOrNullObject",18,2,1,0,4],["listItemOrNullObject",20,35,1,0,4]],[[39,0,2,0,4],[60,2],[61],[40],[64,1,2,0,4],[62,0,2,0,4],[63,0,2,0,4],["detachFromList",0,0,1],[100,1,2,0,4],[101,2]],[[71,16,2,8],[69,5,0,8],[65,23,2,8],[66,23,2,8],[67,23,2,8],[70,23,2,8],[68,21,2,8],[72,24,2,7,0,4],[73,23,1,2,1,4],[81,24,3,6,1,4],[74,30,4,8,1],[82,24,2,6,1,4],["startNewList",18,0,0,1],["attachToList",18,2,0,1],[106,21,0,2,1,4],["getPrevious",21,0,2,1,4],[107,21,0,2,1,4],["getPreviousOrNullObject",21,0,2,1,4],["getSubrange",23,2,2,1,4]]],[22,3,[[38,2]],0,[[39,0,2,0,4]],[[108,21,1,18,0,4],[42,21,0,2,1,4],["getLast",21,0,2,1,4],[43,21,0,2,1,4],["getLastOrNullObject",21,0,2,1,4]],0,21],[23,2,[[87,2],[38,2],[47,1],[48,3],["isEmpty",3,1],[104,1,1],[50,1,1]],[[54,15,35,0,0,4],[51,22,18,0,0,4],[52,6,18,0,0,4],[53,5,2,0,0,4],[55,17,19,2,0,4],[57,19,18,1,0,4],[58,31,18,1,0,4],[77,34,2,1,0,4],[78,30,2,1,0,4],[56,4,2,1,0,4],[59,5,2,1,0,4],[79,34,2,1,0,4],[80,30,2,1,0,4]],[[39,0,2,0,4],[60,2],[61],[40],[64,1,2,0,4],[62,0,2,0,4],[63,0,2,0,4],["compareLocationWith",1,2,1,4],["getBookmarks",2,2,3,4],["insertBookmark",1,0,3],["highlight",1,2,0,4],["removeHighlight",0,2,0,4],["previewTextReplacement",1,2,0,4],["endPreview",0,2,0,4]],[[69,5,0,8],[65,23,2,8],[66,23,2,8],[67,23,2,8],[70,23,2,8],[68,21,2,8],[71,16,2,8,2],[72,24,2,7,0,4],[73,23,1,2,1,4],[81,24,4,6,1,4],["expandTo",23,1,0,1],["intersectWith",23,1,0,1],["getNextTextRange",23,2,2,1,4],["getHyperlinkRanges",24,0,6,1,4],[74,30,4,8,1],[82,24,2,6,1,4],["expandToOrNullObject",23,1,0,1],["intersectWithOrNullObject",23,1,0,1],["getNextTextRangeOrNullObject",23,2,2,1,4],["insertTapObjectFromFileContent",23,3,8,0,1]]],[24,3,[[38,2]],0,[[39,0,2,0,4]],[[108,23,1,18,0,4],[42,23,0,2,1,4],[43,23,0,2,1,4]],0,23],[25,4,[["ignorePunct",1],["ignoreSpace",1],["matchCase",1],["matchPrefix",1],["matchSuffix",1],["matchWildcards",1],["matchWholeWord",1]],0,0,0,0,0,0,"Microsoft.WordServices.SearchOptions",4],[26,2,[[87,2],[38,2]],[[94,4,35,0,0,4]],[[39,0,2,0,4]],[["getHeader",4,1,10,0,4],["getFooter",4,1,10,0,4],[106,26,0,2,1,4],[107,26,0,2,1,4]]],[27,3,[[38,2]],0,[[39,0,2,0,4]],[[108,26,1,18,0,4],[42,26,0,2,1,4],[43,26,0,2,1,4]],0,26],[28,14,[[38,2],[85,3],[86,5],[87,2]],0,[[39,0,2,0,4],[40]]],[29,3,[[38,2]],0,[[39,0,2,0,4],[88,0,2,0,4],[89]],[[41,28,1,18,0,4],[90,28,2,9],[91,28,1,2,0,4]],0,28],[30,2,[[87,2],[38,2],["isUniform",3],["nestingLevel",3],[110,1],[47,1],["rowCount",3],["headerRowCount",1],["styleTotalRow",1],["styleFirstColumn",1],["styleLastColumn",1],["styleBandedRows",1],["styleBandedColumns",1],[111,1],[112,1],[113,1],[105,1],[50,1],[109,1]],[["rows",33,19,0,0,4],[58,31,19,0,0,4],[77,34,2,0,0,4],[78,30,2,0,0,4],[54,15,35,0,0,4],[53,5,2,0,0,4],[56,4,2,0,0,4],[79,34,2,0,0,4],[80,30,2,0,0,4],[59,5,2,0,0,4]],[[39,0,2,0,4],["addColumns",3],[40],[61],["deleteRows",2],["deleteColumns",2],["autoFitWindow"],["distributeColumns"],[64,1,2,0,4],[114,1,2,0,4],[115,2]],[["addRows",33,3,4],["getCell",34,2,2,0,4],["mergeCells",34,4,8,3],[116,36,1,2,0,4],[72,24,2,7,0,4],[73,23,1,2,0,4],[69,5,0,8],[74,30,4,8],[68,21,2,8],[106,30,0,2,0,4],["getParagraphBefore",21,0,2,0,4],["getParagraphAfter",21,0,2,0,4],["getCellOrNullObject",34,2,2,0,4],[107,30,0,2,0,4],["getParagraphBeforeOrNullObject",21,0,2,0,4],["getParagraphAfterOrNullObject",21,0,2,0,4]]],[31,3,[[38,2]],0,[[39,0,2,0,4]],[[108,30,1,18,0,4],[42,30,0,2,0,4],[43,30,0,2,0,4]],0,30],[32,2,[[87,2],[38,2],["cellCount",3],[117,3],[110,1],[111,1],[112,1],[113,1],["isHeader",3],["preferredHeight",1]],[["cells",35,19,0,0,4],[78,30,2,0,0,4],[54,15,35,0,0,4]],[[39,0,2,0,4],[40],[61],[64,1,2,0,4],[114,1,2,0,4],[115,2]],[[118,33,3,6,0,4],["merge",34,0,0,3],[72,24,2,7,0,4],[116,36,1,2,0,4],[106,32,0,2,0,4],[107,32,0,2,0,4],[69,5,0,0,3]]],[33,3,[[38,2]],0,[[39,0,2,0,4]],[[108,32,1,18,0,4],[42,32,0,2,0,4],[43,32,0,2,0,4]],0,32],[34,2,[[87,2],[38,2],[117,3],["cellIndex",3],[86,1],[111,1],[112,1],[113,1],["columnWidth",1],[105,3]],[[78,30,2,0,0,4],["parentRow",32,2,0,0,4],[94,4,35,0,0,4]],[[39,0,2,0,4],["insertColumns",3],[81,2,0,3],["deleteRow"],["deleteColumn"],[114,1,2,0,4],[115,2]],[[118,33,3,4],[116,36,1,2,0,4],[106,34,0,2,0,4],[107,34,0,2,0,4]]],[35,3,[[38,2]],0,[[39,0,2,0,4]],[[108,34,1,18,0,4],[42,34,0,2,0,4],[43,34,0,2,0,4]],0,34],[36,2,[[38,2],[76,1],[49,1],[105,1]],0,[[39,0,2,0,4]]]]},G=new OfficeExtension.LibraryBuilder({metadata:j,targetNamespaceObject:a})})(Word||(Word={}));var Word;(function(a){var b=function(c){__extends(b,c);function b(d){var b=c.call(this,d)||this;b.m_document=OfficeExtension.BatchApiHelper.createRootServiceObject(a.Document,b);b._rootObject=b.m_document;return b}Object.defineProperty(b.prototype,"document",{"get":function(){return this.m_document},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"application",{"get":function(){if(this.m_application==null)this.m_application=OfficeExtension.BatchApiHelper.createTopLevelServiceObject(a.Application,this,"Microsoft.WordServices.Application",false,0);return this.m_application},enumerable:true,configurable:true});return b}(OfficeCore.RequestContext);a.RequestContext=b;function c(b,c){return OfficeExtension.ClientRequestContext._runBatch("Word.run",arguments,function(){return new a.RequestContext})}a.run=c})(Word||(Word={}))